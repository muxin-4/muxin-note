#  第 1 章 类型
>为什么说JavaScript是否有类型也很重要呢？
>
>要正确合理地进行类型转换，我们必须掌握JavaScript中的各个类型及其内在行为。几乎所有的JavaScript程序都会涉及某种形式的强制类型转换，处理这些情况时我们要有充分的把握和自信。

##1.1 JavaScript内置类型 

JavaScript有七种内置类型

|类型|类型|typeof 操作符来检测变量的数据类型|
|---|----|-----|
|基本类型|undefined（未定义）|typeof undefined === "undefined"|
|基本类型|boolean（布尔值）|typeof true === "boolean"|
|基本类型|number（数字）|typeof 42 === "number"|
|基本类型|string（字符串）|typeof "42" === "string"|
|基本类型|symbol（符号）|typeof Symbol() === "symbol"|
|基本类型|null（空值）|typeof null === "object"|
|复杂类型|object（对象）|typeof {life: 42} === "object"|
|复杂类型的子类型|function（函数）|typeof function a() {} === "function"|
|复杂类型的子类型|Array(数组)|typeof [1, 2, 3] === "object"|

###**注**

#### 1.1.1 null类型比较特殊，typeof对它的处理有问题：

`typeof null === "object"; // true`

正确的返回应该为null，但这个bug由来已久，因为这牵扯到太多的Web系统，”修复“它会产生更多的bug，令许多系统无法正常工作。

我们需要使用符合条件来检测null值的类型：

```javascript
var a = null;
(!a && typeof a === "object") // 判断a是否为null
```

#### 1.1.2 typeof运算符总会返回一个字符串

`typeof typeof 42; // String`

typeof 42 首先返回字符串"number",然后 typeof "number" 返回 "string"



## 1.2值和类型

在JavaScript中变量是没有类型的，**只有值才有**。变量可以随时持有任何类型的值。

换个角度来理解，JavaScript不做“类型强制”；也就是说，语言引擎不要求变量总是持有与其初始值同类型的值。

一个变量可以现在被赋值为字符串类型，随后又被赋值为数字类型值。

###1.2.1 undefined和undeclared

变量在未持有值的时候为undeifined。此时typeof返回"undefined"

```javascript
var a;
typeof a; // "undefined"
```

 

大多数开发者倾向于将undefined（未定义）等同于undeclared（未声明），但在JavaScript中它们是两回事

undefined：已在作用域声明，但未赋值

undeclared：未在作用域声明

```javascript
var a;
a; // undefined 
b; // Uncaught ReferenceError: b is not defined 
```

**注**

`typeof a `和 `typeof b`返回的都是"undefined"

## 1.3 安全防范机制

> 多个脚本文件会在共享的全局命名空间中加载变量

####1.3.1. typeof 安全防范机制 

**例子1.**

在程序中使用全局变量DEBUG作为“调试模式”的开关。在输出调试信息到控制台之前，我们会检查DEBUG变量是否已经声明。顶层的全局变量声明 `var DEBUG = true;` 只有在debug.js文件中才有，而该文件只在开发和测试时才被加载到浏览器，在生产环境不予以加载。

```javascript
// 这样会抛出错误
if (DEBUG) {
    console.log("Debugging is starting");
}

// 这样是安全的
if (typeof DEBUG !== "undefined") {
    console.log("Debugging is starting");
}
```



**例子2.**

如果想别人在他们的程序或模块中赋值粘贴你的代码，就需要检查你用到的变量是否已经在宿主程序中定义过：

其他模块和程序引入doSomethingCool()时，doSomethingCool()会检查FeatureXYZ变量是否已经在宿主程序中定义过；如果是，就用现成的，否则就自己定义。

```javascript
function doSomethingCool() {
    var helper = 
        (typeof FeatureXYZ !== "undefined") ?
        FeatureXYZ : 
    	function() {/*.. default feature ..*/}
    var val = helper();
    //..
}
```

####2.依赖注入设计模式 安全防范机制

```javascript
function doSomethingCool(FeatureXYZ) {
    var helper = FeatureXYZ ||
        function() { /*.. default feature ..*/}
    var val = helper();
    // ..
}
```



#####3.window对象 安全防范机制（不推荐使用）

检查所有全局变量是否是window的属性

如果JavaScript运行在服务端，全局对象不是window，所以该方法不推荐使用

```javascript
if (window.DEBUG) {
    // ..
}
if (!window.atob) {
    // ..
}

```



## 下一篇文章

[第2章 词法作用域和动态作用域.md](https://github.com/yaoyaoniu/note/blob/master/%E3%80%8A%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript%E3%80%8B/%E3%80%8A%E4%BD%A0%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84JavaScript%E3%80%8B%E4%B8%8A%E5%8D%B7/%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E9%97%AD%E5%8C%85/2%E3%80%81%E8%AF%8D%E6%B3%95%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E5%8A%A8%E6%80%81%E4%BD%9C%E7%94%A8%E5%9F%9F.md)

## 《你不知道的JavaScript》

如果有错误或者不严谨的地方，请务必给予指正，十分感谢。如果喜欢或者有所启发，欢迎star，对作者也是一种鼓励。




