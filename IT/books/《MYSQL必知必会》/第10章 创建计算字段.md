# 第10章 创建计算字段

## 10.1 计算字段

**存储在数据库表中的数据一般不是应用程序所需要的格式。**

我们需要直接从数据库中检索出转换、计算或格式化过的数据；而不是检索出数据，然后再在客户机应用程序或报告程序中重新格式化。这就是计算字段发挥作用的所在了。

**注：**

* 字段（field ） 基本上与列（column）的意思相同，经常互换使用，不过数据库列一般称为列，而术语字段通常用在计算字段的连接上。


* 重要的是要注意到，只有数据库知道SELECT 语句中哪些列是实际的表列，哪些列是计算字段。从客户机（如应用程序）的角度来看，计算字段的数据是以与其他列的数据相同的方式返回的。

## 10.2 拼接字段

**将值联结到一起构成单个值。**
**示例**
```
SELECT Concat(vend_name, '(', vend_country ,')')
FROM vendors
ORDER BY vend_name;
```
**分析**

Concat()拼接串，即把多个串连接起来形成一个较长的串。Concat()需要一个或多个指定的串，各个串之间用逗号分隔。

上面的SELECT 语句连接以下4 个元素：

*  存储在vend_name 列中的名字；
*  包含一个空格和一个左圆括号的串；
*  存储在vend_country 列中的国家；
*  包含一个右圆括号的串。

**示例**
```
SELECT Concat(RTrim(vend_name), '(', RTrim(vend_country), ')') AS vend_title
FROM vendors
ORDER BY vend_name;
```

**分析**

RTrim()函数去掉值右边的所有空格。通过使用RTrim()，各个列都进行了整理。 计算字段之后跟了文本AS vend_title 。它指示SQL 创建一个包含指定计算的名为vend_title 的计算字段。

**Trim函数**

RTrim()（正如刚才所见，它去掉串右边的空格）

LTrim()（去掉串左边的空格）以及

Trim()（去掉串左右两边的空格）



## 10.3 执行算术计算

 计算字段的另一常见用途是对检索出的数据进行算术计算。

 举一个例子，orders 表包含收到的所有订单，orderitems 表包含每个订单中的各项物品。下面的SQL 语句检索订单号20005 中的所有物品：

```
SELECT prod_id, quantity, item_price
FROM orderitems
WHERE order_num = 2005;
```

item_price列包含订单中每项物品的单价。

**如果需要汇总物品的价格** 

```
SELECT prod_id,
	   quantity,
	   item_price,
	   quantity * item_price AS expanded_price
FROM orderitems
WHERE order_num = 20005;
```

**分析**

输出中显示的expanded_price 列为一个计算字段，此计算为quantity*item_price 。客户机应用现在可以使用这个新计算列，就像使用其他列一样。

MySQL支持表 10-1中列出的基本算术操作符。此外，圆括号可用来区分优先顺序。

| 操作符 | 说  明 |
| :----: | :----: |
|   +    |   加   |
|   -    |   减   |
|   *    |   乘   |
|   /    |   除   |










