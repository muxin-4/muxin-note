# 第 7 章、确保Web安全的HTTPS

> 在HTTP协议中有可能存在信息窃听或身份伪装等安全问题。使用HTTPS通信机制可以有效防止这些问题。

### HTTP的缺点

- **通信使用明文（不加密），内容可能会被窃听**
  - 问题：窃听
    - TCP/IP是可能被窃听的网络，使用抓包工具或嗅探器
  - 解决：**加密**处理防止窃听
    - 通信加密，SSL或TLS的组合使用，简历安全通信线路，在这条安全线路上，进行HTTP通信
    - 内容加密，客户端加密后，发送到服务端解密，内容仍有被篡改的风险。
- **不验证通信方的身份，因此有可能遭遇伪装**
  - 问题：任何人都可发起请求
    - 有可能是已伪装的服务器
    - 有可能是已伪装的客户端
    - 无法确定正在通信的对方是否具备访问权限
    - 无法判定请求是来自何方、出自谁手
    - 即使无意义的请求也会照单全收。无法阻止海量请求下的DoS攻击
  - 解决：使用**证书**，证明服务器和客户端是实际存在的，证书由值得信任的第三方机构颁发
- **无法证明报文的完整性，所以有可能已遭篡改**

> 所谓完整性是指信息的准确度。若无法证明其完整性，通常也就意味着无法判断信息是否准确

  - 问题：接收到的内容可能有误
    - 没有任何办法确认，发出的请求 / 响应和接收到的请求 / 响应式前后相同的
    - 请求或响应在传输途中，遭攻击者拦截并篡改内容的攻击称为中间人攻击（Man-in-the-Middle attack, MITM）
- 解决：
  - HTTP协议解决，不便捷、可靠
    - 虽然有使用HTTP协议确定报文完整性的方法，但事实上并不便捷、可靠。
    - 其中常用的是MD5和SHA-1 等散列值校验的方法，以及用来确认文件的数字签名方法PGP。
    - 可惜的是，用这些方法也无法百分百保证确认结果正确。因为PGP和MD5本身可能会被改写，用户无法意识到
  - HTTPS解决
    - SSL提供**摘要功能**，确保信息完整性

### HTTPS = HTTP协议 + （加密 + 证书 + 完整性保护） = HTTP协议 + （SSL协议 + TLS协议）



// todo 

p150 -p164暂未读懂，待读过《密码学原理》，再记录这部分笔记

### SSL证书

- DV SSL 域名型
- OV SSL 企业型
- EV SSL 增强型



### 为什么不一直使用HTTPS

- 与纯文本通信相比，加密通信会消耗更多的CPU及内存资源。如果每次通信都加密，会消耗相当多的资源，平摊一台计算机上时，能够处理的请求数量必定也会随之减少，**因此，如果是非敏感信息则使用HTTP通信，只有在包含个人信息等敏感数据时，采利用HTTPS加密通信**
- 节约购买证书的开销，通常证书一年的授权大约需要600人民币