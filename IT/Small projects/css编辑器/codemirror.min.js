(function(a){if(typeof exports=="object"&&typeof module=="object"){module.exports=a()}else{if(typeof define=="function"&&define.amd){return define([],a)}else{this.CodeMirror=a()}}})(function(){var co=/gecko\/\d/i.test(navigator.userAgent);var eK=/MSIE \d/.test(navigator.userAgent);var bJ=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);var dK=eK||bJ;var k=dK&&(eK?document.documentMode||6:bJ[1]);var c0=/WebKit\//.test(navigator.userAgent);var dN=c0&&/Qt\/\d+\.\d+/.test(navigator.userAgent);var dc=/Chrome\//.test(navigator.userAgent);var d3=/Opera\//.test(navigator.userAgent);var aC=/Apple Computer/.test(navigator.vendor);var c7=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent);var fu=/PhantomJS/.test(navigator.userAgent);var e1=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent);var eg=e1||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);var b7=e1||/Mac/.test(navigator.platform);var aP=/win/i.test(navigator.platform);var aZ=d3&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);if(aZ){aZ=Number(aZ[1])}if(aZ&&aZ>=15){d3=false;c0=true}var bQ=b7&&(dN||d3&&(aZ==null||aZ<12.11));var f8=co||(dK&&k>=9);var gb=false,a8=false;function H(gh,gj){if(!(this instanceof H)){return new H(gh,gj)}this.options=gj=gj?aN(gj):{};aN(e3,gj,false);ce(gj);var gn=gj.value;if(typeof gn=="string"){gn=new at(gn,gj.mode)}this.doc=gn;var gi=new H.inputStyles[gj.inputStyle](this);var gm=this.display=new eI(gh,gn,gi);gm.wrapper.CodeMirror=this;ec(this);cO(this);if(gj.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}if(gj.autofocus&&!eg){gm.input.focus()}aD(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,delayingBlurEvent:false,focused:false,suppressEdits:false,pasteIncoming:false,cutIncoming:false,draggingText:false,highlight:new gf(),keySeq:null,specialChars:null};var gg=this;if(dK&&k<11){setTimeout(function(){gg.display.input.reset(true)},20)}fQ(this);bj();cI(this);this.curOp.forceUpdate=true;eb(this,gn);if((gj.autofocus&&!eg)||gg.hasFocus()){setTimeout(cv(cB,this),20)}else{aV(this)}for(var gl in bf){if(bf.hasOwnProperty(gl)){bf[gl](this,gj[gl],cc)}}d5(this);if(gj.finishInit){gj.finishInit(this)}for(var gk=0;gk<a9.length;++gk){a9[gk](this)}am(this);if(c0&&gj.lineWrapping&&getComputedStyle(gm.lineDiv).textRendering=="optimizelegibility"){gm.lineDiv.style.textRendering="auto"}}function eI(gg,gi,gh){var gj=this;this.input=gh;gj.scrollbarFiller=f1("div",null,"CodeMirror-scrollbar-filler");gj.scrollbarFiller.setAttribute("cm-not-content","true");gj.gutterFiller=f1("div",null,"CodeMirror-gutter-filler");gj.gutterFiller.setAttribute("cm-not-content","true");gj.lineDiv=f1("div",null,"CodeMirror-code");gj.selectionDiv=f1("div",null,null,"position: relative; z-index: 1");gj.cursorDiv=f1("div",null,"CodeMirror-cursors");gj.measure=f1("div",null,"CodeMirror-measure");gj.lineMeasure=f1("div",null,"CodeMirror-measure");gj.lineSpace=f1("div",[gj.measure,gj.lineMeasure,gj.selectionDiv,gj.cursorDiv,gj.lineDiv],null,"position: relative; outline: none");gj.mover=f1("div",[f1("div",[gj.lineSpace],"CodeMirror-lines")],null,"position: relative");gj.sizer=f1("div",[gj.mover],"CodeMirror-sizer");gj.sizerWidth=null;gj.heightForcer=f1("div",null,null,"position: absolute; height: "+dJ+"px; width: 1px;");gj.gutters=f1("div",null,"CodeMirror-gutters");gj.lineGutter=null;gj.scroller=f1("div",[gj.sizer,gj.heightForcer,gj.gutters],"CodeMirror-scroll");gj.scroller.setAttribute("tabIndex","-1");gj.wrapper=f1("div",[gj.scrollbarFiller,gj.gutterFiller,gj.scroller],"CodeMirror");if(dK&&k<8){gj.gutters.style.zIndex=-1;gj.scroller.style.paddingRight=0}if(!c0&&!(co&&eg)){gj.scroller.draggable=true}if(gg){if(gg.appendChild){gg.appendChild(gj.wrapper)}else{gg(gj.wrapper)}}gj.viewFrom=gj.viewTo=gi.first;gj.reportedViewFrom=gj.reportedViewTo=gi.first;gj.view=[];gj.renderedView=null;gj.externalMeasured=null;gj.viewOffset=0;gj.lastWrapHeight=gj.lastWrapWidth=0;gj.updateLineNumbers=null;gj.nativeBarWidth=gj.barHeight=gj.barWidth=0;gj.scrollbarsClipped=false;gj.lineNumWidth=gj.lineNumInnerWidth=gj.lineNumChars=null;gj.alignWidgets=false;gj.cachedCharWidth=gj.cachedTextHeight=gj.cachedPaddingH=null;gj.maxLine=null;gj.maxLineLength=0;gj.maxLineChanged=false;gj.wheelDX=gj.wheelDY=gj.wheelStartX=gj.wheelStartY=null;gj.shift=false;gj.selForContextMenu=null;gj.activeTouch=null;gh.init(gj)}function br(gg){gg.doc.mode=H.getMode(gg.options,gg.doc.modeOption);el(gg)}function el(gg){gg.doc.iter(function(gh){if(gh.stateAfter){gh.stateAfter=null}if(gh.styles){gh.styles=null}});gg.doc.frontier=gg.doc.first;ef(gg,100);gg.state.modeGen++;if(gg.curOp){ah(gg)}}function eG(gg){if(gg.options.lineWrapping){fA(gg.display.wrapper,"CodeMirror-wrap");gg.display.sizer.style.minWidth="";gg.display.sizerWidth=null}else{f(gg.display.wrapper,"CodeMirror-wrap");g(gg)}X(gg);ah(gg);ak(gg);setTimeout(function(){eY(gg)},100)}function be(gg){var gi=aY(gg.display),gh=gg.options.lineWrapping;var gj=gh&&Math.max(5,gg.display.scroller.clientWidth/dD(gg.display)-3);return function(gl){if(fw(gg.doc,gl)){return 0}var gk=0;if(gl.widgets){for(var gm=0;gm<gl.widgets.length;gm++){if(gl.widgets[gm].height){gk+=gl.widgets[gm].height}}}if(gh){return gk+(Math.ceil(gl.text.length/gj)||1)*gi}else{return gk+gi}}}function X(gg){var gi=gg.doc,gh=be(gg);gi.iter(function(gj){var gk=gh(gj);if(gk!=gj.height){f4(gj,gk)}})}function cO(gg){gg.display.wrapper.className=gg.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+gg.options.theme.replace(/(^|\s)\s*/g," cm-s-");ak(gg)}function dw(gg){ec(gg);ah(gg);setTimeout(function(){eE(gg)},20)}function ec(gg){var gh=gg.display.gutters,gl=gg.options.gutters;d1(gh);for(var gi=0;gi<gl.length;++gi){var gj=gl[gi];var gk=gh.appendChild(f1("div",null,"CodeMirror-gutter "+gj));if(gj=="CodeMirror-linenumbers"){gg.display.lineGutter=gk;gk.style.width=(gg.display.lineNumWidth||1)+"px"}}gh.style.display=gi?"":"none";c4(gg)}function c4(gg){var gh=gg.display.gutters.offsetWidth;gg.display.sizer.style.marginLeft=gh+"px"}function en(gi){if(gi.height==0){return 0}var gh=gi.text.length,gg,gk=gi;while(gg=eO(gk)){var gj=gg.find(0,true);gk=gj.from.line;gh+=gj.from.ch-gj.to.ch}gk=gi;while(gg=ew(gk)){var gj=gg.find(0,true);gh-=gk.text.length-gj.from.ch;gk=gj.to.line;gh+=gk.text.length-gj.to.ch}return gh}function g(gg){var gi=gg.display,gh=gg.doc;gi.maxLine=ff(gh,gh.first);gi.maxLineLength=en(gi.maxLine);gi.maxLineChanged=true;gh.iter(function(gk){var gj=en(gk);if(gj>gi.maxLineLength){gi.maxLineLength=gj;gi.maxLine=gk}})}function ce(gg){var gh=dh(gg.gutters,"CodeMirror-linenumbers");if(gh==-1&&gg.lineNumbers){gg.gutters=gg.gutters.concat(["CodeMirror-linenumbers"])}else{if(gh>-1&&!gg.lineNumbers){gg.gutters=gg.gutters.slice(0);gg.gutters.splice(gh,1)}}}function dA(gg){var gj=gg.display,gi=gj.gutters.offsetWidth;var gh=Math.round(gg.doc.height+bI(gg.display));return{clientHeight:gj.scroller.clientHeight,viewHeight:gj.wrapper.clientHeight,scrollWidth:gj.scroller.scrollWidth,clientWidth:gj.scroller.clientWidth,viewWidth:gj.wrapper.clientWidth,barLeft:gg.options.fixedGutter?gi:0,docHeight:gh,scrollHeight:gh+cT(gg)+gj.barHeight,nativeBarWidth:gj.nativeBarWidth,gutterWidth:gi}}function dk(gi,gh,gg){this.cm=gg;var gj=this.vert=f1("div",[f1("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");var gk=this.horiz=f1("div",[f1("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");gi(gj);gi(gk);bX(gj,"scroll",function(){if(gj.clientHeight){gh(gj.scrollTop,"vertical")}});bX(gk,"scroll",function(){if(gk.clientWidth){gh(gk.scrollLeft,"horizontal")}});this.checkedOverlay=false;if(dK&&k<8){this.horiz.style.minHeight=this.vert.style.minWidth="18px"}}dk.prototype=aN({update:function(gj){var gk=gj.scrollWidth>gj.clientWidth+1;var gi=gj.scrollHeight>gj.clientHeight+1;var gl=gj.nativeBarWidth;if(gi){this.vert.style.display="block";this.vert.style.bottom=gk?gl+"px":"0";var gh=gj.viewHeight-(gk?gl:0);this.vert.firstChild.style.height=Math.max(0,gj.scrollHeight-gj.clientHeight+gh)+"px"}else{this.vert.style.display="";this.vert.firstChild.style.height="0"}if(gk){this.horiz.style.display="block";this.horiz.style.right=gi?gl+"px":"0";this.horiz.style.left=gj.barLeft+"px";var gg=gj.viewWidth-gj.barLeft-(gi?gl:0);this.horiz.firstChild.style.width=(gj.scrollWidth-gj.clientWidth+gg)+"px"}else{this.horiz.style.display="";this.horiz.firstChild.style.width="0"}if(!this.checkedOverlay&&gj.clientHeight>0){if(gl==0){this.overlayHack()}this.checkedOverlay=true}return{right:gi?gl:0,bottom:gk?gl:0}},setScrollLeft:function(gg){if(this.horiz.scrollLeft!=gg){this.horiz.scrollLeft=gg}},setScrollTop:function(gg){if(this.vert.scrollTop!=gg){this.vert.scrollTop=gg}},overlayHack:function(){var gg=b7&&!c7?"12px":"18px";this.horiz.style.minHeight=this.vert.style.minWidth=gg;var gh=this;var gi=function(gj){if(L(gj)!=gh.vert&&L(gj)!=gh.horiz){c2(gh.cm,eu)(gj)}};bX(this.vert,"mousedown",gi);bX(this.horiz,"mousedown",gi)},clear:function(){var gg=this.horiz.parentNode;gg.removeChild(this.horiz);gg.removeChild(this.vert)}},dk.prototype);function e4(){}e4.prototype=aN({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},e4.prototype);H.scrollbarModel={"native":dk,"null":e4};function aD(gg){if(gg.display.scrollbars){gg.display.scrollbars.clear();if(gg.display.scrollbars.addClass){f(gg.display.wrapper,gg.display.scrollbars.addClass)}}gg.display.scrollbars=new H.scrollbarModel[gg.options.scrollbarStyle](function(gh){gg.display.wrapper.insertBefore(gh,gg.display.scrollbarFiller);bX(gh,"mousedown",function(){if(gg.state.focused){setTimeout(function(){gg.display.input.focus()},0)}});gh.setAttribute("cm-not-content","true")},function(gi,gh){if(gh=="horizontal"){bE(gg,gi)}else{N(gg,gi)}},gg);if(gg.display.scrollbars.addClass){fA(gg.display.wrapper,gg.display.scrollbars.addClass)}}function eY(gi,gk){if(!gk){gk=dA(gi)}var gh=gi.display.barWidth,gg=gi.display.barHeight;aU(gi,gk);for(var gj=0;gj<4&&gh!=gi.display.barWidth||gg!=gi.display.barHeight;gj++){if(gh!=gi.display.barWidth&&gi.options.lineWrapping){ba(gi)}aU(gi,dA(gi));gh=gi.display.barWidth;gg=gi.display.barHeight}}function aU(gg,gh){var gj=gg.display;var gi=gj.scrollbars.update(gh);gj.sizer.style.paddingRight=(gj.barWidth=gi.right)+"px";gj.sizer.style.paddingBottom=(gj.barHeight=gi.bottom)+"px";if(gi.right&&gi.bottom){gj.scrollbarFiller.style.display="block";gj.scrollbarFiller.style.height=gi.bottom+"px";gj.scrollbarFiller.style.width=gi.right+"px"}else{gj.scrollbarFiller.style.display=""}if(gi.bottom&&gg.options.coverGutterNextToScrollbar&&gg.options.fixedGutter){gj.gutterFiller.style.display="block";gj.gutterFiller.style.height=gi.bottom+"px";gj.gutterFiller.style.width=gh.gutterWidth+"px"}else{gj.gutterFiller.style.display=""}}function b6(gj,gn,gi){var gk=gi&&gi.top!=null?Math.max(0,gi.top):gj.scroller.scrollTop;gk=Math.floor(gk-e8(gj));var gg=gi&&gi.bottom!=null?gi.bottom:gk+gj.wrapper.clientHeight;var gl=bG(gn,gk),gm=bG(gn,gg);if(gi&&gi.ensure){var gh=gi.ensure.from.line,go=gi.ensure.to.line;if(gh<gl){gl=gh;gm=bG(gn,bM(ff(gn,gh))+gj.wrapper.clientHeight)}else{if(Math.min(go,gn.lastLine())>=gm){gl=bG(gn,bM(ff(gn,go))-gj.wrapper.clientHeight);gm=go}}}return{from:gl,to:Math.max(gm,gl+1)}}function eE(go){var gm=go.display,gn=gm.view;if(!gm.alignWidgets&&(!gm.gutters.firstChild||!go.options.fixedGutter)){return}var gk=dX(gm)-gm.scroller.scrollLeft+go.doc.scrollLeft;var gg=gm.gutters.offsetWidth,gh=gk+"px";for(var gj=0;gj<gn.length;gj++){if(!gn[gj].hidden){if(go.options.fixedGutter&&gn[gj].gutter){gn[gj].gutter.style.left=gh}var gl=gn[gj].alignable;if(gl){for(var gi=0;gi<gl.length;gi++){gl[gi].style.left=gh}}}}if(go.options.fixedGutter){gm.gutters.style.left=(gk+gg)+"px"}}function d5(gg){if(!gg.options.lineNumbers){return false}var gl=gg.doc,gh=es(gg.options,gl.first+gl.size-1),gk=gg.display;if(gh.length!=gk.lineNumChars){var gm=gk.measure.appendChild(f1("div",[f1("div",gh)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var gi=gm.firstChild.offsetWidth,gj=gm.offsetWidth-gi;gk.lineGutter.style.width="";gk.lineNumInnerWidth=Math.max(gi,gk.lineGutter.offsetWidth-gj)+1;gk.lineNumWidth=gk.lineNumInnerWidth+gj;gk.lineNumChars=gk.lineNumInnerWidth?gh.length:-1;gk.lineGutter.style.width=gk.lineNumWidth+"px";c4(gg);return true}return false}function es(gg,gh){return String(gg.lineNumberFormatter(gh+gg.firstLineNumber))}function dX(gg){return gg.scroller.getBoundingClientRect().left-gg.sizer.getBoundingClientRect().left}function aI(gh,gg,gi){var gj=gh.display;this.viewport=gg;this.visible=b6(gj,gh.doc,gg);this.editorIsHidden=!gj.wrapper.offsetWidth;this.wrapperHeight=gj.wrapper.clientHeight;this.wrapperWidth=gj.wrapper.clientWidth;this.oldDisplayWidth=dl(gh);this.force=gi;this.dims=fd(gh);this.events=[]}aI.prototype.signal=function(gh,gg){if(fi(gh,gg)){this.events.push(arguments)}};aI.prototype.finish=function(){for(var gg=0;gg<this.events.length;gg++){aE.apply(null,this.events[gg])}};function J(gg){var gh=gg.display;if(!gh.scrollbarsClipped&&gh.scroller.offsetWidth){gh.nativeBarWidth=gh.scroller.offsetWidth-gh.scroller.clientWidth;gh.heightForcer.style.height=cT(gg)+"px";gh.sizer.style.marginBottom=-gh.nativeBarWidth+"px";gh.sizer.style.borderRightWidth=cT(gg)+"px";gh.scrollbarsClipped=true}}function B(gp,gj){var gk=gp.display,go=gp.doc;if(gj.editorIsHidden){ex(gp);return false}if(!gj.force&&gj.visible.from>=gk.viewFrom&&gj.visible.to<=gk.viewTo&&(gk.updateLineNumbers==null||gk.updateLineNumbers>=gk.viewTo)&&gk.renderedView==gk.view&&db(gp)==0){return false}if(d5(gp)){ex(gp);gj.dims=fd(gp)}var gi=go.first+go.size;var gm=Math.max(gj.visible.from-gp.options.viewportMargin,go.first);var gn=Math.min(gi,gj.visible.to+gp.options.viewportMargin);if(gk.viewFrom<gm&&gm-gk.viewFrom<20){gm=Math.max(go.first,gk.viewFrom)}if(gk.viewTo>gn&&gk.viewTo-gn<20){gn=Math.min(gi,gk.viewTo)}if(a8){gm=aW(gp.doc,gm);gn=d2(gp.doc,gn)}var gh=gm!=gk.viewFrom||gn!=gk.viewTo||gk.lastWrapHeight!=gj.wrapperHeight||gk.lastWrapWidth!=gj.wrapperWidth;cR(gp,gm,gn);gk.viewOffset=bM(ff(gp.doc,gk.viewFrom));gp.display.mover.style.top=gk.viewOffset+"px";var gg=db(gp);if(!gh&&gg==0&&!gj.force&&gk.renderedView==gk.view&&(gk.updateLineNumbers==null||gk.updateLineNumbers>=gk.viewTo)){return false}var gl=dO();if(gg>4){gk.lineDiv.style.display="none"}cm(gp,gk.updateLineNumbers,gj.dims);if(gg>4){gk.lineDiv.style.display=""}gk.renderedView=gk.view;if(gl&&dO()!=gl&&gl.offsetHeight){gl.focus()}d1(gk.cursorDiv);d1(gk.selectionDiv);gk.gutters.style.height=0;if(gh){gk.lastWrapHeight=gj.wrapperHeight;gk.lastWrapWidth=gj.wrapperWidth;ef(gp,400)}gk.updateLineNumbers=null;return true}function cj(gh,gl){var gj=gl.force,gg=gl.viewport;for(var gk=true;;gk=false){if(gk&&gh.options.lineWrapping&&gl.oldDisplayWidth!=dl(gh)){gj=true}else{gj=false;if(gg&&gg.top!=null){gg={top:Math.min(gh.doc.height+bI(gh.display)-cV(gh),gg.top)}}gl.visible=b6(gh.display,gh.doc,gg);if(gl.visible.from>=gh.display.viewFrom&&gl.visible.to<=gh.display.viewTo){break}}if(!B(gh,gl)){break}ba(gh);var gi=dA(gh);bC(gh);dz(gh,gi);eY(gh,gi)}gl.signal(gh,"update",gh);if(gh.display.viewFrom!=gh.display.reportedViewFrom||gh.display.viewTo!=gh.display.reportedViewTo){gl.signal(gh,"viewportChange",gh,gh.display.viewFrom,gh.display.viewTo);gh.display.reportedViewFrom=gh.display.viewFrom;gh.display.reportedViewTo=gh.display.viewTo}}function dT(gh,gg){var gj=new aI(gh,gg);if(B(gh,gj)){ba(gh);cj(gh,gj);var gi=dA(gh);bC(gh);dz(gh,gi);eY(gh,gi);gj.finish()}}function dz(gg,gh){gg.display.sizer.style.minHeight=gh.docHeight+"px";var gi=gh.docHeight+gg.display.barHeight;gg.display.heightForcer.style.top=gi+"px";gg.display.gutters.style.height=Math.max(gi+cT(gg),gh.clientHeight)+"px"}function ba(gn){var gl=gn.display;var gh=gl.lineDiv.offsetTop;for(var gi=0;gi<gl.view.length;gi++){var go=gl.view[gi],gp;if(go.hidden){continue}if(dK&&k<8){var gk=go.node.offsetTop+go.node.offsetHeight;gp=gk-gh;gh=gk}else{var gj=go.node.getBoundingClientRect();gp=gj.bottom-gj.top}var gm=go.line.height-gp;if(gp<2){gp=aY(gl)}if(gm>0.001||gm<-0.001){f4(go.line,gp);cb(go.line);if(go.rest){for(var gg=0;gg<go.rest.length;gg++){cb(go.rest[gg])}}}}}function cb(gg){if(gg.widgets){for(var gh=0;gh<gg.widgets.length;++gh){gg.widgets[gh].height=gg.widgets[gh].node.offsetHeight}}}function fd(gg){var gl=gg.display,gj={},gi={};var gk=gl.gutters.clientLeft;for(var gm=gl.gutters.firstChild,gh=0;gm;gm=gm.nextSibling,++gh){gj[gg.options.gutters[gh]]=gm.offsetLeft+gm.clientLeft+gk;gi[gg.options.gutters[gh]]=gm.clientWidth}return{fixedPos:dX(gl),gutterTotalWidth:gl.gutters.offsetWidth,gutterLeft:gj,gutterWidth:gi,wrapperWidth:gl.wrapper.clientWidth}}function cm(gr,gi,gq){var gn=gr.display,gt=gr.options.lineNumbers;var gg=gn.lineDiv,gs=gg.firstChild;function gm(gv){var gu=gv.nextSibling;if(c0&&b7&&gr.display.currentWheelTarget==gv){gv.style.display="none"}else{gv.parentNode.removeChild(gv)}return gu}var go=gn.view,gl=gn.viewFrom;for(var gj=0;gj<go.length;gj++){var gk=go[gj];if(gk.hidden){}else{if(!gk.node||gk.node.parentNode!=gg){var gh=aF(gr,gk,gl,gq);gg.insertBefore(gh,gs)}else{while(gs!=gk.node){gs=gm(gs)}var gp=gt&&gi!=null&&gi<=gl&&gk.lineNumber;if(gk.changes){if(dh(gk.changes,"gutter")>-1){gp=false}ab(gr,gk,gl,gq)}if(gp){d1(gk.lineNumber);gk.lineNumber.appendChild(document.createTextNode(es(gr.options,gl)))}gs=gk.node.nextSibling}}gl+=gk.size}while(gs){gs=gm(gs)}}function ab(gg,gi,gk,gl){for(var gh=0;gh<gi.changes.length;gh++){var gj=gi.changes[gh];if(gj=="text"){fl(gg,gi)}else{if(gj=="gutter"){df(gg,gi,gk,gl)}else{if(gj=="class"){dG(gi)}else{if(gj=="widget"){ao(gg,gi,gl)}}}}}gi.changes=null}function fH(gg){if(gg.node==gg.text){gg.node=f1("div",null,null,"position: relative");if(gg.text.parentNode){gg.text.parentNode.replaceChild(gg.node,gg.text)}gg.node.appendChild(gg.text);if(dK&&k<8){gg.node.style.zIndex=2}}return gg.node}function ev(gh){var gg=gh.bgClass?gh.bgClass+" "+(gh.line.bgClass||""):gh.line.bgClass;if(gg){gg+=" CodeMirror-linebackground"}if(gh.background){if(gg){gh.background.className=gg}else{gh.background.parentNode.removeChild(gh.background);gh.background=null}}else{if(gg){var gi=fH(gh);gh.background=gi.insertBefore(f1("div",null,gg),gi.firstChild)}}}function dV(gg,gh){var gi=gg.display.externalMeasured;if(gi&&gi.line==gh.line){gg.display.externalMeasured=null;gh.measure=gi.measure;return gi.built}return eR(gg,gh)}function fl(gg,gj){var gh=gj.text.className;var gi=dV(gg,gj);if(gj.text==gj.node){gj.node=gi.pre}gj.text.parentNode.replaceChild(gi.pre,gj.text);gj.text=gi.pre;if(gi.bgClass!=gj.bgClass||gi.textClass!=gj.textClass){gj.bgClass=gi.bgClass;gj.textClass=gi.textClass;dG(gj)}else{if(gh){gj.text.className=gh}}}function dG(gh){ev(gh);if(gh.line.wrapClass){fH(gh).className=gh.line.wrapClass}else{if(gh.node!=gh.text){gh.node.className=""}}var gg=gh.textClass?gh.textClass+" "+(gh.line.textClass||""):gh.line.textClass;gh.text.className=gg||""}function df(go,gm,gl,gn){if(gm.gutter){gm.node.removeChild(gm.gutter);gm.gutter=null}var gj=gm.line.gutterMarkers;if(go.options.lineNumbers||gj){var gh=fH(gm);var gk=gm.gutter=f1("div",null,"CodeMirror-gutter-wrapper","left: "+(go.options.fixedGutter?gn.fixedPos:-gn.gutterTotalWidth)+"px; width: "+gn.gutterTotalWidth+"px");go.display.input.setUneditable(gk);gh.insertBefore(gk,gm.text);if(gm.line.gutterClass){gk.className+=" "+gm.line.gutterClass}if(go.options.lineNumbers&&(!gj||!gj["CodeMirror-linenumbers"])){gm.lineNumber=gk.appendChild(f1("div",es(go.options,gl),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+gn.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+go.display.lineNumInnerWidth+"px"))}if(gj){for(var gi=0;gi<go.options.gutters.length;++gi){var gg=go.options.gutters[gi],gp=gj.hasOwnProperty(gg)&&gj[gg];if(gp){gk.appendChild(f1("div",[gp],"CodeMirror-gutter-elt","left: "+gn.gutterLeft[gg]+"px; width: "+gn.gutterWidth[gg]+"px"))}}}}}function ao(gg,gh,gk){if(gh.alignable){gh.alignable=null}for(var gj=gh.node.firstChild,gi;gj;gj=gi){var gi=gj.nextSibling;if(gj.className=="CodeMirror-linewidget"){gh.node.removeChild(gj)}}ft(gg,gh,gk)}function aF(gg,gi,gj,gk){var gh=dV(gg,gi);gi.text=gi.node=gh.pre;if(gh.bgClass){gi.bgClass=gh.bgClass}if(gh.textClass){gi.textClass=gh.textClass}dG(gi);df(gg,gi,gj,gk);ft(gg,gi,gk);return gi.node}function ft(gg,gi,gj){f6(gg,gi.line,gi,gj,true);if(gi.rest){for(var gh=0;gh<gi.rest.length;gh++){f6(gg,gi.rest[gh],gi,gj,false)}}}function f6(go,gp,gl,gn,gj){if(!gp.widgets){return}var gg=fH(gl);for(var gi=0,gm=gp.widgets;gi<gm.length;++gi){var gk=gm[gi],gh=f1("div",[gk.node],"CodeMirror-linewidget");if(!gk.handleMouseEvents){gh.setAttribute("cm-ignore-events","true")}bF(gk,gh,gl,gn);go.display.input.setUneditable(gh);if(gj&&gk.above){gg.insertBefore(gh,gl.gutter||gl.text)}else{gg.appendChild(gh)}ae(gk,"redraw")}}function bF(gj,gi,gg,gk){if(gj.noHScroll){(gg.alignable||(gg.alignable=[])).push(gi);var gh=gk.wrapperWidth;gi.style.left=gk.fixedPos+"px";if(!gj.coverGutter){gh-=gk.gutterTotalWidth;gi.style.paddingLeft=gk.gutterTotalWidth+"px"}gi.style.width=gh+"px"}if(gj.coverGutter){gi.style.zIndex=5;gi.style.position="relative";if(!gj.noHScroll){gi.style.marginLeft=-gk.gutterTotalWidth+"px"}}}var W=H.Pos=function(gg,gh){if(!(this instanceof W)){return new W(gg,gh)}this.line=gg;this.ch=gh};var cf=H.cmpPos=function(gh,gg){return gh.line-gg.line||gh.ch-gg.ch};function ci(gg){return W(gg.line,gg.ch)}function bx(gh,gg){return cf(gh,gg)<0?gg:gh}function ar(gh,gg){return cf(gh,gg)<0?gh:gg}function r(gg){if(!gg.state.focused){gg.display.input.focus();cB(gg)}}function aj(gg){return gg.options.readOnly||gg.doc.cantEdit}var bm=null;function fX(gk,gh,gl,gq,gw){var gx=gk.doc;gk.display.shift=false;if(!gq){gq=gx.sel}var gn=a1(gh),gv=null;if(gk.state.pasteIncoming&&gq.ranges.length>1){if(bm&&bm.join("\n")==gh){gv=gq.ranges.length%bm.length==0&&bS(bm,a1)}else{if(gn.length==gq.ranges.length){gv=bS(gn,function(gy){return[gy]})}}}for(var gt=gq.ranges.length-1;gt>=0;gt--){var go=gq.ranges[gt];var gr=go.from(),gg=go.to();if(go.empty()){if(gl&&gl>0){gr=W(gr.line,gr.ch-gl)}else{if(gk.state.overwrite&&!gk.state.pasteIncoming){gg=W(gg.line,Math.min(ff(gx,gg.line).text.length,gg.ch+fG(gn).length))}}}var gj=gk.curOp.updateInput;var gu={from:gr,to:gg,text:gv?gv[gt%gv.length]:gn,origin:gw||(gk.state.pasteIncoming?"paste":gk.state.cutIncoming?"cut":"+input")};bg(gk.doc,gu);ae(gk,"inputRead",gk,gu);if(gh&&!gk.state.pasteIncoming&&gk.options.electricChars&&gk.options.smartIndent&&go.head.ch<100&&(!gt||gq.ranges[gt-1].head.line!=go.head.line)){var gm=gk.getModeAt(go.head);var gi=cX(gu);var gp=false;if(gm.electricChars){for(var gs=0;gs<gm.electricChars.length;gs++){if(gh.indexOf(gm.electricChars.charAt(gs))>-1){gp=ad(gk,gi.line,"smart");break}}}else{if(gm.electricInput){if(gm.electricInput.test(ff(gx,gi.line).text.slice(0,gi.ch))){gp=ad(gk,gi.line,"smart")}}}if(gp){ae(gk,"electricInput",gk,gi.line)}}}fF(gk);gk.curOp.updateInput=gj;gk.curOp.typing=true;gk.state.pasteIncoming=gk.state.cutIncoming=false}function dj(gg){var gl=[],gi=[];for(var gj=0;gj<gg.doc.sel.ranges.length;gj++){var gh=gg.doc.sel.ranges[gj].head.line;var gk={anchor:W(gh,0),head:W(gh+1,0)};gi.push(gk);gl.push(gg.getRange(gk.anchor,gk.head))}return{text:gl,ranges:gi}}function fP(gg){gg.setAttribute("autocorrect","off");gg.setAttribute("autocapitalize","off");gg.setAttribute("spellcheck","false")}function Y(gg){this.cm=gg;this.prevInput="";this.pollingFast=false;this.polling=new gf();this.inaccurateSelection=false;this.hasSelection=false;this.composing=null}function aX(){var gg=f1("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");var gh=f1("div",[gg],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");if(c0){gg.style.width="1000px"}else{gg.setAttribute("wrap","off")}if(e1){gg.style.border="1px solid black"}fP(gg);return gh}Y.prototype=aN({init:function(gi){var gh=this,gg=this.cm;var gl=this.wrapper=aX();var gj=this.textarea=gl.firstChild;gi.wrapper.insertBefore(gl,gi.wrapper.firstChild);if(e1){gj.style.width="0px"}bX(gj,"input",function(){if(dK&&k>=9&&gh.hasSelection){gh.hasSelection=null}gh.poll()});bX(gj,"paste",function(){if(c0&&!gg.state.fakedLastChar&&!(new Date-gg.state.lastMiddleDown<200)){var gn=gj.selectionStart,gm=gj.selectionEnd;gj.value+="$";gj.selectionEnd=gm;gj.selectionStart=gn;gg.state.fakedLastChar=true}gg.state.pasteIncoming=true;gh.fastPoll()});function gk(gn){if(gg.somethingSelected()){bm=gg.getSelections();if(gh.inaccurateSelection){gh.prevInput="";gh.inaccurateSelection=false;gj.value=bm.join("\n");dL(gj)}}else{if(!gg.options.lineWiseCopyCut){return}else{var gm=dj(gg);bm=gm.text;if(gn.type=="cut"){gg.setSelections(gm.ranges,null,Z)}else{gh.prevInput="";gj.value=gm.text.join("\n");dL(gj)}}}if(gn.type=="cut"){gg.state.cutIncoming=true}}bX(gj,"cut",gk);bX(gj,"copy",gk);bX(gi.scroller,"paste",function(gm){if(bb(gi,gm)){return}gg.state.pasteIncoming=true;gh.focus()});bX(gi.lineSpace,"selectstart",function(gm){if(!bb(gi,gm)){cG(gm)}});bX(gj,"compositionstart",function(){var gm=gg.getCursor("from");gh.composing={start:gm,range:gg.markText(gm,gg.getCursor("to"),{className:"CodeMirror-composing"})}});bX(gj,"compositionend",function(){if(gh.composing){gh.poll();gh.composing.range.clear();gh.composing=null}})},prepareSelection:function(){var gh=this.cm,gl=gh.display,gk=gh.doc;var gg=fI(gh);if(gh.options.moveInputWithCursor){var gm=dU(gh,gk.sel.primary().head,"div");var gi=gl.wrapper.getBoundingClientRect(),gj=gl.lineDiv.getBoundingClientRect();gg.teTop=Math.max(0,Math.min(gl.wrapper.clientHeight-10,gm.top+gj.top-gi.top));gg.teLeft=Math.max(0,Math.min(gl.wrapper.clientWidth-10,gm.left+gj.left-gi.left))}return gg},showSelection:function(gi){var gg=this.cm,gh=gg.display;bR(gh.cursorDiv,gi.cursors);bR(gh.selectionDiv,gi.selection);if(gi.teTop!=null){this.wrapper.style.top=gi.teTop+"px";this.wrapper.style.left=gi.teLeft+"px"}},reset:function(gk){if(this.contextMenuPending){return}var gh,gj,gg=this.cm,gm=gg.doc;if(gg.somethingSelected()){this.prevInput="";var gi=gm.sel.primary();gh=da&&(gi.to().line-gi.from().line>100||(gj=gg.getSelection()).length>1000);var gl=gh?"-":gj||gg.getSelection();this.textarea.value=gl;if(gg.state.focused){dL(this.textarea)}if(dK&&k>=9){this.hasSelection=gl}}else{if(!gk){this.prevInput=this.textarea.value="";if(dK&&k>=9){this.hasSelection=null}}}this.inaccurateSelection=gh},getField:function(){return this.textarea},supportsTouch:function(){return false},focus:function(){if(this.cm.options.readOnly!="nocursor"&&(!eg||dO()!=this.textarea)){try{this.textarea.focus()}catch(gg){}}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var gg=this;if(gg.pollingFast){return}gg.polling.set(this.cm.options.pollInterval,function(){gg.poll();if(gg.cm.state.focused){gg.slowPoll()}})},fastPoll:function(){var gh=false,gg=this;gg.pollingFast=true;function gi(){var gj=gg.poll();if(!gj&&!gh){gh=true;gg.polling.set(60,gi)}else{gg.pollingFast=false;gg.slowPoll()}}gg.polling.set(20,gi)},poll:function(){var gg=this.cm,gj=this.textarea,gk=this.prevInput;if(!gg.state.focused||(bs(gj)&&!gk)||aj(gg)||gg.options.disableInput||gg.state.keySeq){return false}if(gg.state.pasteIncoming&&gg.state.fakedLastChar){gj.value=gj.value.substring(0,gj.value.length-1);gg.state.fakedLastChar=false}var gm=gj.value;if(gm==gk&&!gg.somethingSelected()){return false}if(dK&&k>=9&&this.hasSelection===gm||b7&&/[\uf700-\uf7ff]/.test(gm)){gg.display.input.reset();return false}if(gg.doc.sel==gg.display.selForContextMenu){var gl=gm.charCodeAt(0);if(gl==8203&&!gk){gk="\u200b"}if(gl==8666){this.reset();return this.cm.execCommand("undo")}}var gn=0,gh=Math.min(gk.length,gm.length);while(gn<gh&&gk.charCodeAt(gn)==gm.charCodeAt(gn)){++gn}var gi=this;cM(gg,function(){fX(gg,gm.slice(gn),gk.length-gn,null,gi.composing?"*compose":null);if(gm.length>1000||gm.indexOf("\n")>-1){gj.value=gi.prevInput=""}else{gi.prevInput=gm}if(gi.composing){gi.composing.range.clear();gi.composing.range=gg.markText(gi.composing.start,gg.getCursor("to"),{className:"CodeMirror-composing"})}});return true},ensurePolled:function(){if(this.pollingFast&&this.poll()){this.pollingFast=false}},onKeyPress:function(){if(dK&&k>=9){this.hasSelection=null}this.fastPoll()},onContextMenu:function(gl){var gq=this,gr=gq.cm,gn=gr.display,gh=gq.textarea;var gp=cn(gr,gl),gg=gn.scroller.scrollTop;if(!gp||d3){return}var gk=gr.options.resetSelectionOnContextMenu;if(gk&&gr.doc.sel.contains(gp)==-1){c2(gr,bU)(gr.doc,eS(gp),Z)}var gm=gh.style.cssText;gq.wrapper.style.position="absolute";gh.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(gl.clientY-5)+"px; left: "+(gl.clientX-5)+"px; z-index: 1000; background: "+(dK?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";if(c0){var gs=window.scrollY}gn.input.focus();if(c0){window.scrollTo(null,gs)}gn.input.reset();if(!gr.somethingSelected()){gh.value=gq.prevInput=" "}gq.contextMenuPending=true;gn.selForContextMenu=gr.doc.sel;clearTimeout(gn.detectingSelectAll);function gj(){if(gh.selectionStart!=null){var gt=gr.somethingSelected();var gu="\u200b"+(gt?gh.value:"");gh.value="\u21da";gh.value=gu;gq.prevInput=gt?"":"\u200b";gh.selectionStart=1;gh.selectionEnd=gu.length;gn.selForContextMenu=gr.doc.sel}}function go(){gq.contextMenuPending=false;gq.wrapper.style.position="relative";gh.style.cssText=gm;if(dK&&k<9){gn.scrollbars.setScrollTop(gn.scroller.scrollTop=gg)}if(gh.selectionStart!=null){if(!dK||(dK&&k<9)){gj()}var gt=0,gu=function(){if(gn.selForContextMenu==gr.doc.sel&&gh.selectionStart==0&&gh.selectionEnd>0&&gq.prevInput=="\u200b"){c2(gr,eD.selectAll)(gr)}else{if(gt++<10){gn.detectingSelectAll=setTimeout(gu,500)}else{gn.input.reset()}}};gn.detectingSelectAll=setTimeout(gu,200)}}if(dK&&k>=9){gj()}if(f8){er(gl);var gi=function(){ed(window,"mouseup",gi);setTimeout(go,20)};bX(window,"mouseup",gi)}else{setTimeout(go,50)}},setUneditable:fU,needsContentAttribute:false},Y.prototype);function dv(gg){this.cm=gg;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new gf();this.gracePeriod=false}dv.prototype=aN({init:function(gj){var gi=this,gg=gi.cm;var gk=gi.div=gj.lineDiv;gk.contentEditable="true";fP(gk);bX(gk,"paste",function(gm){var gl=gm.clipboardData&&gm.clipboardData.getData("text/plain");if(gl){gm.preventDefault();gg.replaceSelection(gl,null,"paste")}});bX(gk,"compositionstart",function(gp){var go=gp.data;gi.composing={sel:gg.doc.sel,data:go,startData:go};if(!go){return}var gm=gg.doc.sel.primary();var gl=gg.getLine(gm.head.line);var gn=gl.indexOf(go,Math.max(0,gm.head.ch-go.length));if(gn>-1&&gn<=gm.head.ch){gi.composing.sel=eS(W(gm.head.line,gn),W(gm.head.line,gn+go.length))}});bX(gk,"compositionupdate",function(gl){gi.composing.data=gl.data});bX(gk,"compositionend",function(gm){var gl=gi.composing;if(!gl){return}if(gm.data!=gl.startData&&!/\u200b/.test(gm.data)){gl.data=gm.data}setTimeout(function(){if(!gl.handled){gi.applyComposition(gl)}if(gi.composing==gl){gi.composing=null}},50)});bX(gk,"touchstart",function(){gi.forceCompositionEnd()});bX(gk,"input",function(){if(gi.composing){return}if(!gi.pollContent()){cM(gi.cm,function(){ah(gg)})}});function gh(go){if(gg.somethingSelected()){bm=gg.getSelections();if(go.type=="cut"){gg.replaceSelection("",null,"cut")}}else{if(!gg.options.lineWiseCopyCut){return}else{var gm=dj(gg);bm=gm.text;if(go.type=="cut"){gg.operation(function(){gg.setSelections(gm.ranges,0,Z);gg.replaceSelection("",null,"cut")})}}}if(go.clipboardData&&!e1){go.preventDefault();go.clipboardData.clearData();go.clipboardData.setData("text/plain",bm.join("\n"))}else{var gn=aX(),gp=gn.firstChild;gg.display.lineSpace.insertBefore(gn,gg.display.lineSpace.firstChild);gp.value=bm.join("\n");var gl=document.activeElement;dL(gp);setTimeout(function(){gg.display.lineSpace.removeChild(gn);gl.focus()},50)}}bX(gk,"copy",gh);bX(gk,"cut",gh)},prepareSelection:function(){var gg=fI(this.cm,false);gg.focus=this.cm.state.focused;return gg},showSelection:function(gg){if(!gg||!this.cm.display.view.length){return}if(gg.focus){this.showPrimarySelection()}this.showMultipleSelections(gg)},showPrimarySelection:function(){var gk=window.getSelection(),gn=this.cm.doc.sel.primary();var gl=az(this.cm,gk.anchorNode,gk.anchorOffset);var gp=az(this.cm,gk.focusNode,gk.focusOffset);if(gl&&!gl.bad&&gp&&!gp.bad&&cf(ar(gl,gp),gn.from())==0&&cf(bx(gl,gp),gn.to())==0){return}var gj=cz(this.cm,gn.from());var go=cz(this.cm,gn.to());if(!gj&&!go){return}var gr=this.cm.display.view;var gm=gk.rangeCount&&gk.getRangeAt(0);if(!gj){gj={node:gr[0].measure.map[2],offset:0}}else{if(!go){var gi=gr[gr.length-1].measure;var gh=gi.maps?gi.maps[gi.maps.length-1]:gi.map;go={node:gh[gh.length-1],offset:gh[gh.length-2]-gh[gh.length-3]}}}try{var gg=cl(gj.node,gj.offset,go.offset,go.node)}catch(gq){}if(gg){gk.removeAllRanges();gk.addRange(gg);if(gm&&gk.anchorNode==null){gk.addRange(gm)}else{if(co){this.startGracePeriod()}}}this.rememberSelection()},startGracePeriod:function(){var gg=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){gg.gracePeriod=false;if(gg.selectionChanged()){gg.cm.operation(function(){gg.cm.curOp.selectionChanged=true})}},20)},showMultipleSelections:function(gg){bR(this.cm.display.cursorDiv,gg.cursors);bR(this.cm.display.selectionDiv,gg.selection)},rememberSelection:function(){var gg=window.getSelection();this.lastAnchorNode=gg.anchorNode;this.lastAnchorOffset=gg.anchorOffset;this.lastFocusNode=gg.focusNode;this.lastFocusOffset=gg.focusOffset},selectionInEditor:function(){var gh=window.getSelection();if(!gh.rangeCount){return false}var gg=gh.getRangeAt(0).commonAncestorContainer;return f9(this.div,gg)},focus:function(){if(this.cm.options.readOnly!="nocursor"){this.div.focus()}},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return true},receivedFocus:function(){var gg=this;if(this.selectionInEditor()){this.pollSelection()}else{cM(this.cm,function(){gg.cm.curOp.selectionChanged=true})}function gh(){if(gg.cm.state.focused){gg.pollSelection();gg.polling.set(gg.cm.options.pollInterval,gh)}}this.polling.set(this.cm.options.pollInterval,gh)},selectionChanged:function(){var gg=window.getSelection();return gg.anchorNode!=this.lastAnchorNode||gg.anchorOffset!=this.lastAnchorOffset||gg.focusNode!=this.lastFocusNode||gg.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var gj=window.getSelection(),gg=this.cm;this.rememberSelection();var gh=az(gg,gj.anchorNode,gj.anchorOffset);var gi=az(gg,gj.focusNode,gj.focusOffset);if(gh&&gi){cM(gg,function(){bU(gg.doc,eS(gh,gi),Z);if(gh.bad||gi.bad){gg.curOp.selectionChanged=true}})}}},pollContent:function(){var gq=this.cm,gA=gq.display,gy=gq.doc.sel.primary();var gz=gy.from(),gk=gy.to();if(gz.line<gA.viewFrom||gk.line>gA.viewTo-1){return false}var gn;if(gz.line==gA.viewFrom||(gn=dr(gq,gz.line))==0){var gl=bN(gA.view[0].line);var gp=gA.view[0].node}else{var gl=bN(gA.view[gn].line);var gp=gA.view[gn-1].node.nextSibling}var gx=dr(gq,gk.line);if(gx==gA.view.length-1){var gs=gA.viewTo-1;var gv=gA.view[gx].node}else{var gs=bN(gA.view[gx+1].line)-1;var gv=gA.view[gx+1].node.previousSibling}var gB=a1(fY(gq,gp,gv,gl,gs));var gu=f3(gq.doc,W(gl,0),W(gs,ff(gq.doc,gs).text.length));while(gB.length>1&&gu.length>1){if(fG(gB)==fG(gu)){gB.pop();gu.pop();gs--}else{if(gB[0]==gu[0]){gB.shift();gu.shift();gl++}else{break}}}var gw=0,gi=0;var gr=gB[0],gh=gu[0],gg=Math.min(gr.length,gh.length);while(gw<gg&&gr.charCodeAt(gw)==gh.charCodeAt(gw)){++gw}var go=fG(gB),gC=fG(gu);var gj=Math.min(go.length-(gB.length==1?gw:0),gC.length-(gu.length==1?gw:0));while(gi<gj&&go.charCodeAt(go.length-gi-1)==gC.charCodeAt(gC.length-gi-1)){++gi}gB[gB.length-1]=go.slice(0,go.length-gi);gB[0]=gB[0].slice(gw);var gm=W(gl,gw);var gt=W(gs,gu.length?fG(gu).length-gi:0);if(gB.length>1||gB[0]||cf(gm,gt)){a2(gq.doc,gB,gm,gt,"+input");return true}},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){if(!this.composing||this.composing.handled){return}this.applyComposition(this.composing);this.composing.handled=true;this.div.blur();this.div.focus()},applyComposition:function(gg){if(gg.data&&gg.data!=gg.startData){c2(this.cm,fX)(this.cm,gg.data,0,gg.sel)}},setUneditable:function(gg){gg.setAttribute("contenteditable","false")},onKeyPress:function(gg){gg.preventDefault();c2(this.cm,fX)(this.cm,String.fromCharCode(gg.charCode==null?gg.keyCode:gg.charCode),0)},onContextMenu:fU,resetPosition:fU,needsContentAttribute:true},dv.prototype);function cz(gm,gk){var gl=fb(gm,gk.line);if(!gl||gl.hidden){return null}var go=ff(gm.doc,gk.line);var gh=ct(gl,go,gk.line);var gi=a(go),gj="left";if(gi){var gg=aG(gi,gk.ch);gj=gg%2?"right":"left"}var gn=aL(gh.map,gk.ch,"left");gn.offset=gn.collapse=="right"?gn.end:gn.start;return gn}function et(gh,gg){if(gg){gh.bad=true}return gh}function az(gg,gj,gl){var gk;if(gj==gg.display.lineDiv){gk=gg.display.lineDiv.childNodes[gl];if(!gk){return et(gg.clipPos(W(gg.display.viewTo-1)),true)}gj=null;gl=0}else{for(gk=gj;;gk=gk.parentNode){if(!gk||gk==gg.display.lineDiv){return null}if(gk.parentNode&&gk.parentNode==gg.display.lineDiv){break}}}for(var gi=0;gi<gg.display.view.length;gi++){var gh=gg.display.view[gi];if(gh.node==gk){return aa(gh,gj,gl)}}}function aa(go,gk,gm){var gi=go.text.firstChild,gj=false;if(!gk||!f9(gi,gk)){return et(W(bN(go.line),0),true)}if(gk==gi){gj=true;gk=gi.childNodes[gm];gm=0;if(!gk){var gu=go.rest?fG(go.rest):go.line;return et(W(bN(gu),gu.text.length),gj)}}var gl=gk.nodeType==3?gk:null,gs=gk;if(!gl&&gk.childNodes.length==1&&gk.firstChild.nodeType==3){gl=gk.firstChild;if(gm){gm=gl.nodeValue.length}}while(gs.parentNode!=gi){gs=gs.parentNode}var gh=go.measure,gq=gh.maps;function gn(gx,gC,gz){for(var gB=-1;gB<(gq?gq.length:0);gB++){var gw=gB<0?gh.map:gq[gB];for(var gA=0;gA<gw.length;gA+=3){var gy=gw[gA+2];if(gy==gx||gy==gC){var gD=bN(gB<0?go.line:go.rest[gB]);var gv=gw[gA]+gz;if(gz<0||gy!=gx){gv=gw[gA+(gz?1:0)]}return W(gD,gv)}}}}var gt=gn(gl,gs,gm);if(gt){return et(gt,gj)}for(var gg=gs.nextSibling,gp=gl?gl.nodeValue.length-gm:0;gg;gg=gg.nextSibling){gt=gn(gg,gg.firstChild,0);if(gt){return et(W(gt.line,gt.ch-gp),gj)}else{gp+=gg.textContent.length}}for(var gr=gs.previousSibling,gp=gm;gr;gr=gr.previousSibling){gt=gn(gr,gr.firstChild,-1);if(gt){return et(W(gt.line,gt.ch+gp),gj)}else{gp+=gg.textContent.length}}}function fY(gn,gl,gm,gi,gg){var go="",gh=false;function gj(gp){return function(gq){return gq.id==gp}}function gk(gt){if(gt.nodeType==1){var gq=gt.getAttribute("cm-text");if(gq!=null){if(gq==""){gq=gt.textContent.replace(/\u200b/g,"")}go+=gq;return}var gs=gt.getAttribute("cm-marker"),gp;if(gs){var gu=gn.findMarks(W(gi,0),W(gg+1,0),gj(+gs));if(gu.length&&(gp=gu[0].find())){go+=f3(gn.doc,gp.from,gp.to).join("\n")}return}if(gt.getAttribute("contenteditable")=="false"){return}for(var gr=0;gr<gt.childNodes.length;gr++){gk(gt.childNodes[gr])}if(/^(pre|div|p)$/i.test(gt.nodeName)){gh=true}}else{if(gt.nodeType==3){var gv=gt.nodeValue;if(!gv){return}if(gh){go+="\n";gh=false}go+=gv}}}for(;;){gk(gl);if(gl==gm){break}gl=gl.nextSibling}return go}H.inputStyles={textarea:Y,contenteditable:dv};function f2(gg,gh){this.ranges=gg;this.primIndex=gh}f2.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(gg){if(gg==this){return true}if(gg.primIndex!=this.primIndex||gg.ranges.length!=this.ranges.length){return false}for(var gi=0;gi<this.ranges.length;gi++){var gh=this.ranges[gi],gj=gg.ranges[gi];if(cf(gh.anchor,gj.anchor)!=0||cf(gh.head,gj.head)!=0){return false}}return true},deepCopy:function(){for(var gg=[],gh=0;gh<this.ranges.length;gh++){gg[gh]=new dY(ci(this.ranges[gh].anchor),ci(this.ranges[gh].head))}return new f2(gg,this.primIndex)},somethingSelected:function(){for(var gg=0;gg<this.ranges.length;gg++){if(!this.ranges[gg].empty()){return true}}return false},contains:function(gj,gg){if(!gg){gg=gj}for(var gi=0;gi<this.ranges.length;gi++){var gh=this.ranges[gi];if(cf(gg,gh.from())>=0&&cf(gj,gh.to())<=0){return gi}}return -1}};function dY(gg,gh){this.anchor=gg;this.head=gh}dY.prototype={from:function(){return ar(this.anchor,this.head)},to:function(){return bx(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};function cw(gg,gn){var gi=gg[gn];gg.sort(function(gq,gp){return cf(gq.from(),gp.from())});gn=dh(gg,gi);for(var gk=1;gk<gg.length;gk++){var go=gg[gk],gh=gg[gk-1];if(cf(gh.to(),go.from())>=0){var gl=ar(gh.from(),go.from()),gm=bx(gh.to(),go.to());var gj=gh.empty()?go.from()==go.head:gh.from()==gh.head;if(gk<=gn){--gn}gg.splice(--gk,2,new dY(gj?gm:gl,gj?gl:gm))}}return new f2(gg,gn)}function eS(gg,gh){return new f2([new dY(gg,gh||gg)],0)}function c5(gg,gh){return Math.max(gg.first,Math.min(gh,gg.first+gg.size-1))}function fJ(gh,gi){if(gi.line<gh.first){return W(gh.first,0)}var gg=gh.first+gh.size-1;if(gi.line>gg){return W(gg,ff(gh,gg).text.length)}return fs(gi,ff(gh,gi.line).text.length)}function fs(gi,gh){var gg=gi.ch;if(gg==null||gg>gh){return W(gi.line,gh)}else{if(gg<0){return W(gi.line,0)}else{return gi}}}function b9(gh,gg){return gg>=gh.first&&gg<gh.first+gh.size}function d0(gi,gj){for(var gg=[],gh=0;gh<gj.length;gh++){gg[gh]=fJ(gi,gj[gh])}return gg}function fv(gl,gh,gk,gg){if(gl.cm&&gl.cm.display.shift||gl.extend){var gj=gh.anchor;if(gg){var gi=cf(gk,gj)<0;if(gi!=(cf(gg,gj)<0)){gj=gk;gk=gg}else{if(gi!=(cf(gk,gg)<0)){gk=gg}}}return new dY(gj,gk)}else{return new dY(gg||gk,gk)}}function fV(gj,gi,gg,gh){bU(gj,new f2([fv(gj,gj.sel.primary(),gi,gg)],0),gh)}function aw(gl,gk,gi){for(var gh=[],gj=0;gj<gl.sel.ranges.length;gj++){gh[gj]=fv(gl,gl.sel.ranges[gj],gk[gj],null)}var gg=cw(gh,gl.sel.primIndex);bU(gl,gg,gi)}function e(gk,gj,gh,gi){var gg=gk.sel.ranges.slice(0);gg[gj]=gh;bU(gk,cw(gg,gk.sel.primIndex),gi)}function F(gj,gh,gi,gg){bU(gj,eS(gh,gi),gg)}function c(gi,gg){var gh={ranges:gg.ranges,update:function(gj){this.ranges=[];for(var gk=0;gk<gj.length;gk++){this.ranges[gk]=new dY(fJ(gi,gj[gk].anchor),fJ(gi,gj[gk].head))}}};aE(gi,"beforeSelectionChange",gi,gh);if(gi.cm){aE(gi.cm,"beforeSelectionChange",gi.cm,gh)}if(gh.ranges!=gg.ranges){return cw(gh.ranges,gh.ranges.length-1)}else{return gg}}function e7(gk,gj,gh){var gg=gk.history.done,gi=fG(gg);if(gi&&gi.ranges){gg[gg.length-1]=gj;ep(gk,gj,gh)}else{bU(gk,gj,gh)}}function bU(gi,gh,gg){ep(gi,gh,gg);ga(gi,gi.sel,gi.cm?gi.cm.curOp.id:NaN,gg)}function ep(gj,gi,gh){if(fi(gj,"beforeSelectionChange")||gj.cm&&fi(gj.cm,"beforeSelectionChange")){gi=c(gj,gi)}var gg=gh&&gh.bias||(cf(gi.primary().head,gj.sel.primary().head)<0?-1:1);c9(gj,n(gj,gi,gg,true));if(!(gh&&gh.scroll===false)&&gj.cm){fF(gj.cm)}}function c9(gh,gg){if(gg.equals(gh.sel)){return}gh.sel=gg;if(gh.cm){gh.cm.curOp.updateInput=gh.cm.curOp.selectionChanged=true;V(gh.cm)}ae(gh,"cursorActivity",gh)}function ey(gg){c9(gg,n(gg,gg.sel,null,false),Z)}function n(go,gg,gl,gm){var gi;for(var gj=0;gj<gg.ranges.length;gj++){var gk=gg.ranges[gj];var gn=bV(go,gk.anchor,gl,gm);var gh=bV(go,gk.head,gl,gm);if(gi||gn!=gk.anchor||gh!=gk.head){if(!gi){gi=gg.ranges.slice(0,gj)}gi[gj]=new dY(gn,gh)}}return gi?cw(gi,gg.primIndex):gg}function bV(gp,go,gl,gm){var gq=false,gi=go;var gj=gl||1;gp.cantEdit=false;search:for(;;){var gr=ff(gp,gi.line);if(gr.markedSpans){for(var gk=0;gk<gr.markedSpans.length;++gk){var gg=gr.markedSpans[gk],gh=gg.marker;if((gg.from==null||(gh.inclusiveLeft?gg.from<=gi.ch:gg.from<gi.ch))&&(gg.to==null||(gh.inclusiveRight?gg.to>=gi.ch:gg.to>gi.ch))){if(gm){aE(gh,"beforeCursorEnter");if(gh.explicitlyCleared){if(!gr.markedSpans){break}else{--gk;continue}}}if(!gh.atomic){continue}var gn=gh.find(gj<0?-1:1);if(cf(gn,gi)==0){gn.ch+=gj;if(gn.ch<0){if(gn.line>gp.first){gn=fJ(gp,W(gn.line-1))}else{gn=null}}else{if(gn.ch>gr.text.length){if(gn.line<gp.first+gp.size-1){gn=W(gn.line+1,0)}else{gn=null}}}if(!gn){if(gq){if(!gm){return bV(gp,go,gl,true)}gp.cantEdit=true;return W(gp.first,0)}gq=true;gn=go;gj=-gj}}gi=gn;continue search}}}return gi}}function bC(gg){gg.display.input.showSelection(gg.display.input.prepareSelection())}function fI(gn,gg){var gm=gn.doc,go={};var gl=go.cursors=document.createDocumentFragment();var gh=go.selection=document.createDocumentFragment();for(var gj=0;gj<gm.sel.ranges.length;gj++){if(gg===false&&gj==gm.sel.primIndex){continue}var gk=gm.sel.ranges[gj];var gi=gk.empty();if(gi||gn.options.showCursorWhenSelecting){A(gn,gk,gl)}if(!gi){bD(gn,gk,gh)}}return go}function A(gg,gj,gi){var gl=dU(gg,gj.head,"div",null,null,!gg.options.singleCursorHeightPerLine);var gk=gi.appendChild(f1("div","\u00a0","CodeMirror-cursor"));gk.style.left=gl.left+"px";gk.style.top=gl.top+"px";gk.style.height=Math.max(0,gl.bottom-gl.top)*gg.options.cursorHeight+"px";if(gl.other){var gh=gi.appendChild(f1("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor"));gh.style.display="";gh.style.left=gl.other.left+"px";gh.style.top=gl.other.top+"px";gh.style.height=(gl.other.bottom-gl.other.top)*0.85+"px"}}function bD(gk,gq,gl){var gt=gk.display,gx=gk.doc;var gg=document.createDocumentFragment();var gp=e5(gk.display),gj=gp.left;var gu=Math.max(gt.sizerWidth,dl(gk)-gt.sizer.offsetLeft)-gp.right;function gr(gB,gA,gz,gy){if(gA<0){gA=0}gA=Math.round(gA);gy=Math.round(gy);gg.appendChild(f1("div",null,"CodeMirror-selected","position: absolute; left: "+gB+"px; top: "+gA+"px; width: "+(gz==null?gu-gB:gz)+"px; height: "+(gy-gA)+"px"))}function gh(gz,gB,gE){var gA=ff(gx,gz);var gC=gA.text.length;var gF,gy;function gD(gH,gG){return cJ(gk,W(gz,gH),"div",gA,gG)}d4(a(gA),gB||0,gE==null?gC:gE,function(gN,gM,gG){var gJ=gD(gN,"left"),gK,gL,gI;if(gN==gM){gK=gJ;gL=gI=gJ.left}else{gK=gD(gM-1,"right");if(gG=="rtl"){var gH=gJ;gJ=gK;gK=gH}gL=gJ.left;gI=gK.right}if(gB==null&&gN==0){gL=gj}if(gK.top-gJ.top>3){gr(gL,gJ.top,null,gJ.bottom);gL=gj;if(gJ.bottom<gK.top){gr(gL,gJ.bottom,null,gK.top)}}if(gE==null&&gM==gC){gI=gu}if(!gF||gJ.top<gF.top||gJ.top==gF.top&&gJ.left<gF.left){gF=gJ}if(!gy||gK.bottom>gy.bottom||gK.bottom==gy.bottom&&gK.right>gy.right){gy=gK}if(gL<gj+1){gL=gj}gr(gL,gK.top,gI-gL,gK.bottom)});return{start:gF,end:gy}}var gw=gq.from(),gv=gq.to();if(gw.line==gv.line){gh(gw.line,gw.ch,gv.ch)}else{var gi=ff(gx,gw.line),gn=ff(gx,gv.line);var gm=y(gi)==y(gn);var go=gh(gw.line,gw.ch,gm?gi.text.length+1:null).end;var gs=gh(gv.line,gm?0:null,gv.ch).start;if(gm){if(go.top<gs.top-2){gr(go.right,go.top,null,go.bottom);gr(gj,gs.top,gs.left,gs.bottom)}else{gr(go.right,go.top,gs.left-go.right,go.bottom)}}if(go.bottom<gs.top){gr(gj,go.bottom,null,gs.top)}}gl.appendChild(gg)}function o(gg){if(!gg.state.focused){return}var gi=gg.display;clearInterval(gi.blinker);var gh=true;gi.cursorDiv.style.visibility="";if(gg.options.cursorBlinkRate>0){gi.blinker=setInterval(function(){gi.cursorDiv.style.visibility=(gh=!gh)?"":"hidden"},gg.options.cursorBlinkRate)}else{if(gg.options.cursorBlinkRate<0){gi.cursorDiv.style.visibility="hidden"}}}function ef(gg,gh){if(gg.doc.mode.startState&&gg.doc.frontier<gg.display.viewTo){gg.state.highlight.set(gh,cv(cP,gg))}}function cP(gg){var gk=gg.doc;if(gk.frontier<gk.first){gk.frontier=gk.first}if(gk.frontier>=gg.display.viewTo){return}var gi=+new Date+gg.options.workTime;var gj=b3(gk.mode,dC(gg,gk.frontier));var gh=[];gk.iter(gk.frontier,Math.min(gk.first+gk.size,gg.display.viewTo+500),function(gl){if(gk.frontier>=gg.display.viewFrom){var go=gl.styles;var gq=fz(gg,gl,gj,true);gl.styles=gq.styles;var gn=gl.styleClasses,gp=gq.classes;if(gp){gl.styleClasses=gp}else{if(gn){gl.styleClasses=null}}var gr=!go||go.length!=gl.styles.length||gn!=gp&&(!gn||!gp||gn.bgClass!=gp.bgClass||gn.textClass!=gp.textClass);for(var gm=0;!gr&&gm<go.length;++gm){gr=go[gm]!=gl.styles[gm]}if(gr){gh.push(gk.frontier)}gl.stateAfter=b3(gk.mode,gj)}else{dx(gg,gl.text,gj);gl.stateAfter=gk.frontier%5==0?b3(gk.mode,gj):null}++gk.frontier;if(+new Date>gi){ef(gg,gg.options.workDelay);return true}});if(gh.length){cM(gg,function(){for(var gl=0;gl<gh.length;gl++){R(gg,gh[gl],"text")}})}}function cy(gm,gg,gj){var gh,gk,gl=gm.doc;var gi=gj?-1:gg-(gm.doc.mode.innerMode?1000:100);for(var gp=gg;gp>gi;--gp){if(gp<=gl.first){return gl.first}var go=ff(gl,gp-1);if(go.stateAfter&&(!gj||gp<=gl.frontier)){return gp}var gn=bT(go.text,null,gm.options.tabSize);if(gk==null||gh>gn){gk=gp-1;gh=gn}}return gk}function dC(gg,gm,gh){var gk=gg.doc,gj=gg.display;if(!gk.mode.startState){return true}var gl=cy(gg,gm,gh),gi=gl>gk.first&&ff(gk,gl-1).stateAfter;if(!gi){gi=b0(gk.mode)}else{gi=b3(gk.mode,gi)}gk.iter(gl,gm,function(gn){dx(gg,gn.text,gi);var go=gl==gm-1||gl%5==0||gl>=gj.viewFrom&&gl<gj.viewTo;gn.stateAfter=go?b3(gk.mode,gi):null;++gl});if(gh){gk.frontier=gl}return gi}function e8(gg){return gg.lineSpace.offsetTop}function bI(gg){return gg.mover.offsetHeight-gg.lineSpace.offsetHeight}function e5(gj){if(gj.cachedPaddingH){return gj.cachedPaddingH}var gi=bR(gj.measure,f1("pre","x"));var gg=window.getComputedStyle?window.getComputedStyle(gi):gi.currentStyle;var gh={left:parseInt(gg.paddingLeft),right:parseInt(gg.paddingRight)};if(!isNaN(gh.left)&&!isNaN(gh.right)){gj.cachedPaddingH=gh}return gh}function cT(gg){return dJ-gg.display.nativeBarWidth}function dl(gg){return gg.display.scroller.clientWidth-cT(gg)-gg.display.barWidth}function cV(gg){return gg.display.scroller.clientHeight-cT(gg)-gg.display.barHeight}function ch(gn,gj,gm){var gi=gn.options.lineWrapping;var gk=gi&&dl(gn);if(!gj.measure.heights||gi&&gj.measure.width!=gk){var gl=gj.measure.heights=[];if(gi){gj.measure.width=gk;var gp=gj.text.firstChild.getClientRects();for(var gg=0;gg<gp.length-1;gg++){var go=gp[gg],gh=gp[gg+1];if(Math.abs(go.bottom-gh.bottom)>2){gl.push((go.bottom+gh.top)/2-gm.top)}}}gl.push(gm.bottom-gm.top)}}function ct(gi,gg,gj){if(gi.line==gg){return{map:gi.measure.map,cache:gi.measure.cache}}for(var gh=0;gh<gi.rest.length;gh++){if(gi.rest[gh]==gg){return{map:gi.measure.maps[gh],cache:gi.measure.caches[gh]}}}for(var gh=0;gh<gi.rest.length;gh++){if(bN(gi.rest[gh])>gj){return{map:gi.measure.maps[gh],cache:gi.measure.caches[gh],before:true}}}}function c1(gg,gi){gi=y(gi);var gk=bN(gi);var gh=gg.display.externalMeasured=new bv(gg.doc,gi,gk);gh.lineN=gk;var gj=gh.built=eR(gg,gh);gh.text=gj.pre;bR(gg.display.lineMeasure,gj.pre);return gh}function eh(gg,gh,gj,gi){return C(gg,a5(gg,gh),gj,gi)}function fb(gg,gi){if(gi>=gg.display.viewFrom&&gi<gg.display.viewTo){return gg.display.view[dr(gg,gi)]}var gh=gg.display.externalMeasured;if(gh&&gi>=gh.lineN&&gi<gh.lineN+gh.size){return gh}}function a5(gg,gi){var gj=bN(gi);var gh=fb(gg,gj);if(gh&&!gh.text){gh=null}else{if(gh&&gh.changes){ab(gg,gh,gj,fd(gg))}}if(!gh){gh=c1(gg,gi)}var gk=ct(gh,gi,gj);return{line:gi,view:gh,rect:null,map:gk.map,cache:gk.cache,before:gk.before,hasHeights:false}}function C(gg,gm,gk,gh,gj){if(gm.before){gk=-1}var gi=gk+(gh||""),gl;if(gm.cache.hasOwnProperty(gi)){gl=gm.cache[gi]}else{if(!gm.rect){gm.rect=gm.view.text.getBoundingClientRect()}if(!gm.hasHeights){ch(gg,gm.view,gm.rect);gm.hasHeights=true}gl=j(gg,gm,gk,gh);if(!gl.bogus){gm.cache[gi]=gl}}return{left:gl.left,right:gl.right,top:gj?gl.rtop:gl.top,bottom:gj?gl.rbottom:gl.bottom}}var eB={left:0,right:0,top:0,bottom:0};function aL(gh,gg,gn){var gj,gi,gl,go;for(var gm=0;gm<gh.length;gm+=3){var gk=gh[gm],gp=gh[gm+1];if(gg<gk){gi=0;gl=1;go="left"}else{if(gg<gp){gi=gg-gk;gl=gi+1}else{if(gm==gh.length-3||gg==gp&&gh[gm+3]>gg){gl=gp-gk;gi=gl-1;if(gg>=gp){go="right"}}}}if(gi!=null){gj=gh[gm+2];if(gk==gp&&gn==(gj.insertLeft?"left":"right")){go=gn}if(gn=="left"&&gi==0){while(gm&&gh[gm-2]==gh[gm-3]&&gh[gm-1].insertLeft){gj=gh[(gm-=3)+2];go="left"}}if(gn=="right"&&gi==gp-gk){while(gm<gh.length-3&&gh[gm+3]==gh[gm+4]&&!gh[gm+5].insertLeft){gj=gh[(gm+=3)+2];go="right"}}break}}return{node:gj,start:gi,end:gl,collapse:go,coverStart:gk,coverEnd:gp}}function j(gn,gx,gq,gl){var go=aL(gx.map,gq,gl);var gv=go.node,gk=go.start,gj=go.end,gg=go.collapse;var gh;if(gv.nodeType==3){for(var gw=0;gw<4;gw++){while(gk&&fp(gx.line.text.charAt(go.coverStart+gk))){--gk}while(go.coverStart+gj<go.coverEnd&&fp(gx.line.text.charAt(go.coverStart+gj))){++gj}if(dK&&k<9&&gk==0&&gj==go.coverEnd-go.coverStart){gh=gv.parentNode.getBoundingClientRect()}else{if(dK&&gn.options.lineWrapping){var gi=cl(gv,gk,gj).getClientRects();if(gi.length){gh=gi[gl=="right"?gi.length-1:0]}else{gh=eB}}else{gh=cl(gv,gk,gj).getBoundingClientRect()||eB}}if(gh.left||gh.right||gk==0){break}gj=gk;gk=gk-1;gg="right"}if(dK&&k<11){gh=eN(gn.display.measure,gh)}}else{if(gk>0){gg=gl="right"}var gi;if(gn.options.lineWrapping&&(gi=gv.getClientRects()).length>1){gh=gi[gl=="right"?gi.length-1:0]}else{gh=gv.getBoundingClientRect()}}if(dK&&k<9&&!gk&&(!gh||!gh.left&&!gh.right)){var gm=gv.parentNode.getClientRects()[0];if(gm){gh={left:gm.left,right:gm.left+dD(gn.display),top:gm.top,bottom:gm.bottom}}else{gh=eB}}var gt=gh.top-gx.rect.top,gr=gh.bottom-gx.rect.top;var gz=(gt+gr)/2;var gy=gx.view.measure.heights;for(var gw=0;gw<gy.length-1;gw++){if(gz<gy[gw]){break}}var gu=gw?gy[gw-1]:0,gs=gy[gw];var gp={left:(gg=="right"?gh.right:gh.left)-gx.rect.left,right:(gg=="left"?gh.left:gh.right)-gx.rect.left,top:gu,bottom:gs};if(!gh.left&&!gh.right){gp.bogus=true}if(!gn.options.singleCursorHeightPerLine){gp.rtop=gt;gp.rbottom=gr}return gp}function eN(gi,gj){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!aK(gi)){return gj}var gh=screen.logicalXDPI/screen.deviceXDPI;var gg=screen.logicalYDPI/screen.deviceYDPI;return{left:gj.left*gh,right:gj.right*gh,top:gj.top*gg,bottom:gj.bottom*gg}}function au(gh){if(gh.measure){gh.measure.cache={};gh.measure.heights=null;if(gh.rest){for(var gg=0;gg<gh.rest.length;gg++){gh.measure.caches[gg]={}}}}}function aO(gg){gg.display.externalMeasure=null;d1(gg.display.lineMeasure);for(var gh=0;gh<gg.display.view.length;gh++){au(gg.display.view[gh])}}function ak(gg){aO(gg);gg.display.cachedCharWidth=gg.display.cachedTextHeight=gg.display.cachedPaddingH=null;if(!gg.options.lineWrapping){gg.display.maxLineChanged=true}gg.display.lineNumChars=null}function cu(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function cs(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function eQ(gm,gj,gl,gh){if(gj.widgets){for(var gi=0;gi<gj.widgets.length;++gi){if(gj.widgets[gi].above){var go=cY(gj.widgets[gi]);gl.top+=go;gl.bottom+=go}}}if(gh=="line"){return gl}if(!gh){gh="local"}var gk=bM(gj);if(gh=="local"){gk+=e8(gm.display)}else{gk-=gm.display.viewOffset}if(gh=="page"||gh=="window"){var gg=gm.display.lineSpace.getBoundingClientRect();gk+=gg.top+(gh=="window"?0:cs());var gn=gg.left+(gh=="window"?0:cu());gl.left+=gn;gl.right+=gn}gl.top+=gk;gl.bottom+=gk;return gl}function gd(gh,gk,gi){if(gi=="div"){return gk}var gm=gk.left,gl=gk.top;if(gi=="page"){gm-=cu();gl-=cs()}else{if(gi=="local"||!gi){var gj=gh.display.sizer.getBoundingClientRect();gm+=gj.left;gl+=gj.top}}var gg=gh.display.lineSpace.getBoundingClientRect();return{left:gm-gg.left,top:gl-gg.top}}function cJ(gg,gk,gj,gi,gh){if(!gi){gi=ff(gg.doc,gk.line)}return eQ(gg,gi,eh(gg,gi,gk.ch,gh),gj)}function dU(gp,go,gi,gm,gr,gn){gm=gm||ff(gp.doc,go.line);if(!gr){gr=a5(gp,gm)}function gk(gu,gt){var gs=C(gp,gr,gu,gt?"right":"left",gn);if(gt){gs.left=gs.right}else{gs.right=gs.left}return eQ(gp,gm,gs,gi)}function gq(gv,gs){var gt=gl[gs],gu=gt.level%2;if(gv==dy(gt)&&gs&&gt.level<gl[gs-1].level){gt=gl[--gs];gv=gc(gt)-(gt.level%2?0:1);gu=true}else{if(gv==gc(gt)&&gs<gl.length-1&&gt.level<gl[gs+1].level){gt=gl[++gs];gv=dy(gt)-gt.level%2;gu=false}}if(gu&&gv==gt.to&&gv>gt.from){return gk(gv-1)}return gk(gv,gu)}var gl=a(gm),gg=go.ch;if(!gl){return gk(gg)}var gh=aG(gl,gg);var gj=gq(gg,gh);if(e2!=null){gj.other=gq(gg,e2)}return gj}function dH(gg,gk){var gj=0,gk=fJ(gg.doc,gk);if(!gg.options.lineWrapping){gj=dD(gg.display)*gk.ch}var gh=ff(gg.doc,gk.line);var gi=bM(gh)+e8(gg.display);return{left:gj,right:gj,top:gi,bottom:gi+gh.height}}function f0(gg,gh,gi,gk){var gj=W(gg,gh);gj.xRel=gk;if(gi){gj.outside=true}return gj}function fO(gn,gk,gj){var gm=gn.doc;gj+=gn.display.viewOffset;if(gj<0){return f0(gm.first,0,true,-1)}var gi=bG(gm,gj),go=gm.first+gm.size-1;if(gi>go){return f0(gm.first+gm.size-1,ff(gm,go).text.length,true,1)}if(gk<0){gk=0}var gh=ff(gm,gi);for(;;){var gp=cZ(gn,gh,gi,gk,gj);var gl=ew(gh);var gg=gl&&gl.find(0,true);if(gl&&(gp.ch>gg.from.ch||gp.ch==gg.from.ch&&gp.xRel>0)){gi=bN(gh=gg.to.line)}else{return gp}}}function cZ(gq,gi,gt,gs,gr){var gp=gr-bM(gi);var gm=false,gz=2*gq.display.wrapper.clientWidth;var gw=a5(gq,gi);function gD(gF){var gG=dU(gq,W(gt,gF),"line",gi,gw);gm=true;if(gp>gG.bottom){return gG.left-gz}else{if(gp<gG.top){return gG.left+gz}else{gm=false}}return gG.left}var gv=a(gi),gy=gi.text.length;var gA=cE(gi),gj=cS(gi);var gx=gD(gA),gg=gm,gh=gD(gj),gl=gm;if(gs>gh){return f0(gt,gj,gl,1)}for(;;){if(gv?gj==gA||gj==u(gi,gA,1):gj-gA<=1){var gu=gs<gx||gs-gx<=gh-gs?gA:gj;var gC=gs-(gu==gA?gx:gh);while(fp(gi.text.charAt(gu))){++gu}var go=f0(gt,gu,gu==gA?gg:gl,gC<-1?-1:gC>1?1:0);return go}var gn=Math.ceil(gy/2),gE=gA+gn;if(gv){gE=gA;for(var gB=0;gB<gn;++gB){gE=u(gi,gE,1)}}var gk=gD(gE);if(gk>gs){gj=gE;gh=gk;if(gl=gm){gh+=1000}gy=gn}else{gA=gE;gx=gk;gg=gm;gy-=gn}}}var aH;function aY(gi){if(gi.cachedTextHeight!=null){return gi.cachedTextHeight}if(aH==null){aH=f1("pre");for(var gh=0;gh<49;++gh){aH.appendChild(document.createTextNode("x"));aH.appendChild(f1("br"))}aH.appendChild(document.createTextNode("x"))}bR(gi.measure,aH);var gg=aH.offsetHeight/50;if(gg>3){gi.cachedTextHeight=gg}d1(gi.measure);return gg||1}function dD(gk){if(gk.cachedCharWidth!=null){return gk.cachedCharWidth}var gg=f1("span","xxxxxxxxxx");var gj=f1("pre",[gg]);bR(gk.measure,gj);var gi=gg.getBoundingClientRect(),gh=(gi.right-gi.left)/10;if(gh>2){gk.cachedCharWidth=gh}return gh||10}var bp=null;var d8=0;function cI(gg){gg.curOp={cm:gg,viewChanged:false,startHeight:gg.doc.height,forceUpdate:false,updateInput:null,typing:false,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:false,id:++d8};if(bp){bp.ops.push(gg.curOp)}else{gg.curOp.ownsGroup=bp={ops:[gg.curOp],delayedCallbacks:[]}}}function cU(gj){var gi=gj.delayedCallbacks,gh=0;do{for(;gh<gi.length;gh++){gi[gh]()}for(var gg=0;gg<gj.ops.length;gg++){var gk=gj.ops[gg];if(gk.cursorActivityHandlers){while(gk.cursorActivityCalled<gk.cursorActivityHandlers.length){gk.cursorActivityHandlers[gk.cursorActivityCalled++](gk.cm)}}}}while(gh<gi.length)}function am(gg){var gj=gg.curOp,gi=gj.ownsGroup;if(!gi){return}try{cU(gi)}finally{bp=null;for(var gh=0;gh<gi.ops.length;gh++){gi.ops[gh].cm.curOp=null}cK(gi)}}function cK(gi){var gh=gi.ops;for(var gg=0;gg<gh.length;gg++){b5(gh[gg])}for(var gg=0;gg<gh.length;gg++){aq(gh[gg])}for(var gg=0;gg<gh.length;gg++){b2(gh[gg])}for(var gg=0;gg<gh.length;gg++){ap(gh[gg])}for(var gg=0;gg<gh.length;gg++){e0(gh[gg])}}function b5(gi){var gg=gi.cm,gh=gg.display;J(gg);if(gi.updateMaxLine){g(gg)}gi.mustUpdate=gi.viewChanged||gi.forceUpdate||gi.scrollTop!=null||gi.scrollToPos&&(gi.scrollToPos.from.line<gh.viewFrom||gi.scrollToPos.to.line>=gh.viewTo)||gh.maxLineChanged&&gg.options.lineWrapping;gi.update=gi.mustUpdate&&new aI(gg,gi.mustUpdate&&{top:gi.scrollTop,ensure:gi.scrollToPos},gi.forceUpdate)}function aq(gg){gg.updatedDisplay=gg.mustUpdate&&B(gg.cm,gg.update)}function b2(gi){var gg=gi.cm,gh=gg.display;if(gi.updatedDisplay){ba(gg)}gi.barMeasure=dA(gg);if(gh.maxLineChanged&&!gg.options.lineWrapping){gi.adjustWidthTo=eh(gg,gh.maxLine,gh.maxLine.text.length).left+3;gg.display.sizerWidth=gi.adjustWidthTo;gi.barMeasure.scrollWidth=Math.max(gh.scroller.clientWidth,gh.sizer.offsetLeft+gi.adjustWidthTo+cT(gg)+gg.display.barWidth);gi.maxScrollLeft=Math.max(0,gh.sizer.offsetLeft+gi.adjustWidthTo-dl(gg))}if(gi.updatedDisplay||gi.selectionChanged){gi.preparedSelection=gh.input.prepareSelection()}}function ap(gh){var gg=gh.cm;if(gh.adjustWidthTo!=null){gg.display.sizer.style.minWidth=gh.adjustWidthTo+"px";if(gh.maxScrollLeft<gg.doc.scrollLeft){bE(gg,Math.min(gg.display.scroller.scrollLeft,gh.maxScrollLeft),true)}gg.display.maxLineChanged=false}if(gh.preparedSelection){gg.display.input.showSelection(gh.preparedSelection)}if(gh.updatedDisplay){dz(gg,gh.barMeasure)}if(gh.updatedDisplay||gh.startHeight!=gg.doc.height){eY(gg,gh.barMeasure)}if(gh.selectionChanged){o(gg)}if(gg.state.focused&&gh.updateInput){gg.display.input.reset(gh.typing)}if(gh.focus&&gh.focus==dO()){r(gh.cm)}}function e0(gn){var gg=gn.cm,gl=gg.display,gk=gg.doc;if(gn.updatedDisplay){cj(gg,gn.update)}if(gl.wheelStartX!=null&&(gn.scrollTop!=null||gn.scrollLeft!=null||gn.scrollToPos)){gl.wheelStartX=gl.wheelStartY=null}if(gn.scrollTop!=null&&(gl.scroller.scrollTop!=gn.scrollTop||gn.forceScroll)){gk.scrollTop=Math.max(0,Math.min(gl.scroller.scrollHeight-gl.scroller.clientHeight,gn.scrollTop));gl.scrollbars.setScrollTop(gk.scrollTop);gl.scroller.scrollTop=gk.scrollTop}if(gn.scrollLeft!=null&&(gl.scroller.scrollLeft!=gn.scrollLeft||gn.forceScroll)){gk.scrollLeft=Math.max(0,Math.min(gl.scroller.scrollWidth-dl(gg),gn.scrollLeft));gl.scrollbars.setScrollLeft(gk.scrollLeft);gl.scroller.scrollLeft=gk.scrollLeft;eE(gg)}if(gn.scrollToPos){var gj=D(gg,fJ(gk,gn.scrollToPos.from),fJ(gk,gn.scrollToPos.to),gn.scrollToPos.margin);if(gn.scrollToPos.isCursor&&gg.state.focused){d6(gg,gj)}}var gi=gn.maybeHiddenMarkers,gm=gn.maybeUnhiddenMarkers;if(gi){for(var gh=0;gh<gi.length;++gh){if(!gi[gh].lines.length){aE(gi[gh],"hide")}}}if(gm){for(var gh=0;gh<gm.length;++gh){if(gm[gh].lines.length){aE(gm[gh],"unhide")}}}if(gl.wrapper.offsetHeight){gk.scrollTop=gg.display.scroller.scrollTop}if(gn.changeObjs){aE(gg,"changes",gg,gn.changeObjs)}if(gn.update){gn.update.finish()}}function cM(gg,gh){if(gg.curOp){return gh()}cI(gg);try{return gh()}finally{am(gg)}}function c2(gg,gh){return function(){if(gg.curOp){return gh.apply(gg,arguments)}cI(gg);try{return gh.apply(gg,arguments)}finally{am(gg)}}}function c8(gg){return function(){if(this.curOp){return gg.apply(this,arguments)}cI(this);try{return gg.apply(this,arguments)}finally{am(this)}}}function cD(gg){return function(){var gh=this.cm;if(!gh||gh.curOp){return gg.apply(this,arguments)}cI(gh);try{return gg.apply(this,arguments)}finally{am(gh)}}}function bv(gi,gg,gh){this.line=gg;this.rest=h(gg);this.size=this.rest?bN(fG(this.rest))-gh+1:1;this.node=this.text=null;this.hidden=fw(gi,gg)}function eV(gg,gm,gl){var gk=[],gi;for(var gj=gm;gj<gl;gj=gi){var gh=new bv(gg.doc,ff(gg.doc,gj),gj);gi=gj+gh.size;gk.push(gh)}return gk}function ah(gn,gl,gm,go){if(gl==null){gl=gn.doc.first}if(gm==null){gm=gn.doc.first+gn.doc.size}if(!go){go=0}var gi=gn.display;if(go&&gm<gi.viewTo&&(gi.updateLineNumbers==null||gi.updateLineNumbers>gl)){gi.updateLineNumbers=gl}gn.curOp.viewChanged=true;if(gl>=gi.viewTo){if(a8&&aW(gn.doc,gl)<gi.viewTo){ex(gn)}}else{if(gm<=gi.viewFrom){if(a8&&d2(gn.doc,gm+go)>gi.viewFrom){ex(gn)}else{gi.viewFrom+=go;gi.viewTo+=go}}else{if(gl<=gi.viewFrom&&gm>=gi.viewTo){ex(gn)}else{if(gl<=gi.viewFrom){var gk=de(gn,gm,gm+go,1);if(gk){gi.view=gi.view.slice(gk.index);gi.viewFrom=gk.lineN;gi.viewTo+=go}else{ex(gn)}}else{if(gm>=gi.viewTo){var gk=de(gn,gl,gl,-1);if(gk){gi.view=gi.view.slice(0,gk.index);gi.viewTo=gk.lineN}else{ex(gn)}}else{var gj=de(gn,gl,gl,-1);var gh=de(gn,gm,gm+go,1);if(gj&&gh){gi.view=gi.view.slice(0,gj.index).concat(eV(gn,gj.lineN,gh.lineN)).concat(gi.view.slice(gh.index));gi.viewTo+=go}else{ex(gn)}}}}}}var gg=gi.externalMeasured;if(gg){if(gm<gg.lineN){gg.lineN+=go}else{if(gl<gg.lineN+gg.size){gi.externalMeasured=null}}}}function R(gh,gi,gl){gh.curOp.viewChanged=true;var gm=gh.display,gk=gh.display.externalMeasured;if(gk&&gi>=gk.lineN&&gi<gk.lineN+gk.size){gm.externalMeasured=null}if(gi<gm.viewFrom||gi>=gm.viewTo){return}var gj=gm.view[dr(gh,gi)];if(gj.node==null){return}var gg=gj.changes||(gj.changes=[]);if(dh(gg,gl)==-1){gg.push(gl)}}function ex(gg){gg.display.viewFrom=gg.display.viewTo=gg.doc.first;gg.display.view=[];gg.display.viewOffset=0}function dr(gg,gj){if(gj>=gg.display.viewTo){return null}gj-=gg.display.viewFrom;if(gj<0){return null}var gh=gg.display.view;for(var gi=0;gi<gh.length;gi++){gj-=gh[gi].size;if(gj<0){return gi}}}function de(go,gi,gk,gh){var gl=dr(go,gi),gn,gm=go.display.view;if(!a8||gk==go.doc.first+go.doc.size){return{index:gl,lineN:gk}}for(var gj=0,gg=go.display.viewFrom;gj<gl;gj++){gg+=gm[gj].size}if(gg!=gi){if(gh>0){if(gl==gm.length-1){return null}gn=(gg+gm[gl].size)-gi;gl++}else{gn=gg-gi}gi+=gn;gk+=gn}while(aW(go.doc,gk)!=gk){if(gl==(gh<0?0:gm.length-1)){return null}gk+=gh*gm[gl-(gh<0?1:0)].size;gl+=gh}return{index:gl,lineN:gk}}function cR(gg,gk,gj){var gi=gg.display,gh=gi.view;if(gh.length==0||gk>=gi.viewTo||gj<=gi.viewFrom){gi.view=eV(gg,gk,gj);gi.viewFrom=gk}else{if(gi.viewFrom>gk){gi.view=eV(gg,gk,gi.viewFrom).concat(gi.view)}else{if(gi.viewFrom<gk){gi.view=gi.view.slice(dr(gg,gk))}}gi.viewFrom=gk;if(gi.viewTo<gj){gi.view=gi.view.concat(eV(gg,gi.viewTo,gj))}else{if(gi.viewTo>gj){gi.view=gi.view.slice(0,dr(gg,gj))}}}gi.viewTo=gj}function db(gg){var gh=gg.display.view,gk=0;for(var gj=0;gj<gh.length;gj++){var gi=gh[gj];if(!gi.hidden&&(!gi.node||gi.changes)){++gk}}return gk}function fQ(gh){var gl=gh.display;bX(gl.scroller,"mousedown",c2(gh,eu));if(dK&&k<11){bX(gl.scroller,"dblclick",c2(gh,function(gp){if(aR(gh,gp)){return}var gq=cn(gh,gp);if(!gq||l(gh,gp)||bb(gh.display,gp)){return}cG(gp);var go=gh.findWordAt(gq);fV(gh.doc,go.anchor,go.head)}))}else{bX(gl.scroller,"dblclick",function(go){aR(gh,go)||cG(go)})}if(!f8){bX(gl.scroller,"contextmenu",function(go){ay(gh,go)})}var gn,gg={end:0};function gm(){if(gl.activeTouch){gn=setTimeout(function(){gl.activeTouch=null},1000);gg=gl.activeTouch;gg.end=+new Date}}function gj(go){if(go.touches.length!=1){return false}var gp=go.touches[0];return gp.radiusX<=1&&gp.radiusY<=1}function gi(gr,go){if(go.left==null){return true}var gq=go.left-gr.left,gp=go.top-gr.top;return gq*gq+gp*gp>20*20}bX(gl.scroller,"touchstart",function(gp){if(!gj(gp)){clearTimeout(gn);var go=+new Date;gl.activeTouch={start:go,moved:false,prev:go-gg.end<=300?gg:null};if(gp.touches.length==1){gl.activeTouch.left=gp.touches[0].pageX;gl.activeTouch.top=gp.touches[0].pageY}}});bX(gl.scroller,"touchmove",function(){if(gl.activeTouch){gl.activeTouch.moved=true}});bX(gl.scroller,"touchend",function(gp){var gr=gl.activeTouch;if(gr&&!bb(gl,gp)&&gr.left!=null&&!gr.moved&&new Date-gr.start<300){var gq=gh.coordsChar(gl.activeTouch,"page"),go;if(!gr.prev||gi(gr,gr.prev)){go=new dY(gq,gq)}else{if(!gr.prev.prev||gi(gr,gr.prev.prev)){go=gh.findWordAt(gq)}else{go=new dY(W(gq.line,0),fJ(gh.doc,W(gq.line+1,0)))}}gh.setSelection(go.anchor,go.head);gh.focus();cG(gp)}gm()});bX(gl.scroller,"touchcancel",gm);bX(gl.scroller,"scroll",function(){if(gl.scroller.clientHeight){N(gh,gl.scroller.scrollTop);bE(gh,gl.scroller.scrollLeft,true);aE(gh,"scroll",gh)}});bX(gl.scroller,"mousewheel",function(go){b(gh,go)});bX(gl.scroller,"DOMMouseScroll",function(go){b(gh,go)});bX(gl.wrapper,"scroll",function(){gl.wrapper.scrollTop=gl.wrapper.scrollLeft=0});gl.dragFunctions={simple:function(go){if(!aR(gh,go)){er(go)}},start:function(go){Q(gh,go)},drop:c2(gh,bk)};var gk=gl.input.getField();bX(gk,"keyup",function(go){bi.call(gh,go)});bX(gk,"keydown",c2(gh,p));bX(gk,"keypress",c2(gh,cx));bX(gk,"focus",cv(cB,gh));bX(gk,"blur",cv(aV,gh))}function fZ(gh,gk,gi){var gl=gi&&gi!=H.Init;if(!gk!=!gl){var gj=gh.display.dragFunctions;var gg=gk?bX:ed;gg(gh.display.scroller,"dragstart",gj.start);gg(gh.display.scroller,"dragenter",gj.simple);gg(gh.display.scroller,"dragover",gj.simple);gg(gh.display.scroller,"drop",gj.drop)}}function aT(gg){var gh=gg.display;if(gh.lastWrapHeight==gh.wrapper.clientHeight&&gh.lastWrapWidth==gh.wrapper.clientWidth){return}gh.cachedCharWidth=gh.cachedTextHeight=gh.cachedPaddingH=null;gh.scrollbarsClipped=false;gg.setSize()}function bb(gh,gg){for(var gi=L(gg);gi!=gh.wrapper;gi=gi.parentNode){if(!gi||(gi.nodeType==1&&gi.getAttribute("cm-ignore-events")=="true")||(gi.parentNode==gh.sizer&&gi!=gh.mover)){return true}}}function cn(gp,gk,gh,gi){var gl=gp.display;if(!gh&&L(gk).getAttribute("cm-not-content")=="true"){return null}var go,gm,gg=gl.lineSpace.getBoundingClientRect();try{go=gk.clientX-gg.left;gm=gk.clientY-gg.top}catch(gk){return null}var gn=fO(gp,go,gm),gq;if(gi&&gn.xRel==1&&(gq=ff(gp.doc,gn.line).text).length==gn.ch){var gj=bT(gq,gq.length,gp.options.tabSize)-gq.length;gn=W(gn.line,Math.max(0,Math.round((go-e5(gp.display).left)/dD(gp.display))-gj))}return gn}function eu(gi){var gg=this,gh=gg.display;if(gh.activeTouch&&gh.input.supportsTouch()||aR(gg,gi)){return}gh.shift=gi.shiftKey;if(bb(gh,gi)){if(!c0){gh.scroller.draggable=false;setTimeout(function(){gh.scroller.draggable=true},100)}return}if(l(gg,gi)){return}var gj=cn(gg,gi);window.focus();switch(fN(gi)){case 1:if(gj){ax(gg,gi,gj)}else{if(L(gi)==gh.scroller){cG(gi)}}break;case 2:if(c0){gg.state.lastMiddleDown=+new Date}if(gj){fV(gg.doc,gj)}setTimeout(function(){gh.input.focus()},20);cG(gi);break;case 3:if(f8){ay(gg,gi)}else{al(gg)}break}}var dn,dd;function ax(gh,gm,gn){if(dK){setTimeout(cv(r,gh),0)}else{gh.curOp.focus=dO()}var gi=+new Date,gk;if(dd&&dd.time>gi-400&&cf(dd.pos,gn)==0){gk="triple"}else{if(dn&&dn.time>gi-400&&cf(dn.pos,gn)==0){gk="double";dd={time:gi,pos:gn}}else{gk="single";dn={time:gi,pos:gn}}}var gl=gh.doc.sel,gg=b7?gm.metaKey:gm.ctrlKey,gj;if(gh.options.dragDrop&&eL&&!aj(gh)&&gk=="single"&&(gj=gl.contains(gn))>-1&&!gl.ranges[gj].empty()){a4(gh,gm,gn,gg)}else{m(gh,gm,gn,gk,gg)}}function a4(gi,gl,gm,gh){var gk=gi.display,gj=+new Date;var gg=c2(gi,function(gn){if(c0){gk.scroller.draggable=false}gi.state.draggingText=false;ed(document,"mouseup",gg);ed(gk.scroller,"drop",gg);if(Math.abs(gl.clientX-gn.clientX)+Math.abs(gl.clientY-gn.clientY)<10){cG(gn);if(!gh&&+new Date-200<gj){fV(gi.doc,gm)}if(c0||dK&&k==9){setTimeout(function(){document.body.focus();gk.input.focus()},20)}else{gk.input.focus()}}});if(c0){gk.scroller.draggable=true}gi.state.draggingText=gg;if(gk.scroller.dragDrop){gk.scroller.dragDrop()}bX(document,"mouseup",gg);bX(gk.scroller,"drop",gg)}function m(gk,gy,gj,gh,gm){var gv=gk.display,gA=gk.doc;cG(gy);var gi,gz,gl=gA.sel,gg=gl.ranges;if(gm&&!gy.shiftKey){gz=gA.sel.contains(gj);if(gz>-1){gi=gg[gz]}else{gi=new dY(gj,gj)}}else{gi=gA.sel.primary();gz=gA.sel.primIndex}if(gy.altKey){gh="rect";if(!gm){gi=new dY(gj,gj)}gj=cn(gk,gy,true,true);gz=-1}else{if(gh=="double"){var gw=gk.findWordAt(gj);if(gk.display.shift||gA.extend){gi=fv(gA,gi,gw.anchor,gw.head)}else{gi=gw}}else{if(gh=="triple"){var gp=new dY(W(gj.line,0),fJ(gA,W(gj.line+1,0)));if(gk.display.shift||gA.extend){gi=fv(gA,gi,gp.anchor,gp.head)}else{gi=gp}}else{gi=fv(gA,gi,gj)}}}if(!gm){gz=0;bU(gA,new f2([gi],0),M);gl=gA.sel}else{if(gz==-1){gz=gg.length;bU(gA,cw(gg.concat([gi]),gz),{scroll:false,origin:"*mouse"})}else{if(gg.length>1&&gg[gz].empty()&&gh=="single"&&!gy.shiftKey){bU(gA,cw(gg.slice(0,gz).concat(gg.slice(gz+1)),0));gl=gA.sel}else{e(gA,gz,gi,M)}}}var gu=gj;function gt(gL){if(cf(gu,gL)==0){return}gu=gL;if(gh=="rect"){var gC=[],gI=gk.options.tabSize;var gB=bT(ff(gA,gj.line).text,gj.ch,gI);var gO=bT(ff(gA,gL.line).text,gL.ch,gI);var gD=Math.min(gB,gO),gM=Math.max(gB,gO);for(var gP=Math.min(gj.line,gL.line),gF=Math.min(gk.lastLine(),Math.max(gj.line,gL.line));gP<=gF;gP++){var gN=ff(gA,gP).text,gE=eq(gN,gD,gI);if(gD==gM){gC.push(new dY(W(gP,gE),W(gP,gE)))}else{if(gN.length>gE){gC.push(new dY(W(gP,gE),W(gP,eq(gN,gM,gI))))}}}if(!gC.length){gC.push(new dY(gj,gj))}bU(gA,cw(gl.ranges.slice(0,gz).concat(gC),gz),{origin:"*mouse",scroll:false});gk.scrollIntoView(gL)}else{var gJ=gi;var gG=gJ.anchor,gK=gL;if(gh!="single"){if(gh=="double"){var gH=gk.findWordAt(gL)}else{var gH=new dY(W(gL.line,0),fJ(gA,W(gL.line+1,0)))}if(cf(gH.anchor,gG)>0){gK=gH.head;gG=ar(gJ.from(),gH.anchor)}else{gK=gH.anchor;gG=bx(gJ.to(),gH.head)}}var gC=gl.ranges.slice(0);gC[gz]=new dY(fJ(gA,gG),gK);bU(gA,cw(gC,gz),M)}}var gr=gv.wrapper.getBoundingClientRect();var gn=0;function gx(gD){var gB=++gn;var gF=cn(gk,gD,true,gh=="rect");if(!gF){return}if(cf(gF,gu)!=0){gk.curOp.focus=dO();gt(gF);var gE=b6(gv,gA);if(gF.line>=gE.to||gF.line<gE.from){setTimeout(c2(gk,function(){if(gn==gB){gx(gD)}}),150)}}else{var gC=gD.clientY<gr.top?-20:gD.clientY>gr.bottom?20:0;if(gC){setTimeout(c2(gk,function(){if(gn!=gB){return}gv.scroller.scrollTop+=gC;gx(gD)}),50)}}}function gq(gB){gn=Infinity;cG(gB);gv.input.focus();ed(document,"mousemove",gs);ed(document,"mouseup",go);gA.history.lastSelOrigin=null}var gs=c2(gk,function(gB){if(!fN(gB)){gq(gB)}else{gx(gB)}});var go=c2(gk,gq);bX(document,"mousemove",gs);bX(document,"mouseup",go)}function ge(gr,gn,gp,gq,gj){try{var gh=gn.clientX,gg=gn.clientY}catch(gn){return false}if(gh>=Math.floor(gr.display.gutters.getBoundingClientRect().right)){return false}if(gq){cG(gn)}var go=gr.display;var gm=go.lineDiv.getBoundingClientRect();if(gg>gm.bottom||!fi(gr,gp)){return bL(gn)}gg-=gm.top-go.viewOffset;for(var gk=0;gk<gr.options.gutters.length;++gk){var gl=go.gutters.childNodes[gk];if(gl&&gl.getBoundingClientRect().right>=gh){var gs=bG(gr.doc,gg);var gi=gr.options.gutters[gk];gj(gr,gp,gr,gs,gi,gn);return bL(gn)}}}function l(gg,gh){return ge(gg,gh,"gutterClick",true,ae)}var ag=0;function bk(gm){var go=this;if(aR(go,gm)||bb(go.display,gm)){return}cG(gm);if(dK){ag=+new Date}var gn=cn(go,gm,true),gg=gm.dataTransfer.files;if(!gn||aj(go)){return}if(gg&&gg.length&&window.FileReader&&window.File){var gi=gg.length,gp=Array(gi),gh=0;var gk=function(gs,gr){var gq=new FileReader;gq.onload=c2(go,function(){gp[gr]=gq.result;if(++gh==gi){gn=fJ(go.doc,gn);var gt={from:gn,to:gn,text:a1(gp.join("\n")),origin:"paste"};bg(go.doc,gt);e7(go.doc,eS(gn,cX(gt)))}});gq.readAsText(gs)};for(var gl=0;gl<gi;++gl){gk(gg[gl],gl)}}else{if(go.state.draggingText&&go.doc.sel.contains(gn)>-1){go.state.draggingText(gm);setTimeout(function(){go.display.input.focus()},20);return}try{var gp=gm.dataTransfer.getData("Text");if(gp){if(go.state.draggingText&&!(b7?gm.altKey:gm.ctrlKey)){var gj=go.listSelections()}ep(go.doc,eS(gn,gn));if(gj){for(var gl=0;gl<gj.length;++gl){a2(go.doc,"",gj[gl].anchor,gj[gl].head,"drag")}}go.replaceSelection(gp,"around","paste");go.display.input.focus()}}catch(gm){}}}function Q(gg,gi){if(dK&&(!gg.state.draggingText||+new Date-ag<100)){er(gi);return}if(aR(gg,gi)||bb(gg.display,gi)){return}gi.dataTransfer.setData("Text",gg.getSelection());if(gi.dataTransfer.setDragImage&&!aC){var gh=f1("img",null,null,"position: fixed; left: 0; top: 0;");gh.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(d3){gh.width=gh.height=1;gg.display.wrapper.appendChild(gh);gh._top=gh.offsetTop}gi.dataTransfer.setDragImage(gh,0,0);if(d3){gh.parentNode.removeChild(gh)}}}function N(gg,gh){if(Math.abs(gg.doc.scrollTop-gh)<2){return}gg.doc.scrollTop=gh;if(!co){dT(gg,{top:gh})}if(gg.display.scroller.scrollTop!=gh){gg.display.scroller.scrollTop=gh}gg.display.scrollbars.setScrollTop(gh);if(co){dT(gg)}ef(gg,100)}function bE(gg,gi,gh){if(gh?gi==gg.doc.scrollLeft:Math.abs(gg.doc.scrollLeft-gi)<2){return}gi=Math.min(gi,gg.display.scroller.scrollWidth-gg.display.scroller.clientWidth);gg.doc.scrollLeft=gi;eE(gg);if(gg.display.scroller.scrollLeft!=gi){gg.display.scroller.scrollLeft=gi}gg.display.scrollbars.setScrollLeft(gi)}var fm=0,cg=null;if(dK){cg=-0.53}else{if(co){cg=15}else{if(dc){cg=-0.7}else{if(aC){cg=-1/3}}}}var cQ=function(gi){var gh=gi.wheelDeltaX,gg=gi.wheelDeltaY;if(gh==null&&gi.detail&&gi.axis==gi.HORIZONTAL_AXIS){gh=gi.detail}if(gg==null&&gi.detail&&gi.axis==gi.VERTICAL_AXIS){gg=gi.detail}else{if(gg==null){gg=gi.wheelDelta}}return{x:gh,y:gg}};H.wheelEventPixels=function(gg){var gh=cQ(gg);gh.x*=cg;gh.y*=cg;return gh};function b(go,gi){var gp=cQ(gi),gs=gp.x,gr=gp.y;var gk=go.display,gn=gk.scroller;if(!(gs&&gn.scrollWidth>gn.clientWidth||gr&&gn.scrollHeight>gn.clientHeight)){return}if(gr&&b7&&c0){outer:for(var gq=gi.target,gm=gk.view;gq!=gn;gq=gq.parentNode){for(var gh=0;gh<gm.length;gh++){if(gm[gh].node==gq){go.display.currentWheelTarget=gq;break outer}}}}if(gs&&!co&&!d3&&cg!=null){if(gr){N(go,Math.max(0,Math.min(gn.scrollTop+gr*cg,gn.scrollHeight-gn.clientHeight)))}bE(go,Math.max(0,Math.min(gn.scrollLeft+gs*cg,gn.scrollWidth-gn.clientWidth)));cG(gi);gk.wheelStartX=null;return}if(gr&&cg!=null){var gg=gr*cg;var gl=go.doc.scrollTop,gj=gl+gk.wrapper.clientHeight;if(gg<0){gl=Math.max(0,gl+gg-50)}else{gj=Math.min(go.doc.height,gj+gg+50)}dT(go,{top:gl,bottom:gj})}if(fm<20){if(gk.wheelStartX==null){gk.wheelStartX=gn.scrollLeft;gk.wheelStartY=gn.scrollTop;gk.wheelDX=gs;gk.wheelDY=gr;setTimeout(function(){if(gk.wheelStartX==null){return}var gt=gn.scrollLeft-gk.wheelStartX;var gv=gn.scrollTop-gk.wheelStartY;var gu=(gv&&gk.wheelDY&&gv/gk.wheelDY)||(gt&&gk.wheelDX&&gt/gk.wheelDX);gk.wheelStartX=gk.wheelStartY=null;if(!gu){return}cg=(cg*fm+gu)/(fm+1);++fm},200)}else{gk.wheelDX+=gs;gk.wheelDY+=gr}}}function fR(gh,gk,gg){if(typeof gk=="string"){gk=eD[gk];if(!gk){return false}}gh.display.input.ensurePolled();var gj=gh.display.shift,gi=false;try{if(aj(gh)){gh.state.suppressEdits=true}if(gg){gh.display.shift=false}gi=gk(gh)!=ca}finally{gh.display.shift=gj;gh.state.suppressEdits=false}return gi}function ea(gh,gi,gk){for(var gj=0;gj<gh.state.keyMaps.length;gj++){var gg=i(gi,gh.state.keyMaps[gj],gk,gh);if(gg){return gg}}return(gh.options.extraKeys&&i(gi,gh.options.extraKeys,gk,gh))||i(gi,gh.options.keyMap,gk,gh)}var dM=new gf;function bd(gh,gj,gl,gk){var gi=gh.state.keySeq;if(gi){if(eC(gj)){return"handled"}dM.set(50,function(){if(gh.state.keySeq==gi){gh.state.keySeq=null;gh.display.input.reset()}});gj=gi+" "+gj}var gg=ea(gh,gj,gk);if(gg=="multi"){gh.state.keySeq=gj}if(gg=="handled"){ae(gh,"keyHandled",gh,gj,gl)}if(gg=="handled"||gg=="multi"){cG(gl);o(gh)}if(gi&&!gg&&/\'$/.test(gj)){cG(gl);return true}return !!gg}function fj(gg,gi){var gh=fr(gi,true);if(!gh){return false}if(gi.shiftKey&&!gg.state.keySeq){return bd(gg,"Shift-"+gh,gi,function(gj){return fR(gg,gj,true)})||bd(gg,gh,gi,function(gj){if(typeof gj=="string"?/^go[A-Z]/.test(gj):gj.motion){return fR(gg,gj)}})}else{return bd(gg,gh,gi,function(gj){return fR(gg,gj)})}}function ej(gg,gi,gh){return bd(gg,"'"+gh+"'",gi,function(gj){return fR(gg,gj,true)})}var dm=null;function p(gj){var gg=this;gg.curOp.focus=dO();if(aR(gg,gj)){return}if(dK&&k<11&&gj.keyCode==27){gj.returnValue=false}var gh=gj.keyCode;gg.display.shift=gh==16||gj.shiftKey;var gi=fj(gg,gj);if(d3){dm=gi?gh:null;if(!gi&&gh==88&&!da&&(b7?gj.metaKey:gj.ctrlKey)){gg.replaceSelection("",null,"cut")}}if(gh==18&&!/\bCodeMirror-crosshair\b/.test(gg.display.lineDiv.className)){av(gg)}}function av(gh){var gi=gh.display.lineDiv;fA(gi,"CodeMirror-crosshair");function gg(gj){if(gj.keyCode==18||!gj.altKey){f(gi,"CodeMirror-crosshair");ed(document,"keyup",gg);ed(document,"mouseover",gg)}}bX(document,"keyup",gg);bX(document,"mouseover",gg)}function bi(gg){if(gg.keyCode==16){this.doc.sel.shift=false}aR(this,gg)}function cx(gk){var gg=this;if(bb(gg.display,gk)||aR(gg,gk)||gk.ctrlKey&&!gk.altKey||b7&&gk.metaKey){return}var gj=gk.keyCode,gh=gk.charCode;if(d3&&gj==dm){dm=null;cG(gk);return}if((d3&&(!gk.which||gk.which<10))&&fj(gg,gk)){return}var gi=String.fromCharCode(gh==null?gj:gh);if(ej(gg,gk,gi)){return}gg.display.input.onKeyPress(gk)}function al(gg){gg.state.delayingBlurEvent=true;setTimeout(function(){if(gg.state.delayingBlurEvent){gg.state.delayingBlurEvent=false;aV(gg)}},100)}function cB(gg){if(gg.state.delayingBlurEvent){gg.state.delayingBlurEvent=false}if(gg.options.readOnly=="nocursor"){return}if(!gg.state.focused){aE(gg,"focus",gg);gg.state.focused=true;fA(gg.display.wrapper,"CodeMirror-focused");if(!gg.curOp&&gg.display.selForContextMenu!=gg.doc.sel){gg.display.input.reset();if(c0){setTimeout(function(){gg.display.input.reset(true)},20)}}gg.display.input.receivedFocus()}o(gg)}function aV(gg){if(gg.state.delayingBlurEvent){return}if(gg.state.focused){aE(gg,"blur",gg);gg.state.focused=false;f(gg.display.wrapper,"CodeMirror-focused")}clearInterval(gg.display.blinker);setTimeout(function(){if(!gg.state.focused){gg.display.shift=false}},150)}function ay(gg,gh){if(bb(gg.display,gh)||dg(gg,gh)){return}gg.display.input.onContextMenu(gh)}function dg(gg,gh){if(!fi(gg,"gutterContextMenu")){return false}return ge(gg,gh,"gutterContextMenu",false,aE)}var cX=H.changeEnd=function(gg){if(!gg.text){return gg.to}return W(gg.from.line+gg.text.length-1,fG(gg.text).length+(gg.text.length==1?gg.from.ch:0))};function bZ(gj,gi){if(cf(gj,gi.from)<0){return gj}if(cf(gj,gi.to)<=0){return cX(gi)}var gg=gj.line+gi.text.length-(gi.to.line-gi.from.line)-1,gh=gj.ch;if(gj.line==gi.to.line){gh+=cX(gi).ch-gi.to.ch}return W(gg,gh)}function fk(gj,gk){var gh=[];for(var gi=0;gi<gj.sel.ranges.length;gi++){var gg=gj.sel.ranges[gi];gh.push(new dY(bZ(gg.anchor,gk),bZ(gg.head,gk)))}return cw(gh,gj.sel.primIndex)}function bu(gi,gh,gg){if(gi.line==gh.line){return W(gg.line,gi.ch-gh.ch+gg.ch)}else{return W(gg.line+(gi.line-gh.line),gi.ch)}}function af(gq,gn,gh){var gi=[];var gg=W(gq.first,0),gr=gg;for(var gk=0;gk<gn.length;gk++){var gm=gn[gk];var gp=bu(gm.from,gg,gr);var go=bu(cX(gm),gg,gr);gg=gm.to;gr=go;if(gh=="around"){var gl=gq.sel.ranges[gk],gj=cf(gl.head,gl.anchor)<0;gi[gk]=new dY(gj?go:gp,gj?gp:go)}else{gi[gk]=new dY(gp,gp)}}return new f2(gi,gq.sel.primIndex)}function dR(gh,gj,gi){var gg={canceled:false,from:gj.from,to:gj.to,text:gj.text,origin:gj.origin,cancel:function(){this.canceled=true}};if(gi){gg.update=function(gn,gm,gl,gk){if(gn){this.from=fJ(gh,gn)}if(gm){this.to=fJ(gh,gm)}if(gl){this.text=gl}if(gk!==undefined){this.origin=gk}}}aE(gh,"beforeChange",gh,gg);if(gh.cm){aE(gh.cm,"beforeChange",gh.cm,gg)}if(gg.canceled){return null}return{from:gg.from,to:gg.to,text:gg.text,origin:gg.origin}}function bg(gj,gk,gi){if(gj.cm){if(!gj.cm.curOp){return c2(gj.cm,bg)(gj,gk,gi)}if(gj.cm.state.suppressEdits){return}}if(fi(gj,"beforeChange")||gj.cm&&fi(gj.cm,"beforeChange")){gk=dR(gj,gk,true);if(!gk){return}}var gh=gb&&!gi&&cH(gj,gk.from,gk.to);if(gh){for(var gg=gh.length-1;gg>=0;--gg){K(gj,{from:gh[gg].from,to:gh[gg].to,text:gg?[""]:gk.text})}}else{K(gj,gk)}}function K(gi,gj){if(gj.text.length==1&&gj.text[0]==""&&cf(gj.from,gj.to)==0){return}var gh=fk(gi,gj);fM(gi,gj,gh,gi.cm?gi.cm.curOp.id:NaN);ee(gi,gj,gh,ek(gi,gj));var gg=[];d7(gi,function(gl,gk){if(!gk&&dh(gg,gl.history)==-1){dE(gl.history,gj);gg.push(gl.history)}ee(gl,gj,null,ek(gl,gj))})}function b8(gr,gp,gt){if(gr.cm&&gr.cm.state.suppressEdits){return}var go=gr.history,gi,gk=gr.sel;var gg=gp=="undo"?go.done:go.undone,gs=gp=="undo"?go.undone:go.done;for(var gl=0;gl<gg.length;gl++){gi=gg[gl];if(gt?gi.ranges&&!gi.equals(gr.sel):!gi.ranges){break}}if(gl==gg.length){return}go.lastOrigin=go.lastSelOrigin=null;for(;;){gi=gg.pop();if(gi.ranges){cN(gi,gs);if(gt&&!gi.equals(gr.sel)){bU(gr,gi,{clearRedo:false});return}gk=gi}else{break}}var gn=[];cN(gk,gs);gs.push({changes:gn,generation:go.generation});go.generation=gi.generation||++go.maxGeneration;var gj=fi(gr,"beforeChange")||gr.cm&&fi(gr.cm,"beforeChange");for(var gl=gi.changes.length-1;gl>=0;--gl){var gq=gi.changes[gl];gq.origin=gp;if(gj&&!dR(gr,gq,false)){gg.length=0;return}gn.push(du(gr,gq));var gh=gl?fk(gr,gq):fG(gg);ee(gr,gq,gh,d9(gr,gq));if(!gl&&gr.cm){gr.cm.scrollIntoView({from:gq.from,to:cX(gq)})}var gm=[];d7(gr,function(gv,gu){if(!gu&&dh(gm,gv.history)==-1){dE(gv.history,gq);gm.push(gv.history)}ee(gv,gq,null,d9(gv,gq))})}}function fn(gh,gj){if(gj==0){return}gh.first+=gj;gh.sel=new f2(bS(gh.sel.ranges,function(gk){return new dY(W(gk.anchor.line+gj,gk.anchor.ch),W(gk.head.line+gj,gk.head.ch))}),gh.sel.primIndex);if(gh.cm){ah(gh.cm,gh.first,gh.first-gj,gj);for(var gi=gh.cm.display,gg=gi.viewFrom;gg<gi.viewTo;gg++){R(gh.cm,gg,"gutter")}}}function ee(gk,gl,gj,gh){if(gk.cm&&!gk.cm.curOp){return c2(gk.cm,ee)(gk,gl,gj,gh)}if(gl.to.line<gk.first){fn(gk,gl.text.length-1-(gl.to.line-gl.from.line));return}if(gl.from.line>gk.lastLine()){return}if(gl.from.line<gk.first){var gg=gl.text.length-1-(gk.first-gl.from.line);fn(gk,gg);gl={from:W(gk.first,0),to:W(gl.to.line+gg,gl.to.ch),text:[fG(gl.text)],origin:gl.origin}}var gi=gk.lastLine();if(gl.to.line>gi){gl={from:gl.from,to:W(gi,ff(gk,gi).text.length),text:[gl.text[0]],origin:gl.origin}}gl.removed=f3(gk,gl.from,gl.to);if(!gj){gj=fk(gk,gl)}if(gk.cm){aJ(gk.cm,gl,gh)}else{fy(gk,gl,gh)}ep(gk,gj,Z)}function aJ(gr,gn,gl){var gq=gr.doc,gm=gr.display,go=gn.from,gp=gn.to;var gg=false,gk=go.line;if(!gr.options.lineWrapping){gk=bN(y(ff(gq,go.line)));gq.iter(gk,gp.line+1,function(gt){if(gt==gm.maxLine){gg=true;return true}})}if(gq.sel.contains(gn.from,gn.to)>-1){V(gr)}fy(gq,gn,gl,be(gr));if(!gr.options.lineWrapping){gq.iter(gk,go.line+gn.text.length,function(gu){var gt=en(gu);if(gt>gm.maxLineLength){gm.maxLine=gu;gm.maxLineLength=gt;gm.maxLineChanged=true;gg=false}});if(gg){gr.curOp.updateMaxLine=true}}gq.frontier=Math.min(gq.frontier,go.line);ef(gr,400);var gs=gn.text.length-(gp.line-go.line)-1;if(gn.full){ah(gr)}else{if(go.line==gp.line&&gn.text.length==1&&!dS(gr.doc,gn)){R(gr,go.line,"text")}else{ah(gr,go.line,gp.line+1,gs)}}var gi=fi(gr,"changes"),gj=fi(gr,"change");if(gj||gi){var gh={from:go,to:gp,text:gn.text,removed:gn.removed,origin:gn.origin};if(gj){ae(gr,"change",gr,gh)}if(gi){(gr.curOp.changeObjs||(gr.curOp.changeObjs=[])).push(gh)}}gr.display.selForContextMenu=null}function a2(gj,gi,gl,gk,gg){if(!gk){gk=gl}if(cf(gk,gl)<0){var gh=gk;gk=gl;gl=gh}if(typeof gi=="string"){gi=a1(gi)}bg(gj,{from:gl,to:gk,text:gi,origin:gg})}function d6(gh,gk){if(aR(gh,"scrollCursorIntoView")){return}var gl=gh.display,gi=gl.sizer.getBoundingClientRect(),gg=null;if(gk.top+gi.top<0){gg=true}else{if(gk.bottom+gi.top>(window.innerHeight||document.documentElement.clientHeight)){gg=false}}if(gg!=null&&!fu){var gj=f1("div","\u200b",null,"position: absolute; top: "+(gk.top-gl.viewOffset-e8(gh.display))+"px; height: "+(gk.bottom-gk.top+cT(gh)+gl.barHeight)+"px; left: "+gk.left+"px; width: 2px;");gh.display.lineSpace.appendChild(gj);gj.scrollIntoView(gg);gh.display.lineSpace.removeChild(gj)}}function D(gq,go,gk,gj){if(gj==null){gj=0}for(var gl=0;gl<5;gl++){var gm=false,gp=dU(gq,go);var gg=!gk||gk==go?gp:dU(gq,gk);var gi=G(gq,Math.min(gp.left,gg.left),Math.min(gp.top,gg.top)-gj,Math.max(gp.left,gg.left),Math.max(gp.bottom,gg.bottom)+gj);var gn=gq.doc.scrollTop,gh=gq.doc.scrollLeft;if(gi.scrollTop!=null){N(gq,gi.scrollTop);if(Math.abs(gq.doc.scrollTop-gn)>1){gm=true}}if(gi.scrollLeft!=null){bE(gq,gi.scrollLeft);if(Math.abs(gq.doc.scrollLeft-gh)>1){gm=true}}if(!gm){break}}return gp}function E(gg,gi,gk,gh,gj){var gl=G(gg,gi,gk,gh,gj);if(gl.scrollTop!=null){N(gg,gl.scrollTop)}if(gl.scrollLeft!=null){bE(gg,gl.scrollLeft)}}function G(gs,gj,gr,gh,gq){var go=gs.display,gm=aY(gs.display);if(gr<0){gr=0}var gk=gs.curOp&&gs.curOp.scrollTop!=null?gs.curOp.scrollTop:go.scroller.scrollTop;var gu=cV(gs),gw={};if(gq-gr>gu){gq=gr+gu}var gi=gs.doc.height+bI(go);var gg=gr<gm,gn=gq>gi-gm;if(gr<gk){gw.scrollTop=gg?0:gr}else{if(gq>gk+gu){var gp=Math.min(gr,(gn?gi:gq)-gu);if(gp!=gk){gw.scrollTop=gp}}}var gv=gs.curOp&&gs.curOp.scrollLeft!=null?gs.curOp.scrollLeft:go.scroller.scrollLeft;var gt=dl(gs)-(gs.options.fixedGutter?go.gutters.offsetWidth:0);var gl=gh-gj>gt;if(gl){gh=gj+gt}if(gj<10){gw.scrollLeft=0}else{if(gj<gv){gw.scrollLeft=Math.max(0,gj-(gl?0:10))}else{if(gh>gt+gv-3){gw.scrollLeft=gh+(gl?0:10)-gt}}}return gw}function cL(gg,gi,gh){if(gi!=null||gh!=null){fC(gg)}if(gi!=null){gg.curOp.scrollLeft=(gg.curOp.scrollLeft==null?gg.doc.scrollLeft:gg.curOp.scrollLeft)+gi}if(gh!=null){gg.curOp.scrollTop=(gg.curOp.scrollTop==null?gg.doc.scrollTop:gg.curOp.scrollTop)+gh}}function fF(gg){fC(gg);var gh=gg.getCursor(),gj=gh,gi=gh;if(!gg.options.lineWrapping){gj=gh.ch?W(gh.line,gh.ch-1):gh;gi=W(gh.line,gh.ch+1)}gg.curOp.scrollToPos={from:gj,to:gi,margin:gg.options.cursorScrollMargin,isCursor:true}}function fC(gg){var gi=gg.curOp.scrollToPos;if(gi){gg.curOp.scrollToPos=null;var gk=dH(gg,gi.from),gj=dH(gg,gi.to);var gh=G(gg,Math.min(gk.left,gj.left),Math.min(gk.top,gj.top)-gi.margin,Math.max(gk.right,gj.right),Math.max(gk.bottom,gj.bottom)+gi.margin);gg.scrollTo(gh.scrollLeft,gh.scrollTop)}}function ad(gt,gj,gs,gi){var gr=gt.doc,gh;if(gs==null){gs="add"}if(gs=="smart"){if(!gr.mode.indent){gs="prev"}else{gh=dC(gt,gj)}}var gn=gt.options.tabSize;var gu=ff(gr,gj),gm=bT(gu.text,null,gn);if(gu.stateAfter){gu.stateAfter=null}var gg=gu.text.match(/^\s*/)[0],gp;if(!gi&&!/\S/.test(gu.text)){gp=0;gs="not"}else{if(gs=="smart"){gp=gr.mode.indent(gh,gu.text.slice(gg.length),gu.text);if(gp==ca||gp>150){if(!gi){return}gs="prev"}}}if(gs=="prev"){if(gj>gr.first){gp=bT(ff(gr,gj-1).text,null,gn)}else{gp=0}}else{if(gs=="add"){gp=gm+gt.options.indentUnit}else{if(gs=="subtract"){gp=gm-gt.options.indentUnit}else{if(typeof gs=="number"){gp=gm+gs}}}}gp=Math.max(0,gp);var gq="",go=0;if(gt.options.indentWithTabs){for(var gk=Math.floor(gp/gn);gk;--gk){go+=gn;gq+="\t"}}if(go<gp){gq+=cp(gp-go)}if(gq!=gg){a2(gr,gq,W(gj,0),W(gj,gg.length),"+input");gu.stateAfter=null;return true}else{for(var gk=0;gk<gr.sel.ranges.length;gk++){var gl=gr.sel.ranges[gk];if(gl.head.line==gj&&gl.head.ch<gg.length){var go=W(gj,gg.length);e(gr,gk,new dY(go,go));break}}}}function ez(gj,gi,gg,gl){var gk=gi,gh=gi;if(typeof gi=="number"){gh=ff(gj,c5(gj,gi))}else{gk=bN(gi)}if(gk==null){return null}if(gl(gh,gk)&&gj.cm){R(gj.cm,gk,gg)}return gh}function eX(gg,gm){var gh=gg.doc.sel.ranges,gk=[];for(var gj=0;gj<gh.length;gj++){var gi=gm(gh[gj]);while(gk.length&&cf(gi.from,fG(gk).to)<=0){var gl=gk.pop();if(cf(gl.from,gi.from)<0){gi.from=gl.from;break}}gk.push(gi)}cM(gg,function(){for(var gn=gk.length-1;gn>=0;gn--){a2(gg.doc,"",gk[gn].from,gk[gn].to,"+delete")}fF(gg)})}function bw(gy,gk,gs,gr,gm){var gp=gk.line,gq=gk.ch,gx=gs;var gh=ff(gy,gp);var gv=true;function gw(){var gz=gp+gs;if(gz<gy.first||gz>=gy.first+gy.size){return(gv=false)}gp=gz;return gh=ff(gy,gz)}function gu(gA){var gz=(gm?u:ai)(gh,gq,gs,true);if(gz==null){if(!gA&&gw()){if(gm){gq=(gs<0?cS:cE)(gh)}else{gq=gs<0?gh.text.length:0}}else{return(gv=false)}}else{gq=gz}return true}if(gr=="char"){gu()}else{if(gr=="column"){gu(true)}else{if(gr=="word"||gr=="group"){var gt=null,gn=gr=="group";var gg=gy.cm&&gy.cm.getHelper(gk,"wordChars");for(var gl=true;;gl=false){if(gs<0&&!gu(!gl)){break}var gi=gh.text.charAt(gq)||"\n";var gj=cA(gi,gg)?"w":gn&&gi=="\n"?"n":!gn||/\s/.test(gi)?null:"p";if(gn&&!gl&&!gj){gj="s"}if(gt&&gt!=gj){if(gs<0){gs=1;gu()}break}if(gj){gt=gj}if(gs>0&&!gu(!gl)){break}}}}}var go=bV(gy,W(gp,gq),gx,true);if(!gv){go.hitSide=true}return go}function bq(go,gj,gg,gn){var gm=go.doc,gl=gj.left,gk;if(gn=="page"){var gi=Math.min(go.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);gk=gj.top+gg*(gi-(gg<0?1.5:0.5)*aY(go.display))}else{if(gn=="line"){gk=gg>0?gj.bottom+3:gj.top-3}}for(;;){var gh=fO(go,gl,gk);if(!gh.outside){break}if(gg<0?gk<=0:gk>=gm.height){gh.hitSide=true;break}gk+=gg*5}return gh}H.prototype={constructor:H,focus:function(){window.focus();this.display.input.focus()},setOption:function(gi,gj){var gh=this.options,gg=gh[gi];if(gh[gi]==gj&&gi!="mode"){return}gh[gi]=gj;if(bf.hasOwnProperty(gi)){c2(this,bf[gi])(this,gj,gg)}},getOption:function(gg){return this.options[gg]},getDoc:function(){return this.doc},addKeyMap:function(gh,gg){this.state.keyMaps[gg?"push":"unshift"](fW(gh))},removeKeyMap:function(gh){var gi=this.state.keyMaps;for(var gg=0;gg<gi.length;++gg){if(gi[gg]==gh||gi[gg].name==gh){gi.splice(gg,1);return true}}},addOverlay:c8(function(gg,gh){var gi=gg.token?gg:H.getMode(this.options,gg);if(gi.startState){throw new Error("Overlays may not be stateful.")}this.state.overlays.push({mode:gi,modeSpec:gg,opaque:gh&&gh.opaque});this.state.modeGen++;ah(this)}),removeOverlay:c8(function(gg){var gi=this.state.overlays;for(var gh=0;gh<gi.length;++gh){var gj=gi[gh].modeSpec;if(gj==gg||typeof gg=="string"&&gj.name==gg){gi.splice(gh,1);this.state.modeGen++;ah(this);return}}}),indentLine:c8(function(gi,gg,gh){if(typeof gg!="string"&&typeof gg!="number"){if(gg==null){gg=this.options.smartIndent?"smart":"prev"}else{gg=gg?"add":"subtract"}}if(b9(this.doc,gi)){ad(this,gi,gg,gh)}}),indentSelection:c8(function(gp){var gg=this.doc.sel.ranges,gj=-1;for(var gl=0;gl<gg.length;gl++){var gm=gg[gl];if(!gm.empty()){var gn=gm.from(),go=gm.to();var gh=Math.max(gj,gn.line);gj=Math.min(this.lastLine(),go.line-(go.ch?0:1))+1;for(var gk=gh;gk<gj;++gk){ad(this,gk,gp)}var gi=this.doc.sel.ranges;if(gn.ch==0&&gg.length==gi.length&&gi[gl].from().ch>0){e(this.doc,gl,new dY(gn,gi[gl].to()),Z)}}else{if(gm.head.line>gj){ad(this,gm.head.line,gp,true);gj=gm.head.line;if(gl==this.doc.sel.primIndex){fF(this)}}}}}),getTokenAt:function(gh,gg){return cq(this,gh,gg)},getLineTokens:function(gh,gg){return cq(this,W(gh),gg,true)},getTokenTypeAt:function(gn){gn=fJ(this.doc,gn);var gj=c6(this,ff(this.doc,gn.line));var gl=0,gm=(gj.length-1)/2,gi=gn.ch;var gh;if(gi==0){gh=gj[2]}else{for(;;){var gg=(gl+gm)>>1;if((gg?gj[gg*2-1]:0)>=gi){gm=gg}else{if(gj[gg*2+1]<gi){gl=gg+1}else{gh=gj[gg*2+2];break}}}}var gk=gh?gh.indexOf("cm-overlay "):-1;return gk<0?gh:gk==0?null:gh.slice(0,gk-1)},getModeAt:function(gh){var gg=this.doc.mode;if(!gg.innerMode){return gg}return H.innerMode(gg,this.getTokenAt(gh).state).mode},getHelper:function(gh,gg){return this.getHelpers(gh,gg)[0]},getHelpers:function(gn,gi){var gj=[];if(!fo.hasOwnProperty(gi)){return gj}var gg=fo[gi],gm=this.getModeAt(gn);if(typeof gm[gi]=="string"){if(gg[gm[gi]]){gj.push(gg[gm[gi]])}}else{if(gm[gi]){for(var gh=0;gh<gm[gi].length;gh++){var gl=gg[gm[gi][gh]];if(gl){gj.push(gl)}}}else{if(gm.helperType&&gg[gm.helperType]){gj.push(gg[gm.helperType])}else{if(gg[gm.name]){gj.push(gg[gm.name])}}}}for(var gh=0;gh<gg._global.length;gh++){var gk=gg._global[gh];if(gk.pred(gm,this)&&dh(gj,gk.val)==-1){gj.push(gk.val)}}return gj},getStateAfter:function(gh,gg){var gi=this.doc;gh=c5(gi,gh==null?gi.first+gi.size-1:gh);return dC(this,gh+1,gg)},cursorCoords:function(gj,gh){var gi,gg=this.doc.sel.primary();if(gj==null){gi=gg.head}else{if(typeof gj=="object"){gi=fJ(this.doc,gj)}else{gi=gj?gg.from():gg.to()}}return dU(this,gi,gh||"page")},charCoords:function(gh,gg){return cJ(this,fJ(this.doc,gh),gg||"page")},coordsChar:function(gg,gh){gg=gd(this,gg,gh||"page");return fO(this,gg.left,gg.top)},lineAtHeight:function(gg,gh){gg=gd(this,{top:gg,left:0},gh||"page").top;return bG(this.doc,gg+this.display.viewOffset)},heightAtLine:function(gh,gk){var gg=false,gi;if(typeof gh=="number"){var gj=this.doc.first+this.doc.size-1;if(gh<this.doc.first){gh=this.doc.first}else{if(gh>gj){gh=gj;gg=true}}gi=ff(this.doc,gh)}else{gi=gh}return eQ(this,gi,{top:0,left:0},gk||"page").top+(gg?this.doc.height-bM(gi):0)},defaultTextHeight:function(){return aY(this.display)},defaultCharWidth:function(){return dD(this.display)},setGutterMarker:c8(function(gg,gh,gi){return ez(this.doc,gg,"gutter",function(gj){var gk=gj.gutterMarkers||(gj.gutterMarkers={});gk[gh]=gi;if(!gi&&eU(gk)){gj.gutterMarkers=null}return true})}),clearGutter:c8(function(gi){var gg=this,gj=gg.doc,gh=gj.first;gj.iter(function(gk){if(gk.gutterMarkers&&gk.gutterMarkers[gi]){gk.gutterMarkers[gi]=null;R(gg,gh,"gutter");if(eU(gk.gutterMarkers)){gk.gutterMarkers=null}}++gh})}),lineInfo:function(gg){if(typeof gg=="number"){if(!b9(this.doc,gg)){return null}var gh=gg;gg=ff(this.doc,gg);if(!gg){return null}}else{var gh=bN(gg);if(gh==null){return null}}return{line:gh,handle:gg,text:gg.text,gutterMarkers:gg.gutterMarkers,textClass:gg.textClass,bgClass:gg.bgClass,wrapClass:gg.wrapClass,widgets:gg.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(gl,gi,gn,gj,gp){var gk=this.display;gl=dU(this,fJ(this.doc,gl));var gm=gl.bottom,gh=gl.left;gi.style.position="absolute";gi.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(gi);gk.sizer.appendChild(gi);if(gj=="over"){gm=gl.top}else{if(gj=="above"||gj=="near"){var gg=Math.max(gk.wrapper.clientHeight,this.doc.height),go=Math.max(gk.sizer.clientWidth,gk.lineSpace.clientWidth);if((gj=="above"||gl.bottom+gi.offsetHeight>gg)&&gl.top>gi.offsetHeight){gm=gl.top-gi.offsetHeight}else{if(gl.bottom+gi.offsetHeight<=gg){gm=gl.bottom}}if(gh+gi.offsetWidth>go){gh=go-gi.offsetWidth}}}gi.style.top=gm+"px";gi.style.left=gi.style.right="";if(gp=="right"){gh=gk.sizer.clientWidth-gi.offsetWidth;gi.style.right="0px"}else{if(gp=="left"){gh=0}else{if(gp=="middle"){gh=(gk.sizer.clientWidth-gi.offsetWidth)/2}}gi.style.left=gh+"px"}if(gn){E(this,gh,gm,gh+gi.offsetWidth,gm+gi.offsetHeight)}},triggerOnKeyDown:c8(p),triggerOnKeyPress:c8(cx),triggerOnKeyUp:bi,execCommand:function(gg){if(eD.hasOwnProperty(gg)){return eD[gg](this)}},findPosH:function(gm,gj,gk,gh){var gg=1;if(gj<0){gg=-1;gj=-gj}for(var gi=0,gl=fJ(this.doc,gm);gi<gj;++gi){gl=bw(this.doc,gl,gg,gk,gh);if(gl.hitSide){break}}return gl},moveH:c8(function(gh,gi){var gg=this;gg.extendSelectionsBy(function(gj){if(gg.display.shift||gg.doc.extend||gj.empty()){return bw(gg.doc,gj.head,gh,gi,gg.options.rtlMoveVisually)}else{return gh<0?gj.from():gj.to()}},cW)}),deleteH:c8(function(gg,gh){var gi=this.doc.sel,gj=this.doc;if(gi.somethingSelected()){gj.replaceSelection("",null,"+delete")}else{eX(this,function(gl){var gk=bw(gj,gl.head,gg,gh,false);return gg<0?{from:gk,to:gl.head}:{from:gl.head,to:gk}})}}),findPosV:function(gl,gi,gm,go){var gg=1,gk=go;if(gi<0){gg=-1;gi=-gi}for(var gh=0,gn=fJ(this.doc,gl);gh<gi;++gh){var gj=dU(this,gn,"div");if(gk==null){gk=gj.left}else{gj.left=gk}gn=bq(this,gj,gg,gm);if(gn.hitSide){break}}return gn},moveV:c8(function(gh,gj){var gg=this,gl=this.doc,gk=[];var gm=!gg.display.shift&&!gl.extend&&gl.sel.somethingSelected();gl.extendSelectionsBy(function(gn){if(gm){return gh<0?gn.from():gn.to()}var gp=dU(gg,gn.head,"div");if(gn.goalColumn!=null){gp.left=gn.goalColumn}gk.push(gp.left);var go=bq(gg,gp,gh,gj);if(gj=="page"&&gn==gl.sel.primary()){cL(gg,null,cJ(gg,go,"div").top-gp.top)}return go},cW);if(gk.length){for(var gi=0;gi<gl.sel.ranges.length;gi++){gl.sel.ranges[gi].goalColumn=gk[gi]}}}),findWordAt:function(gn){var gl=this.doc,gj=ff(gl,gn.line).text;var gm=gn.ch,gi=gn.ch;if(gj){var gk=this.getHelper(gn,"wordChars");if((gn.xRel<0||gi==gj.length)&&gm){--gm}else{++gi}var gh=gj.charAt(gm);var gg=cA(gh,gk)?function(go){return cA(go,gk)}:/\s/.test(gh)?function(go){return/\s/.test(go)}:function(go){return !/\s/.test(go)&&!cA(go)};while(gm>0&&gg(gj.charAt(gm-1))){--gm}while(gi<gj.length&&gg(gj.charAt(gi))){++gi}}return new dY(W(gn.line,gm),W(gn.line,gi))},toggleOverwrite:function(gg){if(gg!=null&&gg==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){fA(this.display.cursorDiv,"CodeMirror-overwrite")}else{f(this.display.cursorDiv,"CodeMirror-overwrite")}aE(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return this.display.input.getField()==dO()},scrollTo:c8(function(gg,gh){if(gg!=null||gh!=null){fC(this)}if(gg!=null){this.curOp.scrollLeft=gg}if(gh!=null){this.curOp.scrollTop=gh}}),getScrollInfo:function(){var gg=this.display.scroller;return{left:gg.scrollLeft,top:gg.scrollTop,height:gg.scrollHeight-cT(this)-this.display.barHeight,width:gg.scrollWidth-cT(this)-this.display.barWidth,clientHeight:cV(this),clientWidth:dl(this)}},scrollIntoView:c8(function(gh,gi){if(gh==null){gh={from:this.doc.sel.primary().head,to:null};if(gi==null){gi=this.options.cursorScrollMargin}}else{if(typeof gh=="number"){gh={from:W(gh,0),to:null}}else{if(gh.from==null){gh={from:gh,to:null}}}}if(!gh.to){gh.to=gh.from}gh.margin=gi||0;if(gh.from.line!=null){fC(this);this.curOp.scrollToPos=gh}else{var gg=G(this,Math.min(gh.from.left,gh.to.left),Math.min(gh.from.top,gh.to.top)-gh.margin,Math.max(gh.from.right,gh.to.right),Math.max(gh.from.bottom,gh.to.bottom)+gh.margin);this.scrollTo(gg.scrollLeft,gg.scrollTop)}}),setSize:c8(function(gj,gh){var gg=this;function gi(gl){return typeof gl=="number"||/^\d+$/.test(String(gl))?gl+"px":gl}if(gj!=null){gg.display.wrapper.style.width=gi(gj)}if(gh!=null){gg.display.wrapper.style.height=gi(gh)}if(gg.options.lineWrapping){aO(this)}var gk=gg.display.viewFrom;gg.doc.iter(gk,gg.display.viewTo,function(gl){if(gl.widgets){for(var gm=0;gm<gl.widgets.length;gm++){if(gl.widgets[gm].noHScroll){R(gg,gk,"widget");break}}}++gk});gg.curOp.forceUpdate=true;aE(gg,"refresh",this)}),operation:function(gg){return cM(this,gg)},refresh:c8(function(){var gg=this.display.cachedTextHeight;ah(this);this.curOp.forceUpdate=true;ak(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);c4(this);if(gg==null||Math.abs(gg-aY(this.display))>0.5){X(this)}aE(this,"refresh",this)}),swapDoc:c8(function(gh){var gg=this.doc;gg.cm=null;eb(this,gh);ak(this);this.display.input.reset();this.scrollTo(gh.scrollLeft,gh.scrollTop);this.curOp.forceScroll=true;ae(this,"swapDoc",this,gg);return gg}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};by(H);var e3=H.defaults={};var bf=H.optionHandlers={};function s(gg,gj,gi,gh){H.defaults[gg]=gj;if(gi){bf[gg]=gh?function(gk,gm,gl){if(gl!=cc){gi(gk,gm,gl)}}:gi}}var cc=H.Init={toString:function(){return"CodeMirror.Init"}};s("value","",function(gg,gh){gg.setValue(gh)},true);s("mode",null,function(gg,gh){gg.doc.modeOption=gh;br(gg)},true);s("indentUnit",2,br,true);s("indentWithTabs",false);s("smartIndent",true);s("tabSize",4,function(gg){el(gg);ak(gg);ah(gg)},true);s("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(gg,gi,gh){gg.state.specialChars=new RegExp(gi.source+(gi.test("\t")?"":"|\t"),"g");if(gh!=H.Init){gg.refresh()}});s("specialCharPlaceholder",fc,function(gg){gg.refresh()},true);s("electricChars",true);s("inputStyle",eg?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},true);s("rtlMoveVisually",!aP);s("wholeLineUpdateBefore",true);s("theme","default",function(gg){cO(gg);dw(gg)},true);s("keyMap","default",function(gg,gk,gh){var gi=fW(gk);var gj=gh!=H.Init&&fW(gh);if(gj&&gj.detach){gj.detach(gg,gi)}if(gi.attach){gi.attach(gg,gj||null)}});s("extraKeys",null);s("lineWrapping",false,eG,true);s("gutters",[],function(gg){ce(gg.options);dw(gg)},true);s("fixedGutter",true,function(gg,gh){gg.display.gutters.style.left=gh?dX(gg.display)+"px":"0";gg.refresh()},true);s("coverGutterNextToScrollbar",false,function(gg){eY(gg)},true);s("scrollbarStyle","native",function(gg){aD(gg);eY(gg);gg.display.scrollbars.setScrollTop(gg.doc.scrollTop);gg.display.scrollbars.setScrollLeft(gg.doc.scrollLeft)},true);s("lineNumbers",false,function(gg){ce(gg.options);dw(gg)},true);s("firstLineNumber",1,dw,true);s("lineNumberFormatter",function(gg){return gg},dw,true);s("showCursorWhenSelecting",false,bC,true);s("resetSelectionOnContextMenu",true);s("lineWiseCopyCut",true);s("readOnly",false,function(gg,gh){if(gh=="nocursor"){aV(gg);gg.display.input.blur();gg.display.disabled=true}else{gg.display.disabled=false;if(!gh){gg.display.input.reset()}}});s("disableInput",false,function(gg,gh){if(!gh){gg.display.input.reset()}},true);s("dragDrop",true,fZ);s("cursorBlinkRate",530);s("cursorScrollMargin",0);s("cursorHeight",1,bC,true);s("singleCursorHeightPerLine",true,bC,true);s("workTime",100);s("workDelay",100);s("flattenSpans",true,el,true);s("addModeClass",false,el,true);s("pollInterval",100);s("undoDepth",200,function(gg,gh){gg.doc.history.undoDepth=gh});s("historyEventDelay",1250);s("viewportMargin",10,function(gg){gg.refresh()},true);s("maxHighlightLength",10000,el,true);s("moveInputWithCursor",true,function(gg,gh){if(!gh){gg.display.input.resetPosition()}});s("tabindex",null,function(gg,gh){gg.display.input.getField().tabIndex=gh||""});s("autofocus",null);var ds=H.modes={},aS=H.mimeModes={};H.defineMode=function(gg,gh){if(!H.defaults.mode&&gg!="null"){H.defaults.mode=gg}if(arguments.length>2){gh.dependencies=Array.prototype.slice.call(arguments,2)}ds[gg]=gh};H.defineMIME=function(gh,gg){aS[gh]=gg};H.resolveMode=function(gg){if(typeof gg=="string"&&aS.hasOwnProperty(gg)){gg=aS[gg]}else{if(gg&&typeof gg.name=="string"&&aS.hasOwnProperty(gg.name)){var gh=aS[gg.name];if(typeof gh=="string"){gh={name:gh}}gg=ck(gh,gg);gg.name=gh.name}else{if(typeof gg=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(gg)){return H.resolveMode("application/xml")}}}if(typeof gg=="string"){return{name:gg}}else{return gg||{name:"null"}}};H.getMode=function(gh,gg){var gg=H.resolveMode(gg);var gj=ds[gg.name];if(!gj){return H.getMode(gh,"text/plain")}var gk=gj(gh,gg);if(dp.hasOwnProperty(gg.name)){var gi=dp[gg.name];for(var gl in gi){if(!gi.hasOwnProperty(gl)){continue}if(gk.hasOwnProperty(gl)){gk["_"+gl]=gk[gl]}gk[gl]=gi[gl]}}gk.name=gg.name;if(gg.helperType){gk.helperType=gg.helperType}if(gg.modeProps){for(var gl in gg.modeProps){gk[gl]=gg.modeProps[gl]}}return gk};H.defineMode("null",function(){return{token:function(gg){gg.skipToEnd()}}});H.defineMIME("text/plain","null");var dp=H.modeExtensions={};H.extendMode=function(gi,gh){var gg=dp.hasOwnProperty(gi)?dp[gi]:(dp[gi]={});aN(gh,gg)};H.defineExtension=function(gg,gh){H.prototype[gg]=gh};H.defineDocExtension=function(gg,gh){at.prototype[gg]=gh};H.defineOption=s;var a9=[];H.defineInitHook=function(gg){a9.push(gg)};var fo=H.helpers={};H.registerHelper=function(gh,gg,gi){if(!fo.hasOwnProperty(gh)){fo[gh]=H[gh]={_global:[]}}fo[gh][gg]=gi};H.registerGlobalHelper=function(gi,gh,gg,gj){H.registerHelper(gi,gh,gj);fo[gi]._global.push({pred:gg,val:gj})};var b3=H.copyState=function(gj,gg){if(gg===true){return gg}if(gj.copyState){return gj.copyState(gg)}var gi={};for(var gk in gg){var gh=gg[gk];if(gh instanceof Array){gh=gh.concat([])}gi[gk]=gh}return gi};var b0=H.startState=function(gi,gh,gg){return gi.startState?gi.startState(gh,gg):true};H.innerMode=function(gi,gg){while(gi.innerMode){var gh=gi.innerMode(gg);if(!gh||gh.mode==gi){break}gg=gh.state;gi=gh.mode}return gh||{mode:gi,state:gg}};var eD=H.commands={selectAll:function(gg){gg.setSelection(W(gg.firstLine(),0),W(gg.lastLine()),Z)},singleSelection:function(gg){gg.setSelection(gg.getCursor("anchor"),gg.getCursor("head"),Z)},killLine:function(gg){eX(gg,function(gi){if(gi.empty()){var gh=ff(gg.doc,gi.head.line).text.length;if(gi.head.ch==gh&&gi.head.line<gg.lastLine()){return{from:gi.head,to:W(gi.head.line+1,0)}}else{return{from:gi.head,to:W(gi.head.line,gh)}}}else{return{from:gi.from(),to:gi.to()}}})},deleteLine:function(gg){eX(gg,function(gh){return{from:W(gh.from().line,0),to:fJ(gg.doc,W(gh.to().line+1,0))}})},delLineLeft:function(gg){eX(gg,function(gh){return{from:W(gh.from().line,0),to:gh.from()}})},delWrappedLineLeft:function(gg){eX(gg,function(gh){var gj=gg.charCoords(gh.head,"div").top+5;var gi=gg.coordsChar({left:0,top:gj},"div");return{from:gi,to:gh.from()}})},delWrappedLineRight:function(gg){eX(gg,function(gh){var gj=gg.charCoords(gh.head,"div").top+5;var gi=gg.coordsChar({left:gg.display.lineDiv.offsetWidth+100,top:gj},"div");return{from:gh.from(),to:gi}})},undo:function(gg){gg.undo()},redo:function(gg){gg.redo()},undoSelection:function(gg){gg.undoSelection()},redoSelection:function(gg){gg.redoSelection()},goDocStart:function(gg){gg.extendSelection(W(gg.firstLine(),0))},goDocEnd:function(gg){gg.extendSelection(W(gg.lastLine()))},goLineStart:function(gg){gg.extendSelectionsBy(function(gh){return bt(gg,gh.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(gg){gg.extendSelectionsBy(function(gh){return dI(gg,gh.head)},{origin:"+move",bias:1})},goLineEnd:function(gg){gg.extendSelectionsBy(function(gh){return dP(gg,gh.head.line)},{origin:"+move",bias:-1})},goLineRight:function(gg){gg.extendSelectionsBy(function(gh){var gi=gg.charCoords(gh.head,"div").top+5;return gg.coordsChar({left:gg.display.lineDiv.offsetWidth+100,top:gi},"div")},cW)},goLineLeft:function(gg){gg.extendSelectionsBy(function(gh){var gi=gg.charCoords(gh.head,"div").top+5;return gg.coordsChar({left:0,top:gi},"div")},cW)},goLineLeftSmart:function(gg){gg.extendSelectionsBy(function(gh){var gi=gg.charCoords(gh.head,"div").top+5;var gj=gg.coordsChar({left:0,top:gi},"div");if(gj.ch<gg.getLine(gj.line).search(/\S/)){return dI(gg,gh.head)}return gj},cW)},goLineUp:function(gg){gg.moveV(-1,"line")},goLineDown:function(gg){gg.moveV(1,"line")},goPageUp:function(gg){gg.moveV(-1,"page")},goPageDown:function(gg){gg.moveV(1,"page")},goCharLeft:function(gg){gg.moveH(-1,"char")},goCharRight:function(gg){gg.moveH(1,"char")},goColumnLeft:function(gg){gg.moveH(-1,"column")},goColumnRight:function(gg){gg.moveH(1,"column")},goWordLeft:function(gg){gg.moveH(-1,"word")},goGroupRight:function(gg){gg.moveH(1,"group")},goGroupLeft:function(gg){gg.moveH(-1,"group")},goWordRight:function(gg){gg.moveH(1,"word")},delCharBefore:function(gg){gg.deleteH(-1,"char")},delCharAfter:function(gg){gg.deleteH(1,"char")},delWordBefore:function(gg){gg.deleteH(-1,"word")},delWordAfter:function(gg){gg.deleteH(1,"word")},delGroupBefore:function(gg){gg.deleteH(-1,"group")},delGroupAfter:function(gg){gg.deleteH(1,"group")},indentAuto:function(gg){gg.indentSelection("smart")},indentMore:function(gg){gg.indentSelection("add")},indentLess:function(gg){gg.indentSelection("subtract")},insertTab:function(gg){gg.replaceSelection("\t")},insertSoftTab:function(gg){var gi=[],gh=gg.listSelections(),gl=gg.options.tabSize;for(var gk=0;gk<gh.length;gk++){var gm=gh[gk].from();var gj=bT(gg.getLine(gm.line),gm.ch,gl);gi.push(new Array(gl-gj%gl+1).join(" "))}gg.replaceSelections(gi)},defaultTab:function(gg){if(gg.somethingSelected()){gg.indentSelection("add")}else{gg.execCommand("insertTab")}},transposeChars:function(gg){cM(gg,function(){var gj=gg.listSelections(),gi=[];for(var gk=0;gk<gj.length;gk++){var gm=gj[gk].head,gh=ff(gg.doc,gm.line).text;if(gh){if(gm.ch==gh.length){gm=new W(gm.line,gm.ch-1)}if(gm.ch>0){gm=new W(gm.line,gm.ch+1);gg.replaceRange(gh.charAt(gm.ch-1)+gh.charAt(gm.ch-2),W(gm.line,gm.ch-2),gm,"+transpose")}else{if(gm.line>gg.doc.first){var gl=ff(gg.doc,gm.line-1).text;if(gl){gg.replaceRange(gh.charAt(0)+"\n"+gl.charAt(gl.length-1),W(gm.line-1,gl.length-1),W(gm.line,1),"+transpose")}}}}gi.push(new dY(gm,gm))}gg.setSelections(gi)})},newlineAndIndent:function(gg){cM(gg,function(){var gh=gg.listSelections().length;for(var gj=0;gj<gh;gj++){var gi=gg.listSelections()[gj];gg.replaceRange("\n",gi.anchor,gi.head,"+input");gg.indentLine(gi.from().line+1,null,true);fF(gg)}})},toggleOverwrite:function(gg){gg.toggleOverwrite()}};var fa=H.keyMap={};fa.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};fa.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};fa.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};fa.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};fa["default"]=b7?fa.macDefault:fa.pcDefault;function dt(gh){var gn=gh.split(/-(?!$)/),gh=gn[gn.length-1];var gm,gl,gg,gk;for(var gj=0;gj<gn.length-1;gj++){var gi=gn[gj];if(/^(cmd|meta|m)$/i.test(gi)){gk=true}else{if(/^a(lt)?$/i.test(gi)){gm=true}else{if(/^(c|ctrl|control)$/i.test(gi)){gl=true}else{if(/^s(hift)$/i.test(gi)){gg=true}else{throw new Error("Unrecognized modifier name: "+gi)}}}}}if(gm){gh="Alt-"+gh}if(gl){gh="Ctrl-"+gh}if(gk){gh="Cmd-"+gh}if(gg){gh="Shift-"+gh}return gh}H.normalizeKeyMap=function(gn){var gh={};for(var gm in gn){if(gn.hasOwnProperty(gm)){var go=gn[gm];if(/^(name|fallthrough|(de|at)tach)$/.test(gm)){continue}if(go=="..."){delete gn[gm];continue}var gp=bS(gm.split(" "),dt);for(var gl=0;gl<gp.length;gl++){var gj,gi;if(gl==gp.length-1){gi=gm;gj=go}else{gi=gp.slice(0,gl+1).join(" ");gj="..."}var gk=gh[gi];if(!gk){gh[gi]=gj}else{if(gk!=gj){throw new Error("Inconsistent bindings for "+gi)}}}delete gn[gm]}}for(var gg in gh){gn[gg]=gh[gg]}return gn};var i=H.lookupKey=function(gj,gm,gl,gi){gm=fW(gm);var gk=gm.call?gm.call(gj,gi):gm[gj];if(gk===false){return"nothing"}if(gk==="..."){return"multi"}if(gk!=null&&gl(gk)){return"handled"}if(gm.fallthrough){if(Object.prototype.toString.call(gm.fallthrough)!="[object Array]"){return i(gj,gm.fallthrough,gl,gi)}for(var gh=0;gh<gm.fallthrough.length;gh++){var gg=i(gj,gm.fallthrough[gh],gl,gi);if(gg){return gg}}}};var eC=H.isModifierKey=function(gh){var gg=typeof gh=="string"?gh:fg[gh.keyCode];return gg=="Ctrl"||gg=="Alt"||gg=="Shift"||gg=="Mod"};var fr=H.keyName=function(gh,gj){if(d3&&gh.keyCode==34&&gh["char"]){return false}var gi=fg[gh.keyCode],gg=gi;if(gg==null||gh.altGraphKey){return false}if(gh.altKey&&gi!="Alt"){gg="Alt-"+gg}if((bQ?gh.metaKey:gh.ctrlKey)&&gi!="Ctrl"){gg="Ctrl-"+gg}if((bQ?gh.ctrlKey:gh.metaKey)&&gi!="Cmd"){gg="Cmd-"+gg}if(!gj&&gh.shiftKey&&gi!="Shift"){gg="Shift-"+gg}return gg};function fW(gg){return typeof gg=="string"?fa[gg]:gg}H.fromTextArea=function(gn,go){go=go?aN(go):{};go.value=gn.value;if(!go.tabindex&&gn.tabIndex){go.tabindex=gn.tabIndex}if(!go.placeholder&&gn.placeholder){go.placeholder=gn.placeholder}if(go.autofocus==null){var gg=dO();go.autofocus=gg==gn||gn.getAttribute("autofocus")!=null&&gg==document.body}function gk(){gn.value=gm.getValue()}if(gn.form){bX(gn.form,"submit",gk);if(!go.leaveSubmitMethodAlone){var gh=gn.form,gl=gh.submit;try{var gj=gh.submit=function(){gk();gh.submit=gl;gh.submit();gh.submit=gj}}catch(gi){}}}go.finishInit=function(gp){gp.save=gk;gp.getTextArea=function(){return gn};gp.toTextArea=function(){gp.toTextArea=isNaN;gk();gn.parentNode.removeChild(gp.getWrapperElement());gn.style.display="";if(gn.form){ed(gn.form,"submit",gk);if(typeof gn.form.submit=="function"){gn.form.submit=gl}}}};gn.style.display="none";var gm=H(function(gp){gn.parentNode.insertBefore(gp,gn.nextSibling)},go);return gm};var eT=H.StringStream=function(gg,gh){this.pos=this.start=0;this.string=gg;this.tabSize=gh||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0};eT.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}},eat:function(gg){var gi=this.string.charAt(this.pos);if(typeof gg=="string"){var gh=gi==gg}else{var gh=gi&&(gg.test?gg.test(gi):gg(gi))}if(gh){++this.pos;return gi}},eatWhile:function(gg){var gh=this.pos;while(this.eat(gg)){}return this.pos>gh},eatSpace:function(){var gg=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos}return this.pos>gg},skipToEnd:function(){this.pos=this.string.length},skipTo:function(gg){var gh=this.string.indexOf(gg,this.pos);if(gh>-1){this.pos=gh;return true}},backUp:function(gg){this.pos-=gg},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=bT(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?bT(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return bT(this.string,null,this.tabSize)-(this.lineStart?bT(this.string,this.lineStart,this.tabSize):0)},match:function(gk,gh,gg){if(typeof gk=="string"){var gl=function(gm){return gg?gm.toLowerCase():gm};var gj=this.string.substr(this.pos,gk.length);if(gl(gj)==gl(gk)){if(gh!==false){this.pos+=gk.length}return true}}else{var gi=this.string.slice(this.pos).match(gk);if(gi&&gi.index>0){return null}if(gi&&gh!==false){this.pos+=gi[0].length}return gi}},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(gh,gg){this.lineStart+=gh;try{return gg()}finally{this.lineStart-=gh}}};var a6=0;var P=H.TextMarker=function(gh,gg){this.lines=[];this.type=gg;this.doc=gh;this.id=++a6};by(P);P.prototype.clear=function(){if(this.explicitlyCleared){return}var gn=this.doc.cm,gh=gn&&!gn.curOp;if(gh){cI(gn)}if(fi(this,"clear")){var go=this.find();if(go){ae(this,"clear",go.from,go.to)}}var gi=null,gl=null;for(var gj=0;gj<this.lines.length;++gj){var gp=this.lines[gj];var gm=e9(gp.markedSpans,this);if(gn&&!this.collapsed){R(gn,bN(gp),"text")}else{if(gn){if(gm.to!=null){gl=bN(gp)}if(gm.from!=null){gi=bN(gp)}}}gp.markedSpans=eH(gp.markedSpans,gm);if(gm.from==null&&this.collapsed&&!fw(this.doc,gp)&&gn){f4(gp,aY(gn.display))}}if(gn&&this.collapsed&&!gn.options.lineWrapping){for(var gj=0;gj<this.lines.length;++gj){var gg=y(this.lines[gj]),gk=en(gg);if(gk>gn.display.maxLineLength){gn.display.maxLine=gg;gn.display.maxLineLength=gk;gn.display.maxLineChanged=true}}}if(gi!=null&&gn&&this.collapsed){ah(gn,gi,gl+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(gn){ey(gn.doc)}}if(gn){ae(gn,"markerCleared",gn,this)}if(gh){am(gn)}if(this.parent){this.parent.clear()}};P.prototype.find=function(gj,gh){if(gj==null&&this.type=="bookmark"){gj=1}var gm,gl;for(var gi=0;gi<this.lines.length;++gi){var gg=this.lines[gi];var gk=e9(gg.markedSpans,this);if(gk.from!=null){gm=W(gh?gg:bN(gg),gk.from);if(gj==-1){return gm}}if(gk.to!=null){gl=W(gh?gg:bN(gg),gk.to);if(gj==1){return gl}}}return gm&&{from:gm,to:gl}};P.prototype.changed=function(){var gi=this.find(-1,true),gh=this,gg=this.doc.cm;if(!gi||!gg){return}cM(gg,function(){var gk=gi.line,gl=bN(gi.line);var gj=fb(gg,gl);if(gj){au(gj);gg.curOp.selectionChanged=gg.curOp.forceUpdate=true}gg.curOp.updateMaxLine=true;if(!fw(gh.doc,gk)&&gh.height!=null){var gn=gh.height;gh.height=null;var gm=cY(gh)-gn;if(gm){f4(gk,gk.height+gm)}}})};P.prototype.attachLine=function(gg){if(!this.lines.length&&this.doc.cm){var gh=this.doc.cm.curOp;if(!gh.maybeHiddenMarkers||dh(gh.maybeHiddenMarkers,this)==-1){(gh.maybeUnhiddenMarkers||(gh.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(gg)};P.prototype.detachLine=function(gg){this.lines.splice(dh(this.lines,gg),1);if(!this.lines.length&&this.doc.cm){var gh=this.doc.cm.curOp;(gh.maybeHiddenMarkers||(gh.maybeHiddenMarkers=[])).push(this)}};var a6=0;function eF(go,gm,gn,gq,gk){if(gq&&gq.shared){return O(go,gm,gn,gq,gk)}if(go.cm&&!go.cm.curOp){return c2(go.cm,eF)(go,gm,gn,gq,gk)}var gj=new P(go,gk),gp=cf(gm,gn);if(gq){aN(gq,gj,false)}if(gp>0||gp==0&&gj.clearWhenEmpty!==false){return gj}if(gj.replacedWith){gj.collapsed=true;gj.widgetNode=f1("span",[gj.replacedWith],"CodeMirror-widget");if(!gq.handleMouseEvents){gj.widgetNode.setAttribute("cm-ignore-events","true")}if(gq.insertLeft){gj.widgetNode.insertLeft=true}}if(gj.collapsed){if(z(go,gm.line,gm,gn,gj)||gm.line!=gn.line&&z(go,gn.line,gm,gn,gj)){throw new Error("Inserting collapsed marker partially overlapping an existing one")}a8=true}if(gj.addToHistory){fM(go,{from:gm,to:gn,origin:"markText"},go.sel,NaN)}var gh=gm.line,gl=go.cm,gg;go.iter(gh,gn.line+1,function(gr){if(gl&&gj.collapsed&&!gl.options.lineWrapping&&y(gr)==gl.display.maxLine){gg=true}if(gj.collapsed&&gh!=gm.line){f4(gr,0)}cd(gr,new ei(gj,gh==gm.line?gm.ch:null,gh==gn.line?gn.ch:null));++gh});if(gj.collapsed){go.iter(gm.line,gn.line+1,function(gr){if(fw(go,gr)){f4(gr,0)}})}if(gj.clearOnEnter){bX(gj,"beforeCursorEnter",function(){gj.clear()})}if(gj.readOnly){gb=true;if(go.history.done.length||go.history.undone.length){go.clearHistory()}}if(gj.collapsed){gj.id=++a6;gj.atomic=true}if(gl){if(gg){gl.curOp.updateMaxLine=true}if(gj.collapsed){ah(gl,gm.line,gn.line+1)}else{if(gj.className||gj.title||gj.startStyle||gj.endStyle||gj.css){for(var gi=gm.line;gi<=gn.line;gi++){R(gl,gi,"text")}}}if(gj.atomic){ey(gl.doc)}ae(gl,"markerAdded",gl,gj)}return gj}var x=H.SharedTextMarker=function(gi,gh){this.markers=gi;this.primary=gh;for(var gg=0;gg<gi.length;++gg){gi[gg].parent=this}};by(x);x.prototype.clear=function(){if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var gg=0;gg<this.markers.length;++gg){this.markers[gg].clear()}ae(this,"clear")};x.prototype.find=function(gh,gg){return this.primary.find(gh,gg)};function O(gk,gn,gm,gg,gi){gg=aN(gg);gg.shared=false;var gl=[eF(gk,gn,gm,gg,gi)],gh=gl[0];var gj=gg.widgetNode;d7(gk,function(gp){if(gj){gg.widgetNode=gj.cloneNode(true)}gl.push(eF(gp,fJ(gp,gn),fJ(gp,gm),gg,gi));for(var go=0;go<gp.linked.length;++go){if(gp.linked[go].isParent){return}}gh=fG(gl)});return new x(gl,gh)}function eP(gg){return gg.findMarks(W(gg.first,0),gg.clipPos(W(gg.lastLine())),function(gh){return gh.parent})}function dF(gl,gm){for(var gj=0;gj<gm.length;gj++){var gh=gm[gj],gn=gh.find();var gg=gl.clipPos(gn.from),gk=gl.clipPos(gn.to);if(cf(gg,gk)){var gi=eF(gl,gg,gk,gh.primary,gh.primary.type);gh.markers.push(gi);gi.parent=gh}}}function eo(gj){for(var gi=0;gi<gj.length;gi++){var gg=gj[gi],gl=[gg.primary.doc];d7(gg.primary.doc,function(gm){gl.push(gm)});for(var gh=0;gh<gg.markers.length;gh++){var gk=gg.markers[gh];if(dh(gl,gk.doc)==-1){gk.parent=null;gg.markers.splice(gh--,1)}}}}function ei(gg,gi,gh){this.marker=gg;this.from=gi;this.to=gh}function e9(gi,gg){if(gi){for(var gh=0;gh<gi.length;++gh){var gj=gi[gh];if(gj.marker==gg){return gj}}}}function eH(gh,gi){for(var gj,gg=0;gg<gh.length;++gg){if(gh[gg]!=gi){(gj||(gj=[])).push(gh[gg])}}return gj}function cd(gg,gh){gg.markedSpans=gg.markedSpans?gg.markedSpans.concat([gh]):[gh];gh.marker.attachLine(gg)}function aQ(gh,gi,gm){if(gh){for(var gk=0,gn;gk<gh.length;++gk){var go=gh[gk],gl=go.marker;var gg=go.from==null||(gl.inclusiveLeft?go.from<=gi:go.from<gi);if(gg||go.from==gi&&gl.type=="bookmark"&&(!gm||!go.marker.insertLeft)){var gj=go.to==null||(gl.inclusiveRight?go.to>=gi:go.to>gi);(gn||(gn=[])).push(new ei(gl,go.from,gj?null:go.to))}}}return gn}function aB(gh,gj,gm){if(gh){for(var gk=0,gn;gk<gh.length;++gk){var go=gh[gk],gl=go.marker;var gi=go.to==null||(gl.inclusiveRight?go.to>=gj:go.to>gj);if(gi||go.from==gj&&gl.type=="bookmark"&&(!gm||go.marker.insertLeft)){var gg=go.from==null||(gl.inclusiveLeft?go.from<=gj:go.from<gj);(gn||(gn=[])).push(new ei(gl,gg?null:go.from-gj,go.to==null?null:go.to-gj))}}}return gn}function ek(gs,gp){if(gp.full){return null}var go=b9(gs,gp.from.line)&&ff(gs,gp.from.line).markedSpans;var gv=b9(gs,gp.to.line)&&ff(gs,gp.to.line).markedSpans;if(!go&&!gv){return null}var gh=gp.from.ch,gk=gp.to.ch,gn=cf(gp.from,gp.to)==0;var gm=aQ(go,gh,gn);var gu=aB(gv,gk,gn);var gt=gp.text.length==1,gi=fG(gp.text).length+(gt?gh:0);if(gm){for(var gj=0;gj<gm.length;++gj){var gr=gm[gj];if(gr.to==null){var gw=e9(gu,gr.marker);if(!gw){gr.to=gh}else{if(gt){gr.to=gw.to==null?null:gw.to+gi}}}}}if(gu){for(var gj=0;gj<gu.length;++gj){var gr=gu[gj];if(gr.to!=null){gr.to+=gi}if(gr.from==null){var gw=e9(gm,gr.marker);if(!gw){gr.from=gi;if(gt){(gm||(gm=[])).push(gr)}}}else{gr.from+=gi;if(gt){(gm||(gm=[])).push(gr)}}}}if(gm){gm=q(gm)}if(gu&&gu!=gm){gu=q(gu)}var gl=[gm];if(!gt){var gq=gp.text.length-2,gg;if(gq>0&&gm){for(var gj=0;gj<gm.length;++gj){if(gm[gj].to==null){(gg||(gg=[])).push(new ei(gm[gj].marker,null,null))}}}for(var gj=0;gj<gq;++gj){gl.push(gg)}gl.push(gu)}return gl}function q(gh){for(var gg=0;gg<gh.length;++gg){var gi=gh[gg];if(gi.from!=null&&gi.from==gi.to&&gi.marker.clearWhenEmpty!==false){gh.splice(gg--,1)}}if(!gh.length){return null}return gh}function d9(go,gm){var gg=b4(go,gm);var gp=ek(go,gm);if(!gg){return gp}if(!gp){return gg}for(var gj=0;gj<gg.length;++gj){var gk=gg[gj],gl=gp[gj];if(gk&&gl){spans:for(var gi=0;gi<gl.length;++gi){var gn=gl[gi];for(var gh=0;gh<gk.length;++gh){if(gk[gh].marker==gn.marker){continue spans}}gk.push(gn)}}else{if(gl){gg[gj]=gl}}}return gg}function cH(gs,gq,gr){var gk=null;gs.iter(gq.line,gr.line+1,function(gt){if(gt.markedSpans){for(var gu=0;gu<gt.markedSpans.length;++gu){var gv=gt.markedSpans[gu].marker;if(gv.readOnly&&(!gk||dh(gk,gv)==-1)){(gk||(gk=[])).push(gv)}}}});if(!gk){return null}var gl=[{from:gq,to:gr}];for(var gm=0;gm<gk.length;++gm){var gn=gk[gm],gi=gn.find(0);for(var gj=0;gj<gl.length;++gj){var gh=gl[gj];if(cf(gh.to,gi.from)<0||cf(gh.from,gi.to)>0){continue}var gp=[gj,1],gg=cf(gh.from,gi.from),go=cf(gh.to,gi.to);if(gg<0||!gn.inclusiveLeft&&!gg){gp.push({from:gh.from,to:gi.from})}if(go>0||!gn.inclusiveRight&&!go){gp.push({from:gi.to,to:gh.to})}gl.splice.apply(gl,gp);gj+=gp.length-1}}return gl}function f7(gg){var gi=gg.markedSpans;if(!gi){return}for(var gh=0;gh<gi.length;++gh){gi[gh].marker.detachLine(gg)}gg.markedSpans=null}function c3(gg,gi){if(!gi){return}for(var gh=0;gh<gi.length;++gh){gi[gh].marker.attachLine(gg)}gg.markedSpans=gi}function v(gg){return gg.inclusiveLeft?-1:0}function bW(gg){return gg.inclusiveRight?1:0}function dQ(gj,gh){var gl=gj.lines.length-gh.lines.length;if(gl!=0){return gl}var gi=gj.find(),gm=gh.find();var gg=cf(gi.from,gm.from)||v(gj)-v(gh);if(gg){return -gg}var gk=cf(gi.to,gm.to)||bW(gj)-bW(gh);if(gk){return gk}return gh.id-gj.id}function a7(gh,gl){var gg=a8&&gh.markedSpans,gk;if(gg){for(var gj,gi=0;gi<gg.length;++gi){gj=gg[gi];if(gj.marker.collapsed&&(gl?gj.from:gj.to)==null&&(!gk||dQ(gk,gj.marker)<0)){gk=gj.marker}}}return gk}function eO(gg){return a7(gg,true)}function ew(gg){return a7(gg,false)}function z(go,gi,gm,gn,gk){var gr=ff(go,gi);var gg=a8&&gr.markedSpans;if(gg){for(var gj=0;gj<gg.length;++gj){var gh=gg[gj];if(!gh.marker.collapsed){continue}var gq=gh.marker.find(0);var gp=cf(gq.from,gm)||v(gh.marker)-v(gk);var gl=cf(gq.to,gn)||bW(gh.marker)-bW(gk);if(gp>=0&&gl<=0||gp<=0&&gl>=0){continue}if(gp<=0&&(cf(gq.to,gm)>0||(gh.marker.inclusiveRight&&gk.inclusiveLeft))||gp>=0&&(cf(gq.from,gn)<0||(gh.marker.inclusiveLeft&&gk.inclusiveRight))){return true}}}}function y(gh){var gg;while(gg=eO(gh)){gh=gg.find(-1,true).line}return gh}function h(gi){var gg,gh;while(gg=ew(gi)){gi=gg.find(1,true).line;(gh||(gh=[])).push(gi)}return gh}function aW(gj,gh){var gg=ff(gj,gh),gi=y(gg);if(gg==gi){return gh}return bN(gi)}function d2(gj,gi){if(gi>gj.lastLine()){return gi}var gh=ff(gj,gi),gg;if(!fw(gj,gh)){return gi}while(gg=ew(gh)){gh=gg.find(1,true).line}return bN(gh)+1}function fw(gk,gh){var gg=a8&&gh.markedSpans;if(gg){for(var gj,gi=0;gi<gg.length;++gi){gj=gg[gi];if(!gj.marker.collapsed){continue}if(gj.from==null){return true}if(gj.marker.widgetNode){continue}if(gj.from==0&&gj.marker.inclusiveLeft&&T(gk,gh,gj)){return true}}}}function T(gl,gh,gj){if(gj.to==null){var gg=gj.marker.find(1,true);return T(gl,gg.line,e9(gg.line.markedSpans,gj.marker))}if(gj.marker.inclusiveRight&&gj.to==gh.text.length){return true}for(var gk,gi=0;gi<gh.markedSpans.length;++gi){gk=gh.markedSpans[gi];if(gk.marker.collapsed&&!gk.marker.widgetNode&&gk.from==gj.to&&(gk.to==null||gk.to!=gj.from)&&(gk.marker.inclusiveLeft||gj.marker.inclusiveRight)&&T(gl,gh,gk)){return true}}}var dB=H.LineWidget=function(gj,gi,gg){if(gg){for(var gh in gg){if(gg.hasOwnProperty(gh)){this[gh]=gg[gh]}}}this.doc=gj;this.node=gi};by(dB);function dZ(gg,gh,gi){if(bM(gh)<((gg.curOp&&gg.curOp.scrollTop)||gg.doc.scrollTop)){cL(gg,null,gi)}}dB.prototype.clear=function(){var gh=this.doc.cm,gj=this.line.widgets,gi=this.line,gl=bN(gi);if(gl==null||!gj){return}for(var gk=0;gk<gj.length;++gk){if(gj[gk]==this){gj.splice(gk--,1)}}if(!gj.length){gi.widgets=null}var gg=cY(this);f4(gi,Math.max(0,gi.height-gg));if(gh){cM(gh,function(){dZ(gh,gi,-gg);R(gh,gl,"widget")})}};dB.prototype.changed=function(){var gh=this.height,gg=this.doc.cm,gi=this.line;this.height=null;var gj=cY(this)-gh;if(!gj){return}f4(gi,gi.height+gj);if(gg){cM(gg,function(){gg.curOp.forceUpdate=true;dZ(gg,gi,gj)})}};function cY(gi){if(gi.height!=null){return gi.height}var gg=gi.doc.cm;if(!gg){return 0}if(!f9(document.body,gi.node)){var gh="position: relative;";if(gi.coverGutter){gh+="margin-left: -"+gg.display.gutters.offsetWidth+"px;"}if(gi.noHScroll){gh+="width: "+gg.display.wrapper.clientWidth+"px;"}bR(gg.display.measure,f1("div",[gi.node],null,gh))}return gi.height=gi.node.offsetHeight}function bH(gl,gk,gi,gh){var gj=new dB(gl,gi,gh);var gg=gl.cm;if(gg&&gj.noHScroll){gg.display.alignWidgets=true}ez(gl,gk,"widget",function(gn){var go=gn.widgets||(gn.widgets=[]);if(gj.insertAt==null){go.push(gj)}else{go.splice(Math.min(go.length-1,Math.max(0,gj.insertAt)),0,gj)}gj.line=gn;if(gg&&!fw(gl,gn)){var gm=bM(gn)<gl.scrollTop;f4(gn,gn.height+cY(gj));if(gm){cL(gg,null,gj.height)}gg.curOp.forceUpdate=true}return true});return gj}var f5=H.Line=function(gi,gh,gg){this.text=gi;c3(this,gh);this.height=gg?gg(this):1};by(f5);f5.prototype.lineNo=function(){return bN(this)};function em(gh,gk,gi,gg){gh.text=gk;if(gh.stateAfter){gh.stateAfter=null}if(gh.styles){gh.styles=null}if(gh.order!=null){gh.order=null}f7(gh);c3(gh,gi);var gj=gg?gg(gh):1;if(gj!=gh.height){f4(gh,gj)}}function bB(gg){gg.parent=null;f7(gg)}function di(gi,gh){if(gi){for(;;){var gg=gi.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!gg){break}gi=gi.slice(0,gg.index)+gi.slice(gg.index+gg[0].length);var gj=gg[1]?"bgClass":"textClass";if(gh[gj]==null){gh[gj]=gg[2]}else{if(!(new RegExp("(?:^|s)"+gg[2]+"(?:$|s)")).test(gh[gj])){gh[gj]+=" "+gg[2]}}}}return gi}function fq(gi,gh){if(gi.blankLine){return gi.blankLine(gh)}if(!gi.innerMode){return}var gg=H.innerMode(gi,gh);if(gg.mode.blankLine){return gg.mode.blankLine(gg.state)}}function eA(gl,gk,gj,gg){for(var gh=0;gh<10;gh++){if(gg){gg[0]=H.innerMode(gl,gj).mode}var gi=gl.token(gk,gj);if(gk.pos>gk.start){return gi}}throw new Error("Mode "+gl.name+" failed to advance stream.")}function cq(gp,gn,gk,gj){function gg(gs){return{start:gq.start,end:gq.pos,string:gq.current(),type:gi||null,state:gs?b3(go.mode,gh):gh}}var go=gp.doc,gl=go.mode,gi;gn=fJ(go,gn);var gr=ff(go,gn.line),gh=dC(gp,gn.line,gk);var gq=new eT(gr.text,gp.options.tabSize),gm;if(gj){gm=[]}while((gj||gq.pos<gn.ch)&&!gq.eol()){gq.start=gq.pos;gi=eA(gl,gq,gh);if(gj){gm.push(gg(true))}}return gj?gm:gg()}function w(gq,gs,gl,gh,gm,gj,gk){var gi=gl.flattenSpans;if(gi==null){gi=gq.options.flattenSpans}var go=0,gn=null;var gr=new eT(gs,gq.options.tabSize),gg;var gu=gq.options.addModeClass&&[null];if(gs==""){di(fq(gl,gh),gj)}while(!gr.eol()){if(gr.pos>gq.options.maxHighlightLength){gi=false;if(gk){dx(gq,gs,gh,gr.pos)}gr.pos=gs.length;gg=null}else{gg=di(eA(gl,gr,gh,gu),gj)}if(gu){var gt=gu[0].name;if(gt){gg="m-"+(gg?gt+" "+gg:gt)}}if(!gi||gn!=gg){while(go<gr.start){go=Math.min(gr.start,go+50000);gm(go,gn)}gn=gg}gr.start=gr.pos}while(go<gr.pos){var gp=Math.min(gr.pos,go+50000);gm(gp,gn);go=gp}}function fz(gn,gp,gg,gk){var go=[gn.state.modeGen],gj={};w(gn,gp.text,gn.doc.mode,gg,function(gq,gr){go.push(gq,gr)},gj,gk);for(var gh=0;gh<gn.state.overlays.length;++gh){var gl=gn.state.overlays[gh],gm=1,gi=0;w(gn,gp.text,gl.mode,true,function(gq,gs){var gu=gm;while(gi<gq){var gr=go[gm];if(gr>gq){go.splice(gm,1,gq,go[gm+1],gr)}gm+=2;gi=Math.min(gq,gr)}if(!gs){return}if(gl.opaque){go.splice(gu,gm-gu,gq,"cm-overlay "+gs);gm=gu+2}else{for(;gu<gm;gu+=2){var gt=go[gu+1];go[gu+1]=(gt?gt+" ":"")+"cm-overlay "+gs}}},gj)}return{styles:go,classes:gj.bgClass||gj.textClass?gj:null}}function c6(gh,gi,gj){if(!gi.styles||gi.styles[0]!=gh.state.modeGen){var gg=fz(gh,gi,gi.stateAfter=dC(gh,bN(gi)));gi.styles=gg.styles;if(gg.classes){gi.styleClasses=gg.classes}else{if(gi.styleClasses){gi.styleClasses=null}}if(gj===gh.doc.frontier){gh.doc.frontier++}}return gi.styles}function dx(gg,gl,gi,gh){var gk=gg.doc.mode;var gj=new eT(gl,gg.options.tabSize);gj.start=gj.pos=gh||0;if(gl==""){fq(gk,gi)}while(!gj.eol()&&gj.pos<=gg.options.maxHighlightLength){eA(gk,gj,gi);gj.start=gj.pos}}var dW={},b1={};function eW(gi,gh){if(!gi||/^\s*$/.test(gi)){return null}var gg=gh.addModeClass?b1:dW;return gg[gi]||(gg[gi]=gi.replace(/\S+/g,"cm-$&"))}function eR(gh,gl){var gm=f1("span",null,null,c0?"padding-right: .1px":null);var gj={pre:f1("pre",[gm]),content:gm,col:0,pos:0,cm:gh,splitSpaces:(dK||c0)&&gh.getOption("lineWrapping")};gl.measure={};for(var gk=0;gk<=(gl.rest?gl.rest.length:0);gk++){var gi=gk?gl.rest[gk-1]:gl.line,gg;gj.pos=0;gj.addToken=t;if(bO(gh.display.measure)&&(gg=a(gi))){gj.addToken=U(gj.addToken,gg)}gj.map=[];var gn=gl!=gh.display.externalMeasured&&bN(gi);bo(gi,gj,c6(gh,gi,gn));if(gi.styleClasses){if(gi.styleClasses.bgClass){gj.bgClass=fS(gi.styleClasses.bgClass,gj.bgClass||"")}if(gi.styleClasses.textClass){gj.textClass=fS(gi.styleClasses.textClass,gj.textClass||"")}}if(gj.map.length==0){gj.map.push(0,0,gj.content.appendChild(bn(gh.display.measure)))}if(gk==0){gl.measure.map=gj.map;gl.measure.cache={}}else{(gl.measure.maps||(gl.measure.maps=[])).push(gj.map);(gl.measure.caches||(gl.measure.caches=[])).push({})}}if(c0&&/\bcm-tab\b/.test(gj.content.lastChild.className)){gj.content.className="cm-tab-wrap-hack"}aE(gh,"renderLine",gh,gl.line,gj.pre);if(gj.pre.className){gj.textClass=fS(gj.pre.className,gj.textClass||"")}return gj}function fc(gh){var gg=f1("span","\u2022","cm-invalidchar");gg.title="\\u"+gh.charCodeAt(0).toString(16);gg.setAttribute("aria-label",gg.title);return gg}function t(gr,gm,gw,gt,gp,gy,gl){if(!gm){return}var gv=gr.splitSpaces?gm.replace(/ {3,}/g,cF):gm;var gg=gr.cm.state.specialChars,gh=false;if(!gg.test(gm)){gr.col+=gm.length;var gu=document.createTextNode(gv);gr.map.push(gr.pos,gr.pos+gm.length,gu);if(dK&&k<9){gh=true}gr.pos+=gm.length}else{var gu=document.createDocumentFragment(),gj=0;while(true){gg.lastIndex=gj;var gs=gg.exec(gm);var gx=gs?gs.index-gj:gm.length-gj;if(gx){var go=document.createTextNode(gv.slice(gj,gj+gx));if(dK&&k<9){gu.appendChild(f1("span",[go]))}else{gu.appendChild(go)}gr.map.push(gr.pos,gr.pos+gx,go);gr.col+=gx;gr.pos+=gx}if(!gs){break}gj+=gx+1;if(gs[0]=="\t"){var gq=gr.cm.options.tabSize,gn=gq-gr.col%gq;var go=gu.appendChild(f1("span",cp(gn),"cm-tab"));go.setAttribute("role","presentation");go.setAttribute("cm-text","\t");gr.col+=gn}else{var go=gr.cm.options.specialCharPlaceholder(gs[0]);go.setAttribute("cm-text",gs[0]);if(dK&&k<9){gu.appendChild(f1("span",[go]))}else{gu.appendChild(go)}gr.col+=1}gr.map.push(gr.pos,gr.pos+1,go);gr.pos++}}if(gw||gt||gp||gh||gl){var gi=gw||"";if(gt){gi+=gt}if(gp){gi+=gp}var gk=f1("span",[gu],gi,gl);if(gy){gk.title=gy}return gr.content.appendChild(gk)}gr.content.appendChild(gu)}function cF(gg){var gh=" ";for(var gi=0;gi<gg.length-2;++gi){gh+=gi%2?" ":"\u00a0"}gh+=" ";return gh}function U(gh,gg){return function(gp,gr,gi,gm,gs,gq,go){gi=gi?gi+" cm-force-border":"cm-force-border";var gj=gp.pos,gl=gj+gr.length;for(;;){for(var gn=0;gn<gg.length;gn++){var gk=gg[gn];if(gk.to>gj&&gk.from<=gj){break}}if(gk.to>=gl){return gh(gp,gr,gi,gm,gs,gq,go)}gh(gp,gr.slice(0,gk.to-gj),gi,gm,null,gq,go);gm=null;gr=gr.slice(gk.to-gj);gj=gk.to}}}function ac(gh,gj,gg,gi){var gk=!gi&&gg.widgetNode;if(gk){gh.map.push(gh.pos,gh.pos+gj,gk)}if(!gi&&gh.cm.display.input.needsContentAttribute){if(!gk){gk=gh.content.appendChild(document.createElement("span"))}gk.setAttribute("cm-marker",gg.id)}if(gk){gh.cm.display.input.setUneditable(gk);gh.content.appendChild(gk)}gh.pos+=gj}function bo(gp,gw,go){var gl=gp.markedSpans,gn=gp.text,gu=0;if(!gl){for(var gz=1;gz<go.length;gz+=2){gw.addToken(gw,gn.slice(gu,gu=go[gz]),eW(go[gz+1],gw.cm.options))}return}var gA=gn.length,gk=0,gz=1,gs="",gB,gq;var gD=0,gg,gC,gt,gE,gi;for(;;){if(gD==gk){gg=gC=gt=gE=gq="";gi=null;gD=Infinity;var gm=[];for(var gx=0;gx<gl.length;++gx){var gy=gl[gx],gv=gy.marker;if(gv.type=="bookmark"&&gy.from==gk&&gv.widgetNode){gm.push(gv)}else{if(gy.from<=gk&&(gy.to==null||gy.to>gk||gv.collapsed&&gy.to==gk&&gy.from==gk)){if(gy.to!=null&&gy.to!=gk&&gD>gy.to){gD=gy.to;gC=""}if(gv.className){gg+=" "+gv.className}if(gv.css){gq=gv.css}if(gv.startStyle&&gy.from==gk){gt+=" "+gv.startStyle}if(gv.endStyle&&gy.to==gD){gC+=" "+gv.endStyle}if(gv.title&&!gE){gE=gv.title}if(gv.collapsed&&(!gi||dQ(gi.marker,gv)<0)){gi=gy}}else{if(gy.from>gk&&gD>gy.from){gD=gy.from}}}}if(gi&&(gi.from||0)==gk){ac(gw,(gi.to==null?gA+1:gi.to)-gk,gi.marker,gi.from==null);if(gi.to==null){return}if(gi.to==gk){gi=false}}if(!gi&&gm.length){for(var gx=0;gx<gm.length;++gx){ac(gw,0,gm[gx])}}}if(gk>=gA){break}var gr=Math.min(gA,gD);while(true){if(gs){var gh=gk+gs.length;if(!gi){var gj=gh>gr?gs.slice(0,gr-gk):gs;gw.addToken(gw,gj,gB?gB+gg:gg,gt,gk+gj.length==gD?gC:"",gE,gq)}if(gh>=gr){gs=gs.slice(gr-gk);gk=gr;break}gk=gh;gt=""}gs=gn.slice(gu,gu=go[gz++]);gB=eW(go[gz++],gw.cm.options)}}}function dS(gg,gh){return gh.from.ch==0&&gh.to.ch==0&&fG(gh.text)==""&&(!gg.cm||gg.cm.options.wholeLineUpdateBefore)}function fy(gt,go,gh,gk){function gu(gw){return gh?gh[gw]:null}function gi(gw,gy,gx){em(gw,gy,gx,gk);ae(gw,"change",gw,go)}function gg(gz,gx){for(var gy=gz,gw=[];gy<gx;++gy){gw.push(new f5(gv[gy],gu(gy),gk))}return gw}var gs=go.from,gr=go.to,gv=go.text;var gp=ff(gt,gs.line),gq=ff(gt,gr.line);var gn=fG(gv),gj=gu(gv.length-1),gm=gr.line-gs.line;if(go.full){gt.insert(0,gg(0,gv.length));gt.remove(gv.length,gt.size-gv.length)}else{if(dS(gt,go)){var gl=gg(0,gv.length-1);gi(gq,gq.text,gj);if(gm){gt.remove(gs.line,gm)}if(gl.length){gt.insert(gs.line,gl)}}else{if(gp==gq){if(gv.length==1){gi(gp,gp.text.slice(0,gs.ch)+gn+gp.text.slice(gr.ch),gj)}else{var gl=gg(1,gv.length-1);gl.push(new f5(gn+gp.text.slice(gr.ch),gj,gk));gi(gp,gp.text.slice(0,gs.ch)+gv[0],gu(0));gt.insert(gs.line+1,gl)}}else{if(gv.length==1){gi(gp,gp.text.slice(0,gs.ch)+gv[0]+gq.text.slice(gr.ch),gu(0));gt.remove(gs.line+1,gm)}else{gi(gp,gp.text.slice(0,gs.ch)+gv[0],gu(0));gi(gq,gn+gq.text.slice(gr.ch),gj);var gl=gg(1,gv.length-1);if(gm>1){gt.remove(gs.line+1,gm-1)}gt.insert(gs.line+1,gl)}}}}ae(gt,"change",gt,go)}function eZ(gh){this.lines=gh;this.parent=null;for(var gi=0,gg=0;gi<gh.length;++gi){gh[gi].parent=this;gg+=gh[gi].height}this.height=gg}eZ.prototype={chunkSize:function(){return this.lines.length},removeInner:function(gg,gk){for(var gi=gg,gj=gg+gk;gi<gj;++gi){var gh=this.lines[gi];this.height-=gh.height;bB(gh);ae(gh,"delete")}this.lines.splice(gg,gk)},collapse:function(gg){gg.push.apply(gg,this.lines)},insertInner:function(gh,gi,gg){this.height+=gg;this.lines=this.lines.slice(0,gh).concat(gi).concat(this.lines.slice(gh));for(var gj=0;gj<gi.length;++gj){gi[gj].parent=this}},iterN:function(gg,gj,gi){for(var gh=gg+gj;gg<gh;++gg){if(gi(this.lines[gg])){return true}}}};function fx(gj){this.children=gj;var gi=0,gg=0;for(var gh=0;gh<gj.length;++gh){var gk=gj[gh];gi+=gk.chunkSize();gg+=gk.height;gk.parent=this}this.size=gi;this.height=gg;this.parent=null}fx.prototype={chunkSize:function(){return this.size},removeInner:function(gg,gn){this.size-=gn;for(var gi=0;gi<this.children.length;++gi){var gm=this.children[gi],gk=gm.chunkSize();if(gg<gk){var gj=Math.min(gn,gk-gg),gl=gm.height;gm.removeInner(gg,gj);this.height-=gl-gm.height;if(gk==gj){this.children.splice(gi--,1);gm.parent=null}if((gn-=gj)==0){break}gg=0}else{gg-=gk}}if(this.size-gn<25&&(this.children.length>1||!(this.children[0] instanceof eZ))){var gh=[];this.collapse(gh);this.children=[new eZ(gh)];this.children[0].parent=this}},collapse:function(gg){for(var gh=0;gh<this.children.length;++gh){this.children[gh].collapse(gg)}},insertInner:function(gh,gi,gg){this.size+=gi.length;this.height+=gg;for(var gl=0;gl<this.children.length;++gl){var gn=this.children[gl],gm=gn.chunkSize();if(gh<=gm){gn.insertInner(gh,gi,gg);if(gn.lines&&gn.lines.length>50){while(gn.lines.length>50){var gk=gn.lines.splice(gn.lines.length-25,25);var gj=new eZ(gk);gn.height-=gj.height;this.children.splice(gl+1,0,gj);gj.parent=this}this.maybeSpill()}break}gh-=gm}},maybeSpill:function(){if(this.children.length<=10){return}var gj=this;do{var gh=gj.children.splice(gj.children.length-5,5);var gi=new fx(gh);if(!gj.parent){var gk=new fx(gj.children);gk.parent=gj;gj.children=[gk,gi];gj=gk}else{gj.size-=gi.size;gj.height-=gi.height;var gg=dh(gj.parent.children,gj);gj.parent.children.splice(gg+1,0,gi)}gi.parent=gj.parent}while(gj.children.length>10);gj.parent.maybeSpill()},iterN:function(gg,gm,gl){for(var gh=0;gh<this.children.length;++gh){var gk=this.children[gh],gj=gk.chunkSize();if(gg<gj){var gi=Math.min(gm,gj-gg);if(gk.iterN(gg,gi,gl)){return true}if((gm-=gi)==0){break}gg=0}else{gg-=gj}}}};var cr=0;var at=H.Doc=function(gi,gh,gg){if(!(this instanceof at)){return new at(gi,gh,gg)}if(gg==null){gg=0}fx.call(this,[new eZ([new f5("",null)])]);this.first=gg;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.frontier=gg;var gj=W(gg,0);this.sel=eS(gj);this.history=new fT(null);this.id=++cr;this.modeOption=gh;if(typeof gi=="string"){gi=a1(gi)}fy(this,{from:gj,to:gj,text:gi});bU(this,eS(gj),Z)};at.prototype=ck(fx.prototype,{constructor:at,iter:function(gi,gh,gg){if(gg){this.iterN(gi-this.first,gh-gi,gg)}else{this.iterN(this.first,this.first+this.size,gi)}},insert:function(gh,gi){var gg=0;for(var gj=0;gj<gi.length;++gj){gg+=gi[gj].height}this.insertInner(gh-this.first,gi,gg)},remove:function(gg,gh){this.removeInner(gg-this.first,gh)},getValue:function(gh){var gg=a3(this,this.first,this.first+this.size);if(gh===false){return gg}return gg.join(gh||"\n")},setValue:cD(function(gh){var gi=W(this.first,0),gg=this.first+this.size-1;bg(this,{from:gi,to:W(gg,ff(this,gg).text.length),text:a1(gh),origin:"setValue",full:true},true);bU(this,eS(gi))}),replaceRange:function(gh,gj,gi,gg){gj=fJ(this,gj);gi=gi?fJ(this,gi):gj;a2(this,gh,gj,gi,gg)},getRange:function(gj,gi,gh){var gg=f3(this,fJ(this,gj),fJ(this,gi));if(gh===false){return gg}return gg.join(gh||"\n")},getLine:function(gh){var gg=this.getLineHandle(gh);return gg&&gg.text},getLineHandle:function(gg){if(b9(this,gg)){return ff(this,gg)}},getLineNumber:function(gg){return bN(gg)},getLineHandleVisualStart:function(gg){if(typeof gg=="number"){gg=ff(this,gg)}return y(gg)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(gg){return fJ(this,gg)},getCursor:function(gi){var gg=this.sel.primary(),gh;if(gi==null||gi=="head"){gh=gg.head}else{if(gi=="anchor"){gh=gg.anchor}else{if(gi=="end"||gi=="to"||gi===false){gh=gg.to()}else{gh=gg.from()}}}return gh},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:cD(function(gg,gi,gh){F(this,fJ(this,typeof gg=="number"?W(gg,gi||0):gg),null,gh)}),setSelection:cD(function(gh,gi,gg){F(this,fJ(this,gh),fJ(this,gi||gh),gg)}),extendSelection:cD(function(gi,gg,gh){fV(this,fJ(this,gi),gg&&fJ(this,gg),gh)}),extendSelections:cD(function(gh,gg){aw(this,d0(this,gh,gg))}),extendSelectionsBy:cD(function(gh,gg){aw(this,bS(this.sel.ranges,gh),gg)}),setSelections:cD(function(gg,gk,gi){if(!gg.length){return}for(var gj=0,gh=[];gj<gg.length;gj++){gh[gj]=new dY(fJ(this,gg[gj].anchor),fJ(this,gg[gj].head))}if(gk==null){gk=Math.min(gg.length-1,this.sel.primIndex)}bU(this,cw(gh,gk),gi)}),addSelection:cD(function(gi,gj,gh){var gg=this.sel.ranges.slice(0);gg.push(new dY(fJ(this,gi),fJ(this,gj||gi)));bU(this,cw(gg,gg.length-1),gh)}),getSelection:function(gk){var gh=this.sel.ranges,gg;for(var gi=0;gi<gh.length;gi++){var gj=f3(this,gh[gi].from(),gh[gi].to());gg=gg?gg.concat(gj):gj}if(gk===false){return gg}else{return gg.join(gk||"\n")}},getSelections:function(gk){var gj=[],gg=this.sel.ranges;for(var gh=0;gh<gg.length;gh++){var gi=f3(this,gg[gh].from(),gg[gh].to());if(gk!==false){gi=gi.join(gk||"\n")}gj[gh]=gi}return gj},replaceSelection:function(gi,gk,gg){var gj=[];for(var gh=0;gh<this.sel.ranges.length;gh++){gj[gh]=gi}this.replaceSelections(gj,gk,gg||"+input")},replaceSelections:cD(function(gl,gn,gi){var gk=[],gm=this.sel;for(var gj=0;gj<gm.ranges.length;gj++){var gh=gm.ranges[gj];gk[gj]={from:gh.from(),to:gh.to(),text:a1(gl[gj]),origin:gi}}var gg=gn&&gn!="end"&&af(this,gk,gn);for(var gj=gk.length-1;gj>=0;gj--){bg(this,gk[gj])}if(gg){e7(this,gg)}else{if(this.cm){fF(this.cm)}}}),undo:cD(function(){b8(this,"undo")}),redo:cD(function(){b8(this,"redo")}),undoSelection:cD(function(){b8(this,"undo",true)}),redoSelection:cD(function(){b8(this,"redo",true)}),setExtending:function(gg){this.extend=gg},getExtending:function(){return this.extend},historySize:function(){var gj=this.history,gg=0,gi=0;for(var gh=0;gh<gj.done.length;gh++){if(!gj.done[gh].ranges){++gg}}for(var gh=0;gh<gj.undone.length;gh++){if(!gj.undone[gh].ranges){++gi}}return{undo:gg,redo:gi}},clearHistory:function(){this.history=new fT(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(gg){if(gg){this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null}return this.history.generation},isClean:function(gg){return this.history.generation==(gg||this.cleanGeneration)},getHistory:function(){return{done:bP(this.history.done),undone:bP(this.history.undone)}},setHistory:function(gh){var gg=this.history=new fT(this.history.maxGeneration);gg.done=bP(gh.done.slice(0),null,true);gg.undone=bP(gh.undone.slice(0),null,true)},addLineClass:cD(function(gi,gh,gg){return ez(this,gi,gh=="gutter"?"gutter":"class",function(gj){var gk=gh=="text"?"textClass":gh=="background"?"bgClass":gh=="gutter"?"gutterClass":"wrapClass";if(!gj[gk]){gj[gk]=gg}else{if(S(gg).test(gj[gk])){return false}else{gj[gk]+=" "+gg}}return true})}),removeLineClass:cD(function(gi,gh,gg){return ez(this,gi,gh=="gutter"?"gutter":"class",function(gk){var gn=gh=="text"?"textClass":gh=="background"?"bgClass":gh=="gutter"?"gutterClass":"wrapClass";var gm=gk[gn];if(!gm){return false}else{if(gg==null){gk[gn]=null}else{var gl=gm.match(S(gg));if(!gl){return false}var gj=gl.index+gl[0].length;gk[gn]=gm.slice(0,gl.index)+(!gl.index||gj==gm.length?"":" ")+gm.slice(gj)||null}}return true})}),addLineWidget:cD(function(gi,gh,gg){return bH(this,gi,gh,gg)}),removeLineWidget:function(gg){gg.clear()},markText:function(gi,gh,gg){return eF(this,fJ(this,gi),fJ(this,gh),gg,"range")},setBookmark:function(gi,gg){var gh={replacedWith:gg&&(gg.nodeType==null?gg.widget:gg),insertLeft:gg&&gg.insertLeft,clearWhenEmpty:false,shared:gg&&gg.shared,handleMouseEvents:gg&&gg.handleMouseEvents};gi=fJ(this,gi);return eF(this,gi,gi,gh,"bookmark")},findMarksAt:function(gk){gk=fJ(this,gk);var gj=[],gh=ff(this,gk.line).markedSpans;if(gh){for(var gg=0;gg<gh.length;++gg){var gi=gh[gg];if((gi.from==null||gi.from<=gk.ch)&&(gi.to==null||gi.to>=gk.ch)){gj.push(gi.marker.parent||gi.marker)}}}return gj},findMarks:function(gk,gj,gg){gk=fJ(this,gk);gj=fJ(this,gj);var gh=[],gi=gk.line;this.iter(gk.line,gj.line+1,function(gl){var gn=gl.markedSpans;if(gn){for(var gm=0;gm<gn.length;gm++){var go=gn[gm];if(!(gi==gk.line&&gk.ch>go.to||go.from==null&&gi!=gk.line||gi==gj.line&&go.from>gj.ch)&&(!gg||gg(go.marker))){gh.push(go.marker.parent||go.marker)}}}++gi});return gh},getAllMarks:function(){var gg=[];this.iter(function(gi){var gh=gi.markedSpans;if(gh){for(var gj=0;gj<gh.length;++gj){if(gh[gj].from!=null){gg.push(gh[gj].marker)}}}});return gg},posFromIndex:function(gh){var gg,gi=this.first;this.iter(function(gj){var gk=gj.text.length+1;if(gk>gh){gg=gh;return true}gh-=gk;++gi});return fJ(this,W(gi,gg))},indexFromPos:function(gh){gh=fJ(this,gh);var gg=gh.ch;if(gh.line<this.first||gh.ch<0){return 0}this.iter(this.first,gh.line,function(gi){gg+=gi.text.length+1});return gg},copy:function(gg){var gh=new at(a3(this,this.first,this.first+this.size),this.modeOption,this.first);gh.scrollTop=this.scrollTop;gh.scrollLeft=this.scrollLeft;gh.sel=this.sel;gh.extend=false;if(gg){gh.history.undoDepth=this.history.undoDepth;gh.setHistory(this.getHistory())}return gh},linkedDoc:function(gg){if(!gg){gg={}}var gj=this.first,gi=this.first+this.size;if(gg.from!=null&&gg.from>gj){gj=gg.from}if(gg.to!=null&&gg.to<gi){gi=gg.to}var gh=new at(a3(this,gj,gi),gg.mode||this.modeOption,gj);if(gg.sharedHist){gh.history=this.history}(this.linked||(this.linked=[])).push({doc:gh,sharedHist:gg.sharedHist});gh.linked=[{doc:this,isParent:true,sharedHist:gg.sharedHist}];dF(gh,eP(this));return gh},unlinkDoc:function(gh){if(gh instanceof H){gh=gh.doc}if(this.linked){for(var gi=0;gi<this.linked.length;++gi){var gj=this.linked[gi];if(gj.doc!=gh){continue}this.linked.splice(gi,1);gh.unlinkDoc(this);eo(eP(this));break}}if(gh.history==this.history){var gg=[gh.id];d7(gh,function(gk){gg.push(gk.id)},true);gh.history=new fT(null);gh.history.done=bP(this.history.done,gg);gh.history.undone=bP(this.history.undone,gg)}},iterLinkedDocs:function(gg){d7(this,gg)},getMode:function(){return this.mode},getEditor:function(){return this.cm}});at.prototype.eachLine=at.prototype.iter;var d="iter insert remove copy getEditor".split(" ");for(var bK in at.prototype){if(at.prototype.hasOwnProperty(bK)&&dh(d,bK)<0){H.prototype[bK]=(function(gg){return function(){return gg.apply(this.doc,arguments)}})(at.prototype[bK])}}by(at);function d7(gj,gi,gh){function gg(gp,gn,gl){if(gp.linked){for(var gm=0;gm<gp.linked.length;++gm){var gk=gp.linked[gm];if(gk.doc==gn){continue}var go=gl&&gk.sharedHist;if(gh&&!go){continue}gi(gk.doc,go);gg(gk.doc,gp,go)}}}gg(gj,null,true)}function eb(gg,gh){if(gh.cm){throw new Error("This document is already in use.")}gg.doc=gh;gh.cm=gg;X(gg);br(gg);if(!gg.options.lineWrapping){g(gg)}gg.options.mode=gh.modeOption;ah(gg)}function ff(gj,gl){gl-=gj.first;if(gl<0||gl>=gj.size){throw new Error("There is no line "+(gl+gj.first)+" in the document.")}for(var gg=gj;!gg.lines;){for(var gh=0;;++gh){var gk=gg.children[gh],gi=gk.chunkSize();if(gl<gi){gg=gk;break}gl-=gi}}return gg.lines[gl]}function f3(gi,gk,gg){var gh=[],gj=gk.line;gi.iter(gk.line,gg.line+1,function(gl){var gm=gl.text;if(gj==gg.line){gm=gm.slice(0,gg.ch)}if(gj==gk.line){gm=gm.slice(gk.ch)}gh.push(gm);++gj});return gh}function a3(gh,gj,gi){var gg=[];gh.iter(gj,gi,function(gk){gg.push(gk.text)});return gg}function f4(gh,gg){var gi=gg-gh.height;if(gi){for(var gj=gh;gj;gj=gj.parent){gj.height+=gi}}}function bN(gg){if(gg.parent==null){return null}var gk=gg.parent,gj=dh(gk.lines,gg);for(var gh=gk.parent;gh;gk=gh,gh=gh.parent){for(var gi=0;;++gi){if(gh.children[gi]==gk){break}gj+=gh.children[gi].chunkSize()}}return gj+gk.first}function bG(gi,gl){var gn=gi.first;outer:do{for(var gj=0;gj<gi.children.length;++gj){var gm=gi.children[gj],gk=gm.height;if(gl<gk){gi=gm;continue outer}gl-=gk;gn+=gm.chunkSize()}return gn}while(!gi.lines);for(var gj=0;gj<gi.lines.length;++gj){var gh=gi.lines[gj],gg=gh.height;if(gl<gg){break}gl-=gg}return gn+gj}function bM(gi){gi=y(gi);var gk=0,gh=gi.parent;for(var gj=0;gj<gh.lines.length;++gj){var gg=gh.lines[gj];if(gg==gi){break}else{gk+=gg.height}}for(var gl=gh.parent;gl;gh=gl,gl=gh.parent){for(var gj=0;gj<gl.children.length;++gj){var gm=gl.children[gj];if(gm==gh){break}else{gk+=gm.height}}}return gk}function a(gh){var gg=gh.order;if(gg==null){gg=gh.order=bh(gh.text)}return gg}function fT(gg){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=gg||1}function du(gg,gi){var gh={from:ci(gi.from),to:cX(gi),text:f3(gg,gi.from,gi.to)};bY(gg,gh,gi.from.line,gi.to.line+1);d7(gg,function(gj){bY(gj,gh,gi.from.line,gi.to.line+1)},true);return gh}function fB(gh){while(gh.length){var gg=fG(gh);if(gg.ranges){gh.pop()}else{break}}}function eM(gh,gg){if(gg){fB(gh.done);return fG(gh.done)}else{if(gh.done.length&&!fG(gh.done).ranges){return fG(gh.done)}else{if(gh.done.length>1&&!gh.done[gh.done.length-2].ranges){gh.done.pop();return fG(gh.done)}}}}function fM(gm,gk,gg,gj){var gi=gm.history;gi.undone.length=0;var gh=+new Date,gn;if((gi.lastOp==gj||gi.lastOrigin==gk.origin&&gk.origin&&((gk.origin.charAt(0)=="+"&&gm.cm&&gi.lastModTime>gh-gm.cm.options.historyEventDelay)||gk.origin.charAt(0)=="*"))&&(gn=eM(gi,gi.lastOp==gj))){var go=fG(gn.changes);if(cf(gk.from,gk.to)==0&&cf(gk.from,go.to)==0){go.to=cX(gk)}else{gn.changes.push(du(gm,gk))}}else{var gl=fG(gi.done);if(!gl||!gl.ranges){cN(gm.sel,gi.done)}gn={changes:[du(gm,gk)],generation:gi.generation};gi.done.push(gn);while(gi.done.length>gi.undoDepth){gi.done.shift();if(!gi.done[0].ranges){gi.done.shift()}}}gi.done.push(gg);gi.generation=++gi.maxGeneration;gi.lastModTime=gi.lastSelTime=gh;gi.lastOp=gi.lastSelOp=gj;gi.lastOrigin=gi.lastSelOrigin=gk.origin;if(!go){aE(gm,"historyAdded")}}function bA(gk,gg,gi,gj){var gh=gg.charAt(0);return gh=="*"||gh=="+"&&gi.ranges.length==gj.ranges.length&&gi.somethingSelected()==gj.somethingSelected()&&new Date-gk.history.lastSelTime<=(gk.cm?gk.cm.options.historyEventDelay:500)}function ga(gl,gj,gg,gi){var gk=gl.history,gh=gi&&gi.origin;if(gg==gk.lastSelOp||(gh&&gk.lastSelOrigin==gh&&(gk.lastModTime==gk.lastSelTime&&gk.lastOrigin==gh||bA(gl,gh,fG(gk.done),gj)))){gk.done[gk.done.length-1]=gj}else{cN(gj,gk.done)}gk.lastSelTime=+new Date;gk.lastSelOrigin=gh;gk.lastSelOp=gg;if(gi&&gi.clearRedo!==false){fB(gk.undone)}}function cN(gh,gg){var gi=fG(gg);if(!(gi&&gi.ranges&&gi.equals(gh))){gg.push(gh)}}function bY(gh,gl,gk,gj){var gg=gl["spans_"+gh.id],gi=0;gh.iter(Math.max(gh.first,gk),Math.min(gh.first+gh.size,gj),function(gm){if(gm.markedSpans){(gg||(gg=gl["spans_"+gh.id]={}))[gi]=gm.markedSpans}++gi})}function bl(gi){if(!gi){return null}for(var gh=0,gg;gh<gi.length;++gh){if(gi[gh].marker.explicitlyCleared){if(!gg){gg=gi.slice(0,gh)}}else{if(gg){gg.push(gi[gh])}}}return !gg?gi:gg.length?gg:null}function b4(gj,gk){var gi=gk["spans_"+gj.id];if(!gi){return null}for(var gh=0,gg=[];gh<gk.text.length;++gh){gg.push(bl(gi[gh]))}return gg}function bP(gr,gj,gq){for(var gm=0,gh=[];gm<gr.length;++gm){var gi=gr[gm];if(gi.ranges){gh.push(gq?f2.prototype.deepCopy.call(gi):gi);continue}var go=gi.changes,gp=[];gh.push({changes:gp});for(var gl=0;gl<go.length;++gl){var gn=go[gl],gk;gp.push({from:gn.from,to:gn.to,text:gn.text});if(gj){for(var gg in gn){if(gk=gg.match(/^spans_(\d+)$/)){if(dh(gj,Number(gk[1]))>-1){fG(gp)[gg]=gn[gg];delete gn[gg]}}}}}}return gh}function I(gj,gi,gh,gg){if(gh<gj.line){gj.line+=gg}else{if(gi<gj.line){gj.line=gi;gj.ch=0}}}function fh(gj,gl,gm,gn){for(var gi=0;gi<gj.length;++gi){var gg=gj[gi],gk=true;if(gg.ranges){if(!gg.copied){gg=gj[gi]=gg.deepCopy();gg.copied=true}for(var gh=0;gh<gg.ranges.length;gh++){I(gg.ranges[gh].anchor,gl,gm,gn);I(gg.ranges[gh].head,gl,gm,gn)}continue}for(var gh=0;gh<gg.changes.length;++gh){var go=gg.changes[gh];if(gm<go.from.line){go.from=W(go.from.line+gn,go.from.ch);go.to=W(go.to.line+gn,go.to.ch)}else{if(gl<=go.to.line){gk=false;break}}}if(!gk){gj.splice(0,gi+1);gi=0}}}function dE(gh,gk){var gj=gk.from.line,gi=gk.to.line,gg=gk.text.length-(gi-gj)-1;fh(gh.done,gj,gi,gg);fh(gh.undone,gj,gi,gg)}var cG=H.e_preventDefault=function(gg){if(gg.preventDefault){gg.preventDefault()}else{gg.returnValue=false}};var dq=H.e_stopPropagation=function(gg){if(gg.stopPropagation){gg.stopPropagation()}else{gg.cancelBubble=true}};function bL(gg){return gg.defaultPrevented!=null?gg.defaultPrevented:gg.returnValue==false}var er=H.e_stop=function(gg){cG(gg);dq(gg)};function L(gg){return gg.target||gg.srcElement}function fN(gh){var gg=gh.which;if(gg==null){if(gh.button&1){gg=1}else{if(gh.button&2){gg=3}else{if(gh.button&4){gg=2}}}}if(b7&&gh.ctrlKey&&gg==1){gg=3}return gg}var bX=H.on=function(gj,gh,gi){if(gj.addEventListener){gj.addEventListener(gh,gi,false)}else{if(gj.attachEvent){gj.attachEvent("on"+gh,gi)}else{var gk=gj._handlers||(gj._handlers={});var gg=gk[gh]||(gk[gh]=[]);gg.push(gi)}}};var ed=H.off=function(gk,gi,gj){if(gk.removeEventListener){gk.removeEventListener(gi,gj,false)}else{if(gk.detachEvent){gk.detachEvent("on"+gi,gj)}else{var gg=gk._handlers&&gk._handlers[gi];if(!gg){return}for(var gh=0;gh<gg.length;++gh){if(gg[gh]==gj){gg.splice(gh,1);break}}}}};var aE=H.signal=function(gk,gj){var gg=gk._handlers&&gk._handlers[gj];if(!gg){return}var gh=Array.prototype.slice.call(arguments,2);for(var gi=0;gi<gg.length;++gi){gg[gi].apply(null,gh)}};var bz=null;function ae(gm,gk){var gg=gm._handlers&&gm._handlers[gk];if(!gg){return}var gi=Array.prototype.slice.call(arguments,2),gl;if(bp){gl=bp.delayedCallbacks}else{if(bz){gl=bz}else{gl=bz=[];setTimeout(aM,0)}}function gh(gn){return function(){gn.apply(null,gi)}}for(var gj=0;gj<gg.length;++gj){gl.push(gh(gg[gj]))}}function aM(){var gg=bz;bz=null;for(var gh=0;gh<gg.length;++gh){gg[gh]()}}function aR(gg,gi,gh){if(typeof gi=="string"){gi={type:gi,preventDefault:function(){this.defaultPrevented=true}}}aE(gg,gh||gi.type,gg,gi);return bL(gi)||gi.codemirrorIgnore}function V(gh){var gg=gh._handlers&&gh._handlers.cursorActivity;if(!gg){return}var gj=gh.curOp.cursorActivityHandlers||(gh.curOp.cursorActivityHandlers=[]);for(var gi=0;gi<gg.length;++gi){if(dh(gj,gg[gi])==-1){gj.push(gg[gi])}}}function fi(gi,gh){var gg=gi._handlers&&gi._handlers[gh];return gg&&gg.length>0}function by(gg){gg.prototype.on=function(gh,gi){bX(this,gh,gi)};gg.prototype.off=function(gh,gi){ed(this,gh,gi)}}var dJ=30;var ca=H.Pass={toString:function(){return"CodeMirror.Pass"}};var Z={scroll:false},M={origin:"*mouse"},cW={origin:"+move"};function gf(){this.id=null}gf.prototype.set=function(gg,gh){clearTimeout(this.id);this.id=setTimeout(gh,gg)};var bT=H.countColumn=function(gj,gh,gl,gm,gi){if(gh==null){gh=gj.search(/[^\s\u00a0]/);if(gh==-1){gh=gj.length}}for(var gk=gm||0,gn=gi||0;;){var gg=gj.indexOf("\t",gk);if(gg<0||gg>=gh){return gn+(gh-gk)}gn+=gg-gk;gn+=gl-(gn%gl);gk=gg+1}};function eq(gk,gj,gl){for(var gm=0,gi=0;;){var gh=gk.indexOf("\t",gm);if(gh==-1){gh=gk.length}var gg=gh-gm;if(gh==gk.length||gi+gg>=gj){return gm+Math.min(gg,gj-gi)}gi+=gh-gm;gi+=gl-(gi%gl);gm=gh+1;if(gi>=gj){return gm}}}var a0=[""];function cp(gg){while(a0.length<=gg){a0.push(fG(a0)+" ")}return a0[gg]}function fG(gg){return gg[gg.length-1]}var dL=function(gg){gg.select()};if(e1){dL=function(gg){gg.selectionStart=0;gg.selectionEnd=gg.value.length}}else{if(dK){dL=function(gh){try{gh.select()}catch(gg){}}}}function dh(gi,gg){for(var gh=0;gh<gi.length;++gh){if(gi[gh]==gg){return gh}}return -1}function bS(gj,gi){var gg=[];for(var gh=0;gh<gj.length;gh++){gg[gh]=gi(gj[gh],gh)}return gg}function fU(){}function ck(gi,gg){var gh;if(Object.create){gh=Object.create(gi)}else{fU.prototype=gi;gh=new fU()}if(gg){aN(gg,gh)}return gh}function aN(gi,gh,gg){if(!gh){gh={}}for(var gj in gi){if(gi.hasOwnProperty(gj)&&(gg!==false||!gh.hasOwnProperty(gj))){gh[gj]=gi[gj]}}return gh}function cv(gh){var gg=Array.prototype.slice.call(arguments,1);return function(){return gh.apply(null,gg)}}var bc=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;var fD=H.isWordChar=function(gg){return/\w/.test(gg)||gg>"\x80"&&(gg.toUpperCase()!=gg.toLowerCase()||bc.test(gg))};function cA(gg,gh){if(!gh){return fD(gg)}if(gh.source.indexOf("\\w")>-1&&fD(gg)){return true}return gh.test(gg)}function eU(gg){for(var gh in gg){if(gg.hasOwnProperty(gh)&&gg[gh]){return false}}return true}var eJ=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function fp(gg){return gg.charCodeAt(0)>=768&&eJ.test(gg)}function f1(gg,gk,gj,gi){var gl=document.createElement(gg);if(gj){gl.className=gj}if(gi){gl.style.cssText=gi}if(typeof gk=="string"){gl.appendChild(document.createTextNode(gk))}else{if(gk){for(var gh=0;gh<gk.length;++gh){gl.appendChild(gk[gh])}}}return gl}var cl;if(document.createRange){cl=function(gj,gk,gh,gg){var gi=document.createRange();gi.setEnd(gg||gj,gh);gi.setStart(gj,gk);return gi}}else{cl=function(gi,gk,gg){var gh=document.body.createTextRange();try{gh.moveToElementText(gi.parentNode)}catch(gj){return gh}gh.collapse(true);gh.moveEnd("character",gg);gh.moveStart("character",gk);return gh}}function d1(gh){for(var gg=gh.childNodes.length;gg>0;--gg){gh.removeChild(gh.firstChild)}return gh}function bR(gg,gh){return d1(gg).appendChild(gh)}var f9=H.contains=function(gg,gh){if(gh.nodeType==3){gh=gh.parentNode}if(gg.contains){return gg.contains(gh)}do{if(gh.nodeType==11){gh=gh.host}if(gh==gg){return true}}while(gh=gh.parentNode)};function dO(){return document.activeElement}if(dK&&k<11){dO=function(){try{return document.activeElement}catch(gg){return document.body}}}function S(gg){return new RegExp("(^|\\s)"+gg+"(?:$|\\s)\\s*")}var f=H.rmClass=function(gi,gg){var gj=gi.className;var gh=S(gg).exec(gj);if(gh){var gk=gj.slice(gh.index+gh[0].length);gi.className=gj.slice(0,gh.index)+(gk?gh[1]+gk:"")}};var fA=H.addClass=function(gh,gg){var gi=gh.className;if(!S(gg).test(gi)){gh.className+=(gi?" ":"")+gg}};function fS(gi,gg){var gh=gi.split(" ");for(var gj=0;gj<gh.length;gj++){if(gh[gj]&&!S(gh[gj]).test(gg)){gg+=" "+gh[gj]}}return gg}function aA(gj){if(!document.body.getElementsByClassName){return}var gi=document.body.getElementsByClassName("CodeMirror");for(var gh=0;gh<gi.length;gh++){var gg=gi[gh].CodeMirror;if(gg){gj(gg)}}}var cC=false;function bj(){if(cC){return}fE();cC=true}function fE(){var gg;bX(window,"resize",function(){if(gg==null){gg=setTimeout(function(){gg=null;aA(aT)},100)}});bX(window,"blur",function(){aA(aV)})}var eL=function(){if(dK&&k<9){return false}var gg=f1("div");return"draggable" in gg||"dragDrop" in gg}();var fL;function bn(gg){if(fL==null){var gi=f1("span","\u200b");bR(gg,f1("span",[gi,document.createTextNode("x")]));if(gg.firstChild.offsetHeight!=0){fL=gi.offsetWidth<=1&&gi.offsetHeight>2&&!(dK&&k<8)}}var gh=fL?f1("span","\u200b"):f1("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px");gh.setAttribute("cm-text","");return gh}var fK;function bO(gj){if(fK!=null){return fK}var gg=bR(gj,document.createTextNode("A\u062eA"));var gi=cl(gg,0,1).getBoundingClientRect();if(!gi||gi.left==gi.right){return false}var gh=cl(gg,1,2).getBoundingClientRect();return fK=(gh.right-gi.right<3)}var a1=H.splitLines="\n\nb".split(/\n/).length!=3?function(gl){var gm=0,gg=[],gk=gl.length;while(gm<=gk){var gj=gl.indexOf("\n",gm);if(gj==-1){gj=gl.length}var gi=gl.slice(gm,gl.charAt(gj-1)=="\r"?gj-1:gj);var gh=gi.indexOf("\r");if(gh!=-1){gg.push(gi.slice(0,gh));gm+=gh+1}else{gg.push(gi);gm=gj+1}}return gg}:function(gg){return gg.split(/\r\n?|\n/)};var bs=window.getSelection?function(gh){try{return gh.selectionStart!=gh.selectionEnd}catch(gg){return false}}:function(gi){try{var gg=gi.ownerDocument.selection.createRange()}catch(gh){}if(!gg||gg.parentElement()!=gi){return false}return gg.compareEndPoints("StartToEnd",gg)!=0};var da=(function(){var gg=f1("div");if("oncopy" in gg){return true}gg.setAttribute("oncopy","return;");return typeof gg.oncopy=="function"})();var e6=null;function aK(gh){if(e6!=null){return e6}var gi=bR(gh,f1("span","x"));var gj=gi.getBoundingClientRect();var gg=cl(gi,0,1).getBoundingClientRect();return e6=Math.abs(gj.left-gg.left)>1}var fg={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};H.keyNames=fg;(function(){for(var gg=0;gg<10;gg++){fg[gg+48]=fg[gg+96]=String(gg)}for(var gg=65;gg<=90;gg++){fg[gg]=String.fromCharCode(gg)}for(var gg=1;gg<=12;gg++){fg[gg+111]=fg[gg+63235]="F"+gg}})();function d4(gg,gm,gl,gk){if(!gg){return gk(gm,gl,"ltr")}var gj=false;for(var gi=0;gi<gg.length;++gi){var gh=gg[gi];if(gh.from<gl&&gh.to>gm||gm==gl&&gh.to==gm){gk(Math.max(gh.from,gm),Math.min(gh.to,gl),gh.level==1?"rtl":"ltr");gj=true}}if(!gj){gk(gm,gl,"ltr")}}function dy(gg){return gg.level%2?gg.to:gg.from}function gc(gg){return gg.level%2?gg.from:gg.to}function cE(gh){var gg=a(gh);return gg?dy(gg[0]):0}function cS(gh){var gg=a(gh);if(!gg){return gh.text.length}return gc(fG(gg))}function bt(gh,gk){var gi=ff(gh.doc,gk);var gl=y(gi);if(gl!=gi){gk=bN(gl)}var gg=a(gl);var gj=!gg?0:gg[0].level%2?cS(gl):cE(gl);return W(gk,gj)}function dP(gi,gl){var gh,gj=ff(gi.doc,gl);while(gh=ew(gj)){gj=gh.find(1,true).line;gl=null}var gg=a(gj);var gk=!gg?gj.text.length:gg[0].level%2?cE(gj):cS(gj);return W(gl==null?bN(gj):gl,gk)}function dI(gh,gm){var gl=bt(gh,gm.line);var gi=ff(gh.doc,gl.line);var gg=a(gi);if(!gg||gg[0].level==0){var gk=Math.max(0,gi.text.search(/\S/));var gj=gm.line==gl.line&&gm.ch<=gk&&gm.ch;return W(gl.line,gj?0:gk)}return gl}function an(gh,gi,gg){var gj=gh[0].level;if(gi==gj){return true}if(gg==gj){return false}return gi<gg}var e2;function aG(gg,gk){e2=null;for(var gh=0,gi;gh<gg.length;++gh){var gj=gg[gh];if(gj.from<gk&&gj.to>gk){return gh}if((gj.from==gk||gj.to==gk)){if(gi==null){gi=gh}else{if(an(gg,gj.level,gg[gi].level)){if(gj.from!=gj.to){e2=gi}return gh}else{if(gj.from!=gj.to){e2=gh}return gi}}}}return gi}function fe(gg,gj,gh,gi){if(!gi){return gj+gh}do{gj+=gh}while(gj>0&&fp(gg.text.charAt(gj)));return gj}function u(gg,gn,gi,gj){var gk=a(gg);if(!gk){return ai(gg,gn,gi,gj)}var gm=aG(gk,gn),gh=gk[gm];var gl=fe(gg,gn,gh.level%2?-gi:gi,gj);for(;;){if(gl>gh.from&&gl<gh.to){return gl}if(gl==gh.from||gl==gh.to){if(aG(gk,gl)==gm){return gl}gh=gk[gm+=gi];return(gi>0)==gh.level%2?gh.to:gh.from}else{gh=gk[gm+=gi];if(!gh){return null}if((gi>0)==gh.level%2){gl=fe(gg,gh.to,-1,gj)}else{gl=fe(gg,gh.from,1,gj)}}}}function ai(gg,gk,gh,gi){var gj=gk+gh;if(gi){while(gj>0&&fp(gg.text.charAt(gj))){gj+=gh}}return gj<0||gj>gg.text.length?null:gj}var bh=(function(){var gm="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var gk="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";function gj(gq){if(gq<=247){return gm.charAt(gq)}else{if(1424<=gq&&gq<=1524){return"R"}else{if(1536<=gq&&gq<=1773){return gk.charAt(gq-1536)}else{if(1774<=gq&&gq<=2220){return"r"}else{if(8192<=gq&&gq<=8203){return"w"}else{if(gq==8204){return"b"}else{return"L"}}}}}}}var gg=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var gp=/[stwN]/,gi=/[LRr]/,gh=/[Lb1n]/,gl=/[1n]/;var go="L";function gn(gs,gr,gq){this.level=gs;this.from=gr;this.to=gq}return function(gA){if(!gg.test(gA)){return false}var gG=gA.length,gw=[];for(var gF=0,gs;gF<gG;++gF){gw.push(gs=gj(gA.charCodeAt(gF)))}for(var gF=0,gz=go;gF<gG;++gF){var gs=gw[gF];if(gs=="m"){gw[gF]=gz}else{gz=gs}}for(var gF=0,gq=go;gF<gG;++gF){var gs=gw[gF];if(gs=="1"&&gq=="r"){gw[gF]="n"}else{if(gi.test(gs)){gq=gs;if(gs=="r"){gw[gF]="R"}}}}for(var gF=1,gz=gw[0];gF<gG-1;++gF){var gs=gw[gF];if(gs=="+"&&gz=="1"&&gw[gF+1]=="1"){gw[gF]="1"}else{if(gs==","&&gz==gw[gF+1]&&(gz=="1"||gz=="n")){gw[gF]=gz}}gz=gs}for(var gF=0;gF<gG;++gF){var gs=gw[gF];if(gs==","){gw[gF]="N"}else{if(gs=="%"){for(var gt=gF+1;gt<gG&&gw[gt]=="%";++gt){}var gH=(gF&&gw[gF-1]=="!")||(gt<gG&&gw[gt]=="1")?"1":"N";for(var gD=gF;gD<gt;++gD){gw[gD]=gH}gF=gt-1}}}for(var gF=0,gq=go;gF<gG;++gF){var gs=gw[gF];if(gq=="L"&&gs=="1"){gw[gF]="L"}else{if(gi.test(gs)){gq=gs}}}for(var gF=0;gF<gG;++gF){if(gp.test(gw[gF])){for(var gt=gF+1;gt<gG&&gp.test(gw[gt]);++gt){}var gx=(gF?gw[gF-1]:go)=="L";var gr=(gt<gG?gw[gt]:go)=="L";var gH=gx||gr?"L":"R";for(var gD=gF;gD<gt;++gD){gw[gD]=gH}gF=gt-1}}var gE=[],gB;for(var gF=0;gF<gG;){if(gh.test(gw[gF])){var gu=gF;for(++gF;gF<gG&&gh.test(gw[gF]);++gF){}gE.push(new gn(0,gu,gF))}else{var gv=gF,gy=gE.length;for(++gF;gF<gG&&gw[gF]!="L";++gF){}for(var gD=gv;gD<gF;){if(gl.test(gw[gD])){if(gv<gD){gE.splice(gy,0,new gn(1,gv,gD))}var gC=gD;for(++gD;gD<gF&&gl.test(gw[gD]);++gD){}gE.splice(gy,0,new gn(2,gC,gD));gv=gD}else{++gD}}if(gv<gF){gE.splice(gy,0,new gn(1,gv,gF))}}}if(gE[0].level==1&&(gB=gA.match(/^\s+/))){gE[0].from=gB[0].length;gE.unshift(new gn(0,0,gB[0].length))}if(fG(gE).level==1&&(gB=gA.match(/\s+$/))){fG(gE).to-=gB[0].length;gE.push(new gn(0,gG-gB[0].length,gG))}if(gE[0].level==2){gE.unshift(new gn(1,gE[0].to,gE[0].to))}if(gE[0].level!=fG(gE).level){gE.push(new gn(gE[0].level,gG,gG))}return gE}})();H.version="5.2.0";return H});